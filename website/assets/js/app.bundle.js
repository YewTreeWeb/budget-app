(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,o=function(){},s=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],c=s.length,a=window.console=window.console||{};c--;)a[n=s[c]]||(a[n]=o);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var i=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?i.classList.add("is-mobile"):(t.on(">medium",(function(){i.classList.remove("is-mobile"),i.classList.add("is-desktop")})),t.on("<=medium",(function(){i.classList.remove("is-desktop"),i.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var o=n("lwsE"),s=n.n(o),c=n("W8MJ"),a=n.n(c),i=n("xVb/"),l=function(){function e(t,n,o){s()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=o}return a()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"formatNumber",value:function(e,t){var n=Math.abs(e);(n=n.toFixed(2)).split(".")}},{key:"render",value:function(e,t){var n,o="exp"===t?"expenses":"income",s=document.querySelector(".".concat(o,"__list"));n="\n    <li class='".concat(o,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p><span>&pound;</span>").concat(e.val,"</p></div>\n    "),"exp"===t&&(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',s.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,percent:e.percent}}},{key:"displayBudget",value:function(e){var t="exp"===(e.budget>0?"inc":"exp")?"expenses":"income",n=document.querySelector(".budget__value .budget"),o=document.querySelector(".budget__income .budget__amount .amount"),s=document.querySelector(".budget__expenses .budget__amount .amount");n.textContent=e.budget,o.textContent=e.totalInc,s.textContent=e.totalExp,console.log("The ".concat(t," is/are ").concat(e.budget)),console.log(o,s)}},{key:"displayPercentage",value:function(e){var t=document.querySelector(".percentage");e>0?(t.classList.add("show"),t.innerHTML="".concat(e,"&#37;")):t.classList.remove("show"),console.log(t)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percent)}},{key:"displayPercentages",value:function(e){!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".items__percent"),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){i.default.calculatePercentages();var e=i.default.getPercentages();this.displayPercentages(e)}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,o=n.id.split("-"),s=o[0],c=Number(o[1]);console.log(t.target,n,o,s,c),i.default.removeItem(s,c),n.remove(),e.updateBudget(),e.updatePercentages()}}))}}]),e}();t.default=l},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var o=n("cDf5"),s=n.n(o),c=(n("OuUZ"),n("E4hX"),n("xVb/")),a=n("SEKM"),i=document.querySelector("body");window.onload=function(){window.setTimeout((function(){i.classList.remove("is-loading")}),100)};var l,u,r,d,p,m,g;l=c.default,u=document.querySelector(".add__form"),r=document.querySelector(".add__type"),d=document.querySelector(".add__description"),p=document.querySelector(".add__value"),m=document.querySelector("#check"),g=new a.default(r,d,p),r.addEventListener("change",(function(e){var t=Array.from(r.options);console.log(e),console.log(r.attributes,r.options,r.options.selectedIndex,t,t[1]),1===r.options.selectedIndex?(m.classList.add(r.value),t[0].removeAttribute("selected","selected"),t[1].setAttribute("selected","selected")):(t[1].removeAttribute("selected","selected"),t[0].setAttribute("selected","selected"),m.classList.remove("exp"))})),u.addEventListener("submit",(function(e){e.preventDefault();var t=g.getInput();if(console.log(t),console.log(s()(t.value)),u.reset(),""!==t.desc&&!isNaN(t.value)&&t.value>0){var n=l.addItem(t.type,t.description,t.value);g.render(n,t.type),g.updateBudget(),g.updatePercentages(),console.log("form submitted!"),console.log(n)}})),g.deleteItem()},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var o,s,c,a=n("cDf5"),i=n.n(a),l=n("lwsE"),u=n.n(l),r=n("W8MJ"),d=n.n(r),p=(o=function(){function e(t,n,o){u()(this,e),this.id=t,this.desc=n,this.val=o,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(i()(this.val)),"the totalIncome ".concat(i()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),s={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0},c=function(e){var t=0;s.allItems[e].forEach((function(e){t+=e.val})),s.totals[e]=t},{addItem:function(e,t,n){var c=s.allItems[e].length>0?s.allItems[e][s.allItems[e].length-1].id+1:0,a=new o(c,t,n);return s.allItems[e].push(a),a},calculateBudget:function(){return c("exp"),c("inc"),s.budget=s.totals.inc-s.totals.exp,s.totals.inc>0?s.percent=Math.round(s.totals.exp/s.totals.inc*100):s.percent=-1,console.log(s.totals.exp,s.totals.inc),console.log(s.budget,s.percent),s},calculatePercentages:function(){s.allItems.exp.forEach((function(e){e.calcPercentage(s.totals.inc)}))},getPercentages:function(){return s.allItems.exp.map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=s.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&s.allItems[e].splice(n,1)}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy91aWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJlYWtwb2ludHNcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9hcHAuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJvd3NlclwiIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvYnVkZ2V0Y29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJtZXRob2QiLCJub29wIiwibWV0aG9kcyIsImxlbmd0aCIsImNvbnNvbGUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRmlyc3RUYWIiLCJlIiwia2V5Q29kZSIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiYnJvd3NlciIsIm5hbWUiLCJicmVha3BvaW50cyIsInhsYXJnZSIsImxhcmdlIiwibWVkaXVtIiwic21hbGwiLCJ4c21hbGwiLCJtb2JpbGUiLCJvbiIsInJlbW92ZSIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJsb2ciLCJVSUNvbnRyb2xsZXIiLCJjb3N0IiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsInRoaXMiLCJpbnB1dFR5cGUiLCJpbnB1dERlc2MiLCJpbnB1dFZhbCIsInR5cGUiLCJOdW1iZXIiLCJudW1iZXIiLCJudW0iLCJNYXRoIiwiYWJzIiwidG9GaXhlZCIsInNwbGl0Iiwib2JqIiwiaHRtbCIsIml0ZW0iLCJsaXN0IiwiaWQiLCJkZXNjIiwidmFsIiwiaW5uZXJIVE1MIiwiZGF0YSIsImJ1ZGdldCIsInRvdGFsSW5jIiwidG90YWxzIiwiaW5jIiwidG90YWxFeHAiLCJleHAiLCJwZXJjZW50IiwidHlwZXMiLCJ0ZXh0Q29udGVudCIsInBlcmNlbnRhZ2UiLCJnZXREYXRhIiwiYnVkZ2V0Q29udHJvbGxlciIsImNhbGN1bGF0ZUJ1ZGdldCIsIm5ld0J1ZGdldCIsImdldEJ1ZGdldCIsImRpc3BsYXlCdWRnZXQiLCJkaXNwbGF5UGVyY2VudGFnZSIsInBlcmNlbnRhZ2VzIiwiY2IiLCJpIiwibm9kZUxpc3RGb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnQiLCJpbmRleCIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwiZ2V0UGVyY2VudGFnZXMiLCJkaXNwbGF5UGVyY2VudGFnZXMiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicGFyZW50RWxlbWVudCIsInNwbGl0SUQiLCJJRCIsInJlbW92ZUl0ZW0iLCJ1cGRhdGVCdWRnZXQiLCJ1cGRhdGVQZXJjZW50YWdlcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJvbmxvYWQiLCJzZXRUaW1lb3V0IiwiYnVkZ2V0Q3RybCIsImZvcm0iLCJjaGVjayIsIlVJQ3RybCIsIm9wdGlvbnMiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwic2VsZWN0ZWRJbmRleCIsInJlbW92ZUF0dHJpYnV0ZSIsInByZXZlbnREZWZhdWx0IiwiaW5wdXQiLCJnZXRJbnB1dCIsInJlc2V0IiwiaXNOYU4iLCJuZXdJdGVtIiwiYWRkSXRlbSIsInJlbmRlciIsImRlbGV0ZUl0ZW0iLCJCdWRnZXQiLCJjYWxjdWxhdGVUb3RhbHMiLCJ0b3RhbEluY29tZSIsInJvdW5kIiwiYWxsSXRlbXMiLCJzdW0iLCJmb3JFYWNoIiwiY3VyIiwicHVzaCIsImNhbGNQZXJjZW50YWdlIiwibWFwIiwiZ2V0UGVyY2VudGFnZSIsImluZGV4T2YiLCJzcGxpY2UiXSwibWFwcGluZ3MiOiI0SUFBQSxjQXFDRSxJQS9CQSxJQUFJQSxFQUNFQyxFQUFPLGFBQ1BDLEVBQVUsQ0FDZCxTQUNBLFFBQ0EsUUFDQSxRQUNBLE1BQ0EsU0FDQSxRQUNBLFlBQ0EsUUFDQSxpQkFDQSxXQUNBLE9BQ0EsTUFDQSxlQUNB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LEdBRVQxQyxnQkFBaUIsV0FxQmYsT0FuQkErQyxFQUFnQixPQUNoQkEsRUFBZ0IsT0FHaEI1RCxFQUFLQyxPQUFTRCxFQUFLRyxPQUFPQyxJQUFNSixFQUFLRyxPQUFPRyxJQUd4Q04sRUFBS0csT0FBT0MsSUFBTSxFQUNwQkosRUFBS08sUUFBVW5CLEtBQUswRSxNQUFPOUQsRUFBS0csT0FBT0csSUFBTU4sRUFBS0csT0FBT0MsSUFBTyxLQUVoRUosRUFBS08sU0FBVyxFQUtoQjFELFFBQVEwQixJQUFJeUIsRUFBS0csT0FBT0csSUFBS04sRUFBS0csT0FBT0MsS0FDekN2RCxRQUFRMEIsSUFBSXlCLEVBQUtDLE9BQVFELEVBQUtPLFNBR3pCUCxHQUVUeUIscUJBQXNCLFdBQ3BCekIsRUFBSytELFNBQVN6RCxJQUFJMkQsU0FBUSxTQUFDQyxHQUN6QkEsRUFBSUUsZUFBZXBFLEVBQUtHLE9BQU9DLFNBR25Dc0IsZUFBZ0IsV0FJZCxPQUhnQjFCLEVBQUsrRCxTQUFTekQsSUFBSStELEtBQUksU0FBQ0gsR0FDckMsT0FBT0EsRUFBSUksb0JBSWZyQyxXQUFZLFNBQUNqRCxFQUFNWSxHQUNqQixJQUdNNEIsRUFITXhCLEVBQUsrRCxTQUFTL0UsR0FBTXFGLEtBQUksU0FBQzlDLEdBQ25DLE9BQU9BLEVBQVEzQixNQUVDMkUsUUFBUTNFLElBRVgsSUFBWDRCLEdBQ0Z4QixFQUFLK0QsU0FBUy9FLEdBQU13RixPQUFPaEQsRUFBTyxNQU0zQlosYyIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXBsdXNwbHVzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1tdWx0aS1hc3NpZ24gKi9cblxuLy8gQXZvaWQgYGNvbnNvbGVgIGVycm9ycyBpbiBicm93c2VycyB0aGF0IGxhY2sgYSBjb25zb2xlLlxue1xuICBsZXQgbWV0aG9kXG4gIGNvbnN0IG5vb3AgPSAoKSA9PiB7fVxuICBjb25zdCBtZXRob2RzID0gW1xuICAgICdhc3NlcnQnLFxuICAgICdjbGVhcicsXG4gICAgJ2NvdW50JyxcbiAgICAnZGVidWcnLFxuICAgICdkaXInLFxuICAgICdkaXJ4bWwnLFxuICAgICdlcnJvcicsXG4gICAgJ2V4Y2VwdGlvbicsXG4gICAgJ2dyb3VwJyxcbiAgICAnZ3JvdXBDb2xsYXBzZWQnLFxuICAgICdncm91cEVuZCcsXG4gICAgJ2luZm8nLFxuICAgICdsb2cnLFxuICAgICdtYXJrVGltZWxpbmUnLFxuICAgICdwcm9maWxlJyxcbiAgICAncHJvZmlsZUVuZCcsXG4gICAgJ3RhYmxlJyxcbiAgICAndGltZScsXG4gICAgJ3RpbWVFbmQnLFxuICAgICd0aW1lbGluZScsXG4gICAgJ3RpbWVsaW5lRW5kJyxcbiAgICAndGltZVN0YW1wJyxcbiAgICAndHJhY2UnLFxuICAgICd3YXJuJyxcbiAgXVxuICBsZXQgeyBsZW5ndGggfSA9IG1ldGhvZHNcbiAgY29uc3QgY29uc29sZSA9ICh3aW5kb3cuY29uc29sZSA9IHdpbmRvdy5jb25zb2xlIHx8IHt9KVxuXG4gIHdoaWxlIChsZW5ndGgtLSkge1xuICAgIG1ldGhvZCA9IG1ldGhvZHNbbGVuZ3RoXVxuXG4gICAgLy8gT25seSBzdHViIHVuZGVmaW5lZCBtZXRob2RzLlxuICAgIGlmICghY29uc29sZVttZXRob2RdKSB7XG4gICAgICBjb25zb2xlW21ldGhvZF0gPSBub29wXG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCB0YWJiaW5nIGluZGljYXRvciB0byB3aW5kb3dcbmNvbnN0IGhhbmRsZUZpcnN0VGFiID0gKGUpID0+IHtcbiAgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgIC8vIHRoZSBcIkkgYW0gYSBrZXlib2FyZCB1c2VyXCIga2V5XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCd1c2VyLWlzLXRhYmJpbmcnKVxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlRmlyc3RUYWIpXG4gIH1cbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVGaXJzdFRhYilcblxuLy8gQWRkIGEgYnJvd2VyIGluZGljYXRvciB0byB0aGUgSFRNTCBlbGVtZW50LlxuY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKVxuaHRtbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYnJvd3NlcicsIGJyb3dzZXIubmFtZSlcblxuLy8gRGV0ZWN0IGlmIG1vYmlsZSBvciBkZXNrdG9wLlxuY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG5icmVha3BvaW50cyh7XG4gIHhsYXJnZTogWycxMjgxcHgnLCAnMTY4MHB4J10sXG4gIGxhcmdlOiBbJzk4MXB4JywgJzEyODBweCddLFxuICBtZWRpdW06IFsnNzM3cHgnLCAnOTgwcHgnXSxcbiAgc21hbGw6IFsnNDgxcHgnLCAnNzM2cHgnXSxcbiAgeHNtYWxsOiBbbnVsbCwgJzQ4MHB4J10sXG59KVxuXG5pZiAoYnJvd3Nlci5tb2JpbGUpIHtcbiAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1tb2JpbGUnKVxufSBlbHNlIHtcbiAgYnJlYWtwb2ludHMub24oJz5tZWRpdW0nLCAoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1tb2JpbGUnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtZGVza3RvcCcpXG4gIH0pXG4gIGJyZWFrcG9pbnRzLm9uKCc8PW1lZGl1bScsICgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRlc2t0b3AnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbW9iaWxlJylcbiAgfSlcbn1cblxuLy8gTG9nIGlmIHJ1bm5pbmcgaW4gbG9jYWxob3N0IHdoZW4gaW4gZGV2ZWxvcG1lbnQgbW9kZS5cbmlmIChcbiAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyAmJlxuICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nXG4pIHtcbiAgY29uc29sZS5sb2coJ2xvY2FsaG9zdCBkZXRlY3RlZCEnKVxufVxuIiwiLyogZXNsaW50LWRpc2FibGUgY2xhc3MtbWV0aG9kcy11c2UtdGhpcyAqL1xuXG5pbXBvcnQgYnVkZ2V0Q29udHJvbGxlciBmcm9tICcuL2J1ZGdldGNvbnRyb2xsZXInXG5cbi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1kZXN0cnVjdHVyaW5nICovXG5jbGFzcyBVSUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3Rvcihjb3N0LCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICB0aGlzLmlucHV0VHlwZSA9IGNvc3RcbiAgICB0aGlzLmlucHV0RGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgdGhpcy5pbnB1dFZhbCA9IHZhbHVlXG4gIH1cblxuICBnZXRJbnB1dCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogdGhpcy5pbnB1dFR5cGUudmFsdWUsIC8vIFdpbGwgYmUgZWl0aGVyIGluYyBvciBleHBcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmlucHV0RGVzYy52YWx1ZSxcbiAgICAgIHZhbHVlOiBOdW1iZXIodGhpcy5pbnB1dFZhbC52YWx1ZSksXG4gICAgfVxuICB9XG5cbiAgZm9ybWF0TnVtYmVyKG51bWJlciwgdHlwZSkge1xuICAgIC8qKlxuICAgICAqICsgb3IgLSBiZWZvcmUgdGhlIG51bWJlclxuICAgICAqIGV4YWN0bHkgMiBkZWNpbWFsIHBvaW50c1xuICAgICAqIGNvbW1hIHNlcGVyYXRpbmcgdGhlIHRob3VzYW5kc1xuICAgICAqXG4gICAgICogMjMxMC40NTY3ID0gKyAyLDMxMC40NlxuICAgICAqL1xuICAgIGxldCBudW0gPSBNYXRoLmFicyhudW1iZXIpXG4gICAgbnVtID0gbnVtLnRvRml4ZWQoMilcblxuICAgIGNvbnN0IG51bVNwbGl0ID0gbnVtLnNwbGl0KCcuJylcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzXG4gIHJlbmRlcihvYmosIHR5cGUpIHtcbiAgICBjb25zdCBpdGVtID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ2luY29tZSdcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aXRlbX1fX2xpc3RgKVxuICAgIGxldCBodG1sXG5cbiAgICAvLyBDcmVhdGUgSFRNTCBzdHJpbmcgd2l0aCBwbGFjZWhvbGRlclxuICAgIGh0bWwgPSBgXG4gICAgPGxpIGNsYXNzPScke2l0ZW19X19pdGVtJyBpZD0nJHt0eXBlfS0ke29iai5pZH0nPlxuICAgICAgPGRpdiBjbGFzcz0naXRlbS1kZXNjJz48cD4ke29iai5kZXNjfTwvcD48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJpdGVtc1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPSdpdGVtc19fdmFsdWUnPjxwPjxzcGFuPiZwb3VuZDs8L3NwYW4+JHtvYmoudmFsfTwvcD48L2Rpdj5cbiAgICBgXG5cbiAgICBpZiAodHlwZSA9PT0gJ2V4cCcpIHtcbiAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJpdGVtc19fcGVyY2VudFwiPjxwPjAmIzM3OzwvcD48L2Rpdj4nXG4gICAgfVxuXG4gICAgaHRtbCArPSBgXG4gICAgICAgIDxidXR0b24gY2xhc3M9J2J0biBidG4tLWNsZWFyIGl0ZW1zX19kZWwnPlxuICAgICAgICAgIDxzdmcgaWQ9XCJkZWxldGVcIiBjbGFzcz1cImljb25cIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj1cIi9hc3NldHMvaW1hZ2VzL2ljb25zLnN2ZyNpY29uLWRlbGV0ZVwiPjwvdXNlPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvbGk+XG4gICAgYFxuXG4gICAgLy8gSW5zZXJ0IEhUTUwgaW50byB0aGUgRE9NXG4gICAgbGlzdC5pbm5lckhUTUwgKz0gaHRtbFxuICB9XG5cbiAgZ2V0QnVkZ2V0KGRhdGEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgIHRvdGFsSW5jOiBkYXRhLnRvdGFscy5pbmMsXG4gICAgICB0b3RhbEV4cDogZGF0YS50b3RhbHMuZXhwLFxuICAgICAgcGVyY2VudDogZGF0YS5wZXJjZW50LFxuICAgIH1cbiAgfVxuXG4gIGRpc3BsYXlCdWRnZXQob2JqKSB7XG4gICAgY29uc3QgdHlwZSA9IG9iai5idWRnZXQgPiAwID8gJ2luYycgOiAnZXhwJ1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ2luY29tZSdcbiAgICBjb25zdCBidWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVkZ2V0X192YWx1ZSAuYnVkZ2V0JylcbiAgICBjb25zdCBpbmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC5idWRnZXRfX2luY29tZSAuYnVkZ2V0X19hbW91bnQgLmFtb3VudGBcbiAgICApXG4gICAgY29uc3QgZXhwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuYnVkZ2V0X19leHBlbnNlcyAuYnVkZ2V0X19hbW91bnQgLmFtb3VudGBcbiAgICApXG5cbiAgICBidWRnZXQudGV4dENvbnRlbnQgPSBvYmouYnVkZ2V0XG4gICAgaW5jLnRleHRDb250ZW50ID0gb2JqLnRvdGFsSW5jXG4gICAgZXhwLnRleHRDb250ZW50ID0gb2JqLnRvdGFsRXhwXG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coYFRoZSAke3R5cGVzfSBpcy9hcmUgJHtvYmouYnVkZ2V0fWApXG4gICAgICBjb25zb2xlLmxvZyhpbmMsIGV4cClcbiAgICB9XG4gIH1cblxuICBkaXNwbGF5UGVyY2VudGFnZShwZXJjZW50YWdlKSB7XG4gICAgY29uc3QgcGVyY2VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZXJjZW50YWdlJylcblxuICAgIGlmIChwZXJjZW50YWdlID4gMCkge1xuICAgICAgcGVyY2VudC5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICAgIHBlcmNlbnQuaW5uZXJIVE1MID0gYCR7cGVyY2VudGFnZX0mIzM3O2BcbiAgICB9IGVsc2Uge1xuICAgICAgcGVyY2VudC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcbiAgICB9XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2cocGVyY2VudClcbiAgICB9XG4gIH1cblxuICB1cGRhdGVCdWRnZXQoKSB7XG4gICAgLy8gMS4gQ2hlY2sgbG9jYWxTdG9yYWdlIGZvciBzYXZlIGJ1ZGdldCBkYXRhLCBlbHNlIGdldCBuZXcgZGF0YVxuICAgIGNvbnN0IGdldERhdGEgPSBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZUJ1ZGdldCgpXG5cbiAgICAvLyAyLiBSZXR1cm4gdGhlIGJ1ZGdldFxuICAgIGNvbnN0IG5ld0J1ZGdldCA9IHRoaXMuZ2V0QnVkZ2V0KGdldERhdGEpXG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2cobmV3QnVkZ2V0KVxuICAgIH1cblxuICAgIC8vIDMuIERpc3BsYXkgdGhlIHVwZGF0ZWQgYnVkZ2V0XG4gICAgdGhpcy5kaXNwbGF5QnVkZ2V0KG5ld0J1ZGdldClcblxuICAgIC8vIDQuIERpc3BsYXkgdGhlIG5ldyBvdmVyYWxsIGJ1ZGdldCBwZXJjZW50YWdlXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZShuZXdCdWRnZXQucGVyY2VudClcbiAgfVxuXG4gIGRpc3BsYXlQZXJjZW50YWdlcyhwZXJjZW50YWdlcykge1xuICAgIGNvbnN0IGZpZWxkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtc19fcGVyY2VudCcpXG4gICAgY29uc3Qgbm9kZUxpc3RGb3JFYWNoID0gKGxpc3QsIGNiKSA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSwgaSlcbiAgICAgIH1cbiAgICB9XG4gICAgbm9kZUxpc3RGb3JFYWNoKGZpZWxkcywgKGN1cnJlbnQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocGVyY2VudGFnZXNbaW5kZXhdID4gMCkge1xuICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2VzW2luZGV4XX0mIzM3O2BcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgICAgIGN1cnJlbnQuaW5uZXJIVE1MID0gJzAmIzM3OydcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgdXBkYXRlUGVyY2VudGFnZXMoKSB7XG4gICAgLy8gMS4gQ2FsdWxhdGUgcGVyY2VudGFnZXNcbiAgICBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKClcblxuICAgIC8vIDIuIFJlYWQgcGVyY2VudGFnZXMgZnJvbSBidWRnZXQgY29udHJvbGxlclxuICAgIGNvbnN0IHBlcmNlbnRhZ2VzID0gYnVkZ2V0Q29udHJvbGxlci5nZXRQZXJjZW50YWdlcygpXG5cbiAgICAvLyAzLiBVcGRhdGUgVUkgdG8gc2hvdyBuZXcgcGVyY2VudGFnZXNcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlcyhwZXJjZW50YWdlcylcbiAgfVxuXG4gIGRlbGV0ZUl0ZW0oKSB7XG4gICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmNvbWUtZXhwZW5zZXMnKVxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmlkID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KCcuaXRlbXMnKS5wYXJlbnRFbGVtZW50XG4gICAgICAgIGNvbnN0IHNwbGl0SUQgPSB0YXJnZXQuaWQuc3BsaXQoJy0nKVxuICAgICAgICBjb25zdCB0eXBlID0gc3BsaXRJRFswXVxuICAgICAgICBjb25zdCBJRCA9IE51bWJlcihzcGxpdElEWzFdKVxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQsIHRhcmdldCwgc3BsaXRJRCwgdHlwZSwgSUQpXG4gICAgICAgIH1cblxuICAgICAgICAvLyAxLiBEZWxldGUgdGhlIGl0ZW0gZnJvbSB0aGUgZGF0YSBzdHJ1Y3R1cmVcbiAgICAgICAgYnVkZ2V0Q29udHJvbGxlci5yZW1vdmVJdGVtKHR5cGUsIElEKVxuXG4gICAgICAgIC8vIDIuIERlbGV0ZSB0aGUgaXRlbSBmcm9tIHRoZSBVSVxuICAgICAgICB0YXJnZXQucmVtb3ZlKClcblxuICAgICAgICAvLyAzLiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBidWRnZXRcbiAgICAgICAgdGhpcy51cGRhdGVCdWRnZXQoKVxuXG4gICAgICAgIC8vIDQuIFVwZGF0ZSBhbmQgc2hvdyB0aGUgbmV3IHBlcmNlbnRhZ2VzXG4gICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZXMoKVxuICAgICAgfVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVUlDb250cm9sbGVyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyZWFrcG9pbnRzOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblxuLy8gRXh0ZXJuYWxcbmltcG9ydCAnYWlyYm5iLWJyb3dzZXItc2hpbXMnXG5cbi8vIEludGVybmFsXG5pbXBvcnQgJy4vbW9kdWxlcy9oZWxwZXJzJ1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXInXG5pbXBvcnQgVUlDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy91aWNvbnRyb2xsZXInXG5cbi8vIFJlbW92ZSBsb2FkaW5nIGNsYXNzIGZyb20gYm9keSBvbiB3aW5kb3cgbG9hZC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jylcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbG9hZGluZycpXG4gIH0sIDEwMClcbn1cblxuLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRyb2xsZXIgZm9yIHRoZSBhcHBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuY29uc3QgY29udHJvbGxlciA9ICgoYnVkZ2V0Q3RybCkgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZm9ybScpXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX190eXBlJylcbiAgY29uc3QgZGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX2Rlc2NyaXB0aW9uJylcbiAgY29uc3QgdmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX192YWx1ZScpXG4gIGNvbnN0IGNoZWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NoZWNrJylcblxuICBjb25zdCBVSUN0cmwgPSBuZXcgVUlDb250cm9sbGVyKHR5cGUsIGRlc2MsIHZhbHVlKVxuXG4gIC8vIFRvZ2dsZSB0aGUgc3VibWl0IG5ldyBjb3N0IGZyb20gZWl0aGVyIGluY29tZSBvciBleHBlbnNlLlxuICB0eXBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IEFycmF5LmZyb20odHlwZS5vcHRpb25zKVxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIHR5cGUuYXR0cmlidXRlcyxcbiAgICAgICAgdHlwZS5vcHRpb25zLFxuICAgICAgICB0eXBlLm9wdGlvbnMuc2VsZWN0ZWRJbmRleCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgb3B0aW9uc1sxXVxuICAgICAgKVxuICAgIH1cbiAgICBpZiAodHlwZS5vcHRpb25zLnNlbGVjdGVkSW5kZXggPT09IDEpIHtcbiAgICAgIGNoZWNrLmNsYXNzTGlzdC5hZGQodHlwZS52YWx1ZSlcbiAgICAgIG9wdGlvbnNbMF0ucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICBvcHRpb25zWzFdLnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKVxuICAgIH0gZWxzZSB7XG4gICAgICBvcHRpb25zWzFdLnJlbW92ZUF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKVxuICAgICAgb3B0aW9uc1swXS5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgIGNoZWNrLmNsYXNzTGlzdC5yZW1vdmUoJ2V4cCcpXG4gICAgfVxuICB9KVxuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIC8vIEdldCBmaWxlZCBpbnB1dCBkYXRhXG4gICAgY29uc3QgaW5wdXQgPSBVSUN0cmwuZ2V0SW5wdXQoKVxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhpbnB1dClcbiAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpbnB1dC52YWx1ZSlcbiAgICB9XG5cbiAgICAvLyBDbGVhciB0aGUgZm9ybSBmaWVsZHNcbiAgICBmb3JtLnJlc2V0KClcblxuICAgIC8vIE9ubHkgcnVuIGNhbGN1bGF0aW9ucyBpZiB2YWxpZCBpbnB1dHMgYXJlIGVudGVyZWRcbiAgICBpZiAoaW5wdXQuZGVzYyAhPT0gJycgJiYgIWlzTmFOKGlucHV0LnZhbHVlKSAmJiBpbnB1dC52YWx1ZSA+IDApIHtcbiAgICAgIC8vIEFkZCB0aGUgaXRlbSB0byB0aGUgYnVkZ2V0XG4gICAgICBjb25zdCBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKFxuICAgICAgICBpbnB1dC50eXBlLFxuICAgICAgICBpbnB1dC5kZXNjcmlwdGlvbixcbiAgICAgICAgaW5wdXQudmFsdWVcbiAgICAgIClcblxuICAgICAgLy8gQ2FsY3VsYWUgdGhlIGJ1ZGdldCBhbmQgdXBkYXRlIHRoZSBVSVxuICAgICAgVUlDdHJsLnJlbmRlcihuZXdJdGVtLCBpbnB1dC50eXBlKSAvLyBBZGQgaXRlbXMgdG8gaW5jb21lIG9yIGV4cGVuc2VzIGxpc3RcbiAgICAgIFVJQ3RybC51cGRhdGVCdWRnZXQoKSAvLyBPdXRwdXQgdGhlIG5ldyBidWRnZXRcbiAgICAgIFVJQ3RybC51cGRhdGVQZXJjZW50YWdlcygpIC8vIE91dHB1dCB0aGUgbmV3IHBlcmNlbnRhZ2VzXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmb3JtIHN1Ym1pdHRlZCEnKVxuICAgICAgICBjb25zb2xlLmxvZyhuZXdJdGVtKVxuICAgICAgfVxuICAgIH1cbiAgfSlcblxuICAvLyBEZWxldGUgYW4gYWRkZWQgaW5jb21lIG9yIGV4cGVuc2VcbiAgVUlDdHJsLmRlbGV0ZUl0ZW0oKVxufSkoYnVkZ2V0Q29udHJvbGxlcilcbiIsIm1vZHVsZS5leHBvcnRzID0gYnJvd3NlcjsiLCJjb25zdCBidWRnZXRDb250cm9sbGVyID0gKCgpID0+IHtcbiAgY2xhc3MgQnVkZ2V0IHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgICB0aGlzLmlkID0gaWRcbiAgICAgIHRoaXMuZGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgICB0aGlzLnZhbCA9IHZhbHVlXG4gICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAtMVxuICAgIH1cblxuICAgIGNhbGNQZXJjZW50YWdlKHRvdGFsSW5jb21lKSB7XG4gICAgICBpZiAodG90YWxJbmNvbWUgPiAwKSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKHRoaXMudmFsIC8gdG90YWxJbmNvbWUpICogMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGB0aGlzIHZhbHVlIGlzICR7dHlwZW9mIHRoaXMudmFsfWAsXG4gICAgICAgICAgYHRoZSB0b3RhbEluY29tZSAke3R5cGVvZiB0b3RhbEluY29tZX1gXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQZXJjZW50YWdlKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGVyY2VudGFnZVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgYWxsSXRlbXM6IHtcbiAgICAgIGV4cDogW10sXG4gICAgICBpbmM6IFtdLFxuICAgIH0sXG4gICAgdG90YWxzOiB7XG4gICAgICBleHA6IDAsXG4gICAgICBpbmM6IDAsXG4gICAgfSxcbiAgICBidWRnZXQ6IDAsXG4gIH1cblxuICBjb25zdCBjYWxjdWxhdGVUb3RhbHMgPSAodHlwZSkgPT4ge1xuICAgIGxldCBzdW0gPSAwXG4gICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgIHN1bSArPSBjdXIudmFsXG4gICAgfSlcbiAgICBkYXRhLnRvdGFsc1t0eXBlXSA9IHN1bVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRJdGVtOiAodHlwZSwgZGVzYywgdmFsKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbmV3IElEXG4gICAgICBjb25zdCBJRCA9XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMFxuICAgICAgICAgID8gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMVxuICAgICAgICAgIDogMFxuXG4gICAgICAvLyBTZXQgbmV3IGl0ZW0gdG8gdXNlIG9iamVjdFxuICAgICAgY29uc3QgbmV3SXRlbSA9IG5ldyBCdWRnZXQoSUQsIGRlc2MsIHZhbClcblxuICAgICAgLy8gUHVzaCBpdCBpbnRvIGRhdGEgc3RydWN0dXJlXG4gICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSlcblxuICAgICAgLy8gY3JlYXRlIG5ldyBpdGVtXG4gICAgICByZXR1cm4gbmV3SXRlbVxuICAgIH0sXG4gICAgY2FsY3VsYXRlQnVkZ2V0OiAoKSA9PiB7XG4gICAgICAvLyAxLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldFxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdleHAnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdpbmMnKVxuXG4gICAgICAvLyAyLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldDogaW5jb21lIC0gZXhwZW5zZXNcbiAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhbHMuaW5jIC0gZGF0YS50b3RhbHMuZXhwXG5cbiAgICAgIC8vIDMuIENhbGN1bGF0ZSB0aGUgcGVyY2VudGFnZSBvZiBpbmNvbWUgdGhhdCB3ZSBzcGVudFxuICAgICAgaWYgKGRhdGEudG90YWxzLmluYyA+IDApIHtcbiAgICAgICAgZGF0YS5wZXJjZW50ID0gTWF0aC5yb3VuZCgoZGF0YS50b3RhbHMuZXhwIC8gZGF0YS50b3RhbHMuaW5jKSAqIDEwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRhdGEucGVyY2VudCA9IC0xXG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLnRvdGFscy5leHAsIGRhdGEudG90YWxzLmluYylcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS5idWRnZXQsIGRhdGEucGVyY2VudClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9LFxuICAgIGNhbGN1bGF0ZVBlcmNlbnRhZ2VzOiAoKSA9PiB7XG4gICAgICBkYXRhLmFsbEl0ZW1zLmV4cC5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgICAgY3VyLmNhbGNQZXJjZW50YWdlKGRhdGEudG90YWxzLmluYylcbiAgICAgIH0pXG4gICAgfSxcbiAgICBnZXRQZXJjZW50YWdlczogKCkgPT4ge1xuICAgICAgY29uc3QgYWxsUGVyYyA9IGRhdGEuYWxsSXRlbXMuZXhwLm1hcCgoY3VyKSA9PiB7XG4gICAgICAgIHJldHVybiBjdXIuZ2V0UGVyY2VudGFnZSgpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIGFsbFBlcmNcbiAgICB9LFxuICAgIHJlbW92ZUl0ZW06ICh0eXBlLCBpZCkgPT4ge1xuICAgICAgY29uc3QgaWRzID0gZGF0YS5hbGxJdGVtc1t0eXBlXS5tYXAoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuaWRcbiAgICAgIH0pXG4gICAgICBjb25zdCBpbmRleCA9IGlkcy5pbmRleE9mKGlkKVxuXG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKVxuICAgICAgfVxuICAgIH0sXG4gIH1cbn0pKClcblxuZXhwb3J0IGRlZmF1bHQgYnVkZ2V0Q29udHJvbGxlclxuIl0sInNvdXJjZVJvb3QiOiIifQ==