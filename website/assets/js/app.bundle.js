(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{"+4zn":function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),o=n.n(a),s=n("yXPU"),c=n.n(s),i=n("lwsE"),l=n.n(i),u=n("W8MJ"),r=n.n(u),d=function(){function e(){l()(this,e),this.budgets=db.collection("budgets")}var t;return r()(e,[{key:"saveBudget",value:(t=c()(o.a.mark((function e(t){var n,a,s,c,i,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,a=t.allItems,s=a.exp,c=a.inc,i=a.sav,l={budget:t.budget,totalInc:t.totals.inc,totalExp:t.totals.exp,totalSav:t.totals.sav,percentExp:t.percent.exp,percentSav:t.percent.sav,allItems:{exp:s,inc:c,sav:i},created_at:firebase.firestore.Timestamp.fromDate(n)},e.next=5,this.budgets.add(l);case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getBudget",value:function(e){this.budgets.orderBy("created_at").onSnapshot((function(t){t.docChanges().forEach((function(t){"added"===t.type&&e(t.doc.data(),t.doc.id)}))}))}}]),e}();t.default=d},0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,a=function(){},o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],s=o.length,c=window.console=window.console||{};s--;)c[n=o[s]]||(c[n]=a);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var i=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?i.classList.add("is-mobile"):(t.on(">medium",(function(){i.classList.remove("is-mobile"),i.classList.add("is-desktop")})),t.on("<=medium",(function(){i.classList.remove("is-desktop"),i.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var a=n("lwsE"),o=n.n(a),s=n("W8MJ"),c=n.n(s),i=n("xVb/"),l=new(n("+4zn").default),u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=Math.abs(e),s=(o=o.toFixed(2)).split("."),c=s[0],i=s[1];i=Number(i)>0?".".concat(i):"",c.length>3&&(c="".concat(c.substr(0,c.length-3),",").concat(c.substr(c.length-3,3)));var l=n?'<span class="currency">&pound;</span>':"";return"".concat(a?"exp"===t?'<span class="sign">&#45;</span> ':'<span class="sign">&#43;</span> ':"").concat(l).concat(c).concat(i)},r=function(){function e(t,n,a){o()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=a}return c()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"render",value:function(e,t){var n,a="exp"===t?"expenses":"sav"===t?"savings":"income",o=document.querySelector(".".concat(a,"__list"));n="\n    <li class='".concat(a,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p>").concat(u(e.val,t,!0,!1),"</p></div>\n    "),"exp"!==t&&"sav"!==t||(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',o.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,totalSav:e.totals.sav,percentExp:e.percent.exp,percentSav:e.percent.sav}}},{key:"displayBudget",value:function(e){var t=e.budget>0?"inc":"exp",n="exp"===t?"expenses":"income",a=document.querySelector(".budget__value"),o=document.querySelector(".budget__income .budget__amount"),s=document.querySelector(".budget__expenses .budget__amount"),c=document.querySelector(".budget__savings .budget__amount");a.innerHTML=u(e.budget,t,!0),o.innerHTML=u(e.totalInc,"inc"),s.innerHTML=u(e.totalExp,"exp"),c.innerHTML=u(e.totalSav,"exp"),console.log("The ".concat(n," is/are ").concat(e.budget)),console.log(o,s)}},{key:"displayPercentage",value:function(e,t){var n="exp"===t?"expenses":"savings",a=document.querySelector(".budget__".concat(n," .budget__percentage"));e>0?(a.classList.add("show"),a.innerHTML="".concat(e,"&#37;")):a.classList.remove("show"),console.log(a)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percentExp,"exp"),this.displayPercentage(t.percentSav,"sav")}},{key:"displayPercentages",value:function(e,t){var n="exp"===t?"expenses":"savings";!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".".concat(n," .items__percent")),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){i.default.calculatePercentages(this.inputType.value);var e=i.default.getPercentages(this.inputType.value);this.displayPercentages(e,this.inputType.value)}},{key:"displayDate",value:function(){var e=document.querySelector(".budget__date"),t=new Date;e.textContent="".concat(["January","February","March","April","May","June","July","August","Sepetember","October","November","December"][t.getMonth()]," ").concat(t.getFullYear())}},{key:"changeType",value:function(){var e=this.inputType,t=document.querySelector("#check");e.addEventListener("change",(function(n){var a=Array.from(e.options);console.log(n),console.log(e.attributes,e.options,e.options.selectedIndex,a,a[1]),a.forEach((function(e){e.selected?(e.setAttribute("selected","selected"),t.classList.remove("exp","sav"),"exp"===e.value?t.classList.add("exp"):"sav"===e.value&&t.classList.add("sav")):e.removeAttribute("selected","selected"),console.log("Value ".concat(e.value))}))}))}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,a=n.id.split("-"),o=a[0],s=Number(a[1]);console.log(t.target,n,a,o,s),i.default.removeItem(o,s),n.remove(),e.updateBudget(),e.updatePercentages()}}))}},{key:"saving",value:function(){var e=document.querySelector("#save"),t=i.default.getData();e.addEventListener("click",(function(){console.log(t,t.allItems.inc),l.saveBudget(t).then((function(){console.log("saved")})).catch((function(e){console.error(e)}))}))}}]),e}();t.default=r},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var a=n("cDf5"),o=n.n(a),s=(n("OuUZ"),n("E4hX"),n("xVb/")),c=n("SEKM"),i=n("+4zn"),l=document.querySelector("body");window.onload=function(){window.setTimeout((function(){l.classList.remove("is-loading")}),100)};!function(e){var t=document.querySelector(".add__form"),n=document.querySelector(".add__type"),a=document.querySelector(".add__description"),s=document.querySelector(".add__value"),l=new c.default(n,a,s),u=new i.default;l.displayDate(),l.changeType(),l.saving();var r=e.getData().allItems.inc;t.addEventListener("submit",(function(n){n.preventDefault();var a=l.getInput();if(console.log(a),console.log(o()(a.value)),t.reset(),""!==a.desc&&!isNaN(a.value)&&a.value>0){var s=e.addItem(a.type,a.description,a.value);l.render(s,a.type),l.updateBudget(),l.updatePercentages(),console.log("form submitted!"),console.log(s)}console.log(r)})),l.deleteItem(),u.getBudget((function(e,t){console.log(e,t)}))}(s.default)},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var a,o,s,c=n("cDf5"),i=n.n(c),l=n("lwsE"),u=n.n(l),r=n("W8MJ"),d=n.n(r),p=(a=function(){function e(t,n,a){u()(this,e),this.id=t,this.desc=n,this.val=a,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(i()(this.val)),"the totalIncome ".concat(i()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),o={allItems:{exp:[],inc:[],sav:[]},totals:{exp:0,inc:0,sav:0},percent:{exp:-1,sav:-1},budget:0},s=function(e){var t=0;o.allItems[e].forEach((function(e){t+=e.val})),o.totals[e]=t},{addItem:function(e,t,n){var s=o.allItems[e].length>0?o.allItems[e][o.allItems[e].length-1].id+1:0,c=new a(s,t,n);return o.allItems[e].push(c),c},calculateBudget:function(){return s("exp"),s("inc"),s("sav"),o.budget=o.totals.inc-(o.totals.exp+o.totals.sav),o.totals.inc>0?(o.percent.exp=Math.round(o.totals.exp/o.totals.inc*100),o.percent.sav=Math.round(o.totals.sav/o.totals.inc*100)):(o.percent.exp=-1,o.percent.sav=-1),console.log(o.totals.exp,o.totals.inc),console.log(o.budget,o.percent.exp,o.percent.sav),o},calculatePercentages:function(e){o.allItems[e].forEach((function(e){e.calcPercentage(o.totals.inc)}))},getPercentages:function(e){return o.allItems[e].map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=o.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&o.allItems[e].splice(n,1)},getData:function(){return o}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL3Bhc3RidWRnZXQuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy9oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvdWljb250cm9sbGVyLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyZWFrcG9pbnRzXCIiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvYXBwLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyb3dzZXJcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiUGFzdEJ1ZGdldCIsInRoaXMiLCJidWRnZXRzIiwiZGIiLCJjb2xsZWN0aW9uIiwib2JqIiwibm93IiwiRGF0ZSIsImFsbEl0ZW1zIiwiZXhwIiwiaW5jIiwic2F2IiwiYnVkZ2V0IiwidG90YWxJbmMiLCJ0b3RhbHMiLCJ0b3RhbEV4cCIsInRvdGFsU2F2IiwicGVyY2VudEV4cCIsInBlcmNlbnQiLCJwZXJjZW50U2F2IiwiY3JlYXRlZF9hdCIsImZpcmViYXNlIiwiZmlyZXN0b3JlIiwiVGltZXN0YW1wIiwiZnJvbURhdGUiLCJhZGQiLCJyZXNwb25zZSIsImNiIiwib3JkZXJCeSIsIm9uU25hcHNob3QiLCJzbmFwc2hvdCIsImRvY0NoYW5nZXMiLCJmb3JFYWNoIiwiY2hhbmdlIiwidHlwZSIsImRvYyIsImRhdGEiLCJpZCIsIm1ldGhvZCIsIm5vb3AiLCJtZXRob2RzIiwibGVuZ3RoIiwiY29uc29sZSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVGaXJzdFRhYiIsImUiLCJrZXlDb2RlIiwiZG9jdW1lbnQiLCJib2R5IiwiY2xhc3NMaXN0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRBdHRyaWJ1dGUiLCJicm93c2VyIiwibmFtZSIsImJyZWFrcG9pbnRzIiwieGxhcmdlIiwibGFyZ2UiLCJtZWRpdW0iLCJzbWFsbCIsInhzbWFsbCIsIm1vYmlsZSIsIm9uIiwicmVtb3ZlIiwibG9jYXRpb24iLCJob3N0bmFtZSIsImxvZyIsInBhc3RidWRnZXQiLCJmb3JtYXROdW1iZXIiLCJudW1iZXIiLCJtb25leSIsImNhbGMiLCJudW0iLCJNYXRoIiwiYWJzIiwibnVtU3BsaXQiLCJ0b0ZpeGVkIiwic3BsaXQiLCJpbnQiLCJkZWNpbWFsIiwiTnVtYmVyIiwic3Vic3RyIiwiY3VycmVuY3kiLCJVSUNvbnRyb2xsZXIiLCJjb3N0IiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsImlucHV0VHlwZSIsImlucHV0RGVzYyIsImlucHV0VmFsIiwiaHRtbCIsIml0ZW0iLCJsaXN0IiwiZGVzYyIsInZhbCIsImlubmVySFRNTCIsInR5cGVzIiwicGVyY2VudGFnZSIsImdldERhdGEiLCJidWRnZXRDb250cm9sbGVyIiwiY2FsY3VsYXRlQnVkZ2V0IiwibmV3QnVkZ2V0IiwiZ2V0QnVkZ2V0IiwiZGlzcGxheUJ1ZGdldCIsImRpc3BsYXlQZXJjZW50YWdlIiwicGVyY2VudGFnZXMiLCJpIiwibm9kZUxpc3RGb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnQiLCJpbmRleCIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwiZ2V0UGVyY2VudGFnZXMiLCJkaXNwbGF5UGVyY2VudGFnZXMiLCJidWRnZXREYXRlIiwiZGF0ZSIsInRleHRDb250ZW50IiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImNoZWNrIiwib3B0aW9ucyIsIkFycmF5IiwiZnJvbSIsImF0dHJpYnV0ZXMiLCJzZWxlY3RlZEluZGV4Iiwib3B0aW9uIiwic2VsZWN0ZWQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicGFyZW50RWxlbWVudCIsInNwbGl0SUQiLCJJRCIsInJlbW92ZUl0ZW0iLCJ1cGRhdGVCdWRnZXQiLCJ1cGRhdGVQZXJjZW50YWdlcyIsImJ1dHRvbiIsInNhdmVCdWRnZXQiLCJ0aGVuIiwiZXJyIiwiZXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIiwib25sb2FkIiwic2V0VGltZW91dCIsImJ1ZGdldEN0cmwiLCJmb3JtIiwiVUlDdHJsIiwiZGlzcGxheURhdGUiLCJjaGFuZ2VUeXBlIiwic2F2aW5nIiwicHJldmVudERlZmF1bHQiLCJpbnB1dCIsImdldElucHV0IiwicmVzZXQiLCJpc05hTiIsIm5ld0l0ZW0iLCJhZGRJdGVtIiwicmVuZGVyIiwiZGVsZXRlSXRlbSIsIkJ1ZGdldCIsImNhbGN1bGF0ZVRvdGFscyIsInRvdGFsSW5jb21lIiwicm91bmQiLCJzdW0iLCJjdXIiLCJwdXNoIiwiY2FsY1BlcmNlbnRhZ2UiLCJtYXAiLCJnZXRQZXJjZW50YWdlIiwiaW5kZXhPZiIsInNwbGljZSJdLCJtYXBwaW5ncyI6ImdNQUlNQSxFLFdBQ0osYUFBYyxZQUNaQyxLQUFLQyxRQUFVQyxHQUFHQyxXQUFXLFcsd0VBR2RDLEcsMEZBQ1RDLEVBQU0sSUFBSUMsSyxFQUNVRixFQUFJRyxTQUF0QkMsRSxFQUFBQSxJQUFLQyxFLEVBQUFBLElBQUtDLEUsRUFBQUEsSUFDWkMsRUFBUyxDQUNiQSxPQUFRUCxFQUFJTyxPQUNaQyxTQUFVUixFQUFJUyxPQUFPSixJQUNyQkssU0FBVVYsRUFBSVMsT0FBT0wsSUFDckJPLFNBQVVYLEVBQUlTLE9BQU9ILElBQ3JCTSxXQUFZWixFQUFJYSxRQUFRVCxJQUN4QlUsV0FBWWQsRUFBSWEsUUFBUVAsSUFDeEJILFNBQVUsQ0FDUkMsTUFDQUMsTUFDQUMsT0FFRlMsV0FBWUMsU0FBU0MsVUFBVUMsVUFBVUMsU0FBU2xCLEksU0FFN0JMLEtBQUtDLFFBQVF1QixJQUFJYixHLGNBQWxDYyxFLHlCQUNDQSxHLDhIQUdDQyxHQUNSMUIsS0FBS0MsUUFBUTBCLFFBQVEsY0FBY0MsWUFBVyxTQUFDQyxHQUM3Q0EsRUFBU0MsYUFBYUMsU0FBUSxTQUFDQyxHQUNULFVBQWhCQSxFQUFPQyxNQUNUUCxF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S3RCLE9BQU9MLElBQU0yQixFQUFLdEIsT0FBT0gsS0FHM0R5QixFQUFLdEIsT0FBT0osSUFBTSxHQUNwQjBCLEVBQUtsQixRQUFRVCxJQUFNaUUsS0FBSzBGLE1BQU9oSSxFQUFLdEIsT0FBT0wsSUFBTTJCLEVBQUt0QixPQUFPSixJQUFPLEtBQ3BFMEIsRUFBS2xCLFFBQVFQLElBQU0rRCxLQUFLMEYsTUFBT2hJLEVBQUt0QixPQUFPSCxJQUFNeUIsRUFBS3RCLE9BQU9KLElBQU8sT0FFcEUwQixFQUFLbEIsUUFBUVQsS0FBTyxFQUNwQjJCLEVBQUtsQixRQUFRUCxLQUFPLEdBS3BCK0IsUUFBUXlCLElBQUkvQixFQUFLdEIsT0FBT0wsSUFBSzJCLEVBQUt0QixPQUFPSixLQUN6Q2dDLFFBQVF5QixJQUFJL0IsRUFBS3hCLE9BQVF3QixFQUFLbEIsUUFBUVQsSUFBSzJCLEVBQUtsQixRQUFRUCxLQUduRHlCLEdBRVQ0RSxxQkFBc0IsU0FBQzlFLEdBQ3JCRSxFQUFLNUIsU0FBUzBCLEdBQU1GLFNBQVEsU0FBQ3NJLEdBQzNCQSxFQUFJRSxlQUFlcEksRUFBS3RCLE9BQU9KLFNBR25DdUcsZUFBZ0IsU0FBQy9FLEdBSWYsT0FIZ0JFLEVBQUs1QixTQUFTMEIsR0FBTXVJLEtBQUksU0FBQ0gsR0FDdkMsT0FBT0EsRUFBSUksb0JBSWZwQyxXQUFZLFNBQUNwRyxFQUFNRyxHQUNqQixJQUdNMEUsRUFITTNFLEVBQUs1QixTQUFTMEIsR0FBTXVJLEtBQUksU0FBQzNELEdBQ25DLE9BQU9BLEVBQVF6RSxNQUVDc0ksUUFBUXRJLElBRVgsSUFBWDBFLEdBQ0YzRSxFQUFLNUIsU0FBUzBCLEdBQU0wSSxPQUFPN0QsRUFBTyxJQUd0Q1osUUFBUyxXQUNQLE9BQU8vRCxLQUtFZ0UsYyIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdG9kbzogc2F2ZSBidWRnZXQgZGF0YSB0byBmaXJlYmFzZVxuLy8gdG9kbzogZ2V0IGFsbEl0ZW1zIGRhdGEgdG8gc2F2ZSBzbyB0aGV5IGNhbiBiZSByZXBvcHVsYXRlZCB3aGVuIGxvYWRlZC5cbi8vIHRvZG86IGdldCB0aGUgZGF0YSBmcm9tIGZpcmViYXNlIHdoZW4gYSBkYXRlIGhhcyBiZWVuIGNob3NlbiBmcm9tIHRoZSBzZWxlY3Qgb3B0aW9ucyBhbmQgdXBkYXRlIHRoZSBVSVxuXG5jbGFzcyBQYXN0QnVkZ2V0IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5idWRnZXRzID0gZGIuY29sbGVjdGlvbignYnVkZ2V0cycpXG4gIH1cblxuICBhc3luYyBzYXZlQnVkZ2V0KG9iaikge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBjb25zdCB7IGV4cCwgaW5jLCBzYXYgfSA9IG9iai5hbGxJdGVtc1xuICAgIGNvbnN0IGJ1ZGdldCA9IHtcbiAgICAgIGJ1ZGdldDogb2JqLmJ1ZGdldCxcbiAgICAgIHRvdGFsSW5jOiBvYmoudG90YWxzLmluYyxcbiAgICAgIHRvdGFsRXhwOiBvYmoudG90YWxzLmV4cCxcbiAgICAgIHRvdGFsU2F2OiBvYmoudG90YWxzLnNhdixcbiAgICAgIHBlcmNlbnRFeHA6IG9iai5wZXJjZW50LmV4cCxcbiAgICAgIHBlcmNlbnRTYXY6IG9iai5wZXJjZW50LnNhdixcbiAgICAgIGFsbEl0ZW1zOiB7XG4gICAgICAgIGV4cCxcbiAgICAgICAgaW5jLFxuICAgICAgICBzYXYsXG4gICAgICB9LFxuICAgICAgY3JlYXRlZF9hdDogZmlyZWJhc2UuZmlyZXN0b3JlLlRpbWVzdGFtcC5mcm9tRGF0ZShub3cpLFxuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYnVkZ2V0cy5hZGQoYnVkZ2V0KVxuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgZ2V0QnVkZ2V0KGNiKSB7XG4gICAgdGhpcy5idWRnZXRzLm9yZGVyQnkoJ2NyZWF0ZWRfYXQnKS5vblNuYXBzaG90KChzbmFwc2hvdCkgPT4ge1xuICAgICAgc25hcHNob3QuZG9jQ2hhbmdlcygpLmZvckVhY2goKGNoYW5nZSkgPT4ge1xuICAgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGRlZCcpIHtcbiAgICAgICAgICBjYihjaGFuZ2UuZG9jLmRhdGEoKSwgY2hhbmdlLmRvYy5pZClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBhc3RCdWRnZXRcbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wbHVzcGx1cyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tbXVsdGktYXNzaWduICovXG5cbi8vIEF2b2lkIGBjb25zb2xlYCBlcnJvcnMgaW4gYnJvd3NlcnMgdGhhdCBsYWNrIGEgY29uc29sZS5cbntcbiAgbGV0IG1ldGhvZFxuICBjb25zdCBub29wID0gKCkgPT4ge31cbiAgY29uc3QgbWV0aG9kcyA9IFtcbiAgICAnYXNzZXJ0JyxcbiAgICAnY2xlYXInLFxuICAgICdjb3VudCcsXG4gICAgJ2RlYnVnJyxcbiAgICAnZGlyJyxcbiAgICAnZGlyeG1sJyxcbiAgICAnZXJyb3InLFxuICAgICdleGNlcHRpb24nLFxuICAgICdncm91cCcsXG4gICAgJ2dyb3VwQ29sbGFwc2VkJyxcbiAgICAnZ3JvdXBFbmQnLFxuICAgICdpbmZvJyxcbiAgICAnbG9nJyxcbiAgICAnbWFya1RpbWVsaW5lJyxcbiAgICAncHJvZmlsZScsXG4gICAgJ3Byb2ZpbGVFbmQnLFxuICAgICd0YWJsZScsXG4gICAgJ3RpbWUnLFxuICAgICd0aW1lRW5kJyxcbiAgICAndGltZWxpbmUnLFxuICAgICd0aW1lbGluZUVuZCcsXG4gICAgJ3RpbWVTdGFtcCcsXG4gICAgJ3RyYWNlJyxcbiAgICAnd2FybicsXG4gIF1cbiAgbGV0IHsgbGVuZ3RoIH0gPSBtZXRob2RzXG4gIGNvbnN0IGNvbnNvbGUgPSAod2luZG93LmNvbnNvbGUgPSB3aW5kb3cuY29uc29sZSB8fCB7fSlcblxuICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICBtZXRob2QgPSBtZXRob2RzW2xlbmd0aF1cblxuICAgIC8vIE9ubHkgc3R1YiB1bmRlZmluZWQgbWV0aG9kcy5cbiAgICBpZiAoIWNvbnNvbGVbbWV0aG9kXSkge1xuICAgICAgY29uc29sZVttZXRob2RdID0gbm9vcFxuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdGFiYmluZyBpbmRpY2F0b3IgdG8gd2luZG93XG5jb25zdCBoYW5kbGVGaXJzdFRhYiA9IChlKSA9PiB7XG4gIGlmIChlLmtleUNvZGUgPT09IDkpIHtcbiAgICAvLyB0aGUgXCJJIGFtIGEga2V5Ym9hcmQgdXNlclwiIGtleVxuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgndXNlci1pcy10YWJiaW5nJylcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUZpcnN0VGFiKVxuICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlRmlyc3RUYWIpXG5cbi8vIEFkZCBhIGJyb3dlciBpbmRpY2F0b3IgdG8gdGhlIEhUTUwgZWxlbWVudC5cbmNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJylcbmh0bWwuc2V0QXR0cmlidXRlKCdkYXRhLWJyb3dzZXInLCBicm93c2VyLm5hbWUpXG5cbi8vIERldGVjdCBpZiBtb2JpbGUgb3IgZGVza3RvcC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JylcblxuYnJlYWtwb2ludHMoe1xuICB4bGFyZ2U6IFsnMTI4MXB4JywgJzE2ODBweCddLFxuICBsYXJnZTogWyc5ODFweCcsICcxMjgwcHgnXSxcbiAgbWVkaXVtOiBbJzczN3B4JywgJzk4MHB4J10sXG4gIHNtYWxsOiBbJzQ4MXB4JywgJzczNnB4J10sXG4gIHhzbWFsbDogW251bGwsICc0ODBweCddLFxufSlcblxuaWYgKGJyb3dzZXIubW9iaWxlKSB7XG4gIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbW9iaWxlJylcbn0gZWxzZSB7XG4gIGJyZWFrcG9pbnRzLm9uKCc+bWVkaXVtJywgKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbW9iaWxlJylcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLWRlc2t0b3AnKVxuICB9KVxuICBicmVha3BvaW50cy5vbignPD1tZWRpdW0nLCAoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kZXNrdG9wJylcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpXG4gIH0pXG59XG5cbi8vIExvZyBpZiBydW5uaW5nIGluIGxvY2FsaG9zdCB3aGVuIGluIGRldmVsb3BtZW50IG1vZGUuXG5pZiAoXG4gIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgJiZcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJ1xuKSB7XG4gIGNvbnNvbGUubG9nKCdsb2NhbGhvc3QgZGV0ZWN0ZWQhJylcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGNsYXNzLW1ldGhvZHMtdXNlLXRoaXMgKi9cbmltcG9ydCBidWRnZXRDb250cm9sbGVyIGZyb20gJy4vYnVkZ2V0Y29udHJvbGxlcidcbmltcG9ydCBQYXN0QnVkZ2V0IGZyb20gJy4vcGFzdGJ1ZGdldCdcblxuY29uc3QgcGFzdGJ1ZGdldCA9IG5ldyBQYXN0QnVkZ2V0KClcblxuY29uc3QgZm9ybWF0TnVtYmVyID0gKG51bWJlciwgdHlwZSwgbW9uZXkgPSBmYWxzZSwgY2FsYyA9IHRydWUpID0+IHtcbiAgLyoqXG4gICAqICsgb3IgLSBiZWZvcmUgdGhlIG51bWJlclxuICAgKiBleGFjdGx5IDIgZGVjaW1hbCBwb2ludHNcbiAgICogY29tbWEgc2VwZXJhdGluZyB0aGUgdGhvdXNhbmRzXG4gICAqXG4gICAqIDIzMTAuNDU2NyA9ICsgMiwzMTAuNDZcbiAgICovXG4gIGxldCBudW0gPSBNYXRoLmFicyhudW1iZXIpXG4gIG51bSA9IG51bS50b0ZpeGVkKDIpXG5cbiAgY29uc3QgbnVtU3BsaXQgPSBudW0uc3BsaXQoJy4nKSAvLyBub3cgYSBzdHJpbmcgYW5kIHdpbGwgc3BsaXQgdGhlIC4gdG8gcmVwbGFjZSB3aXRoIGEgLFxuICBsZXQgaW50ID0gbnVtU3BsaXRbMF1cbiAgbGV0IGRlY2ltYWwgPSBudW1TcGxpdFsxXVxuICBkZWNpbWFsID0gTnVtYmVyKGRlY2ltYWwpID4gMCA/IGAuJHtkZWNpbWFsfWAgOiAnJ1xuXG4gIGlmIChpbnQubGVuZ3RoID4gMykge1xuICAgIC8vIHN1YnN0ciBhbGxvd3MgZm9yIG9ubHkgcGFydCBvZiB0aGUgc3RyaW5nIHRvIGJlIHRha2VuXG4gICAgaW50ID0gYCR7aW50LnN1YnN0cigwLCBpbnQubGVuZ3RoIC0gMyl9LCR7aW50LnN1YnN0cihpbnQubGVuZ3RoIC0gMywgMyl9YCAvLyBpbnB1dCAyMzEwLCBvdXRwdXQgMiwzMTBcbiAgfVxuXG4gIGxldCBzaWduXG4gIGlmIChjYWxjKSB7XG4gICAgc2lnbiA9XG4gICAgICB0eXBlID09PSAnZXhwJ1xuICAgICAgICA/ICc8c3BhbiBjbGFzcz1cInNpZ25cIj4mIzQ1Ozwvc3Bhbj4gJ1xuICAgICAgICA6ICc8c3BhbiBjbGFzcz1cInNpZ25cIj4mIzQzOzwvc3Bhbj4gJ1xuICB9IGVsc2Uge1xuICAgIHNpZ24gPSAnJ1xuICB9XG4gIGNvbnN0IGN1cnJlbmN5ID0gbW9uZXkgPyAnPHNwYW4gY2xhc3M9XCJjdXJyZW5jeVwiPiZwb3VuZDs8L3NwYW4+JyA6ICcnXG5cbiAgLy8gUmV0dXJuIHRoZSBmb3JtYXR0ZWQgc3RyaW5nXG4gIHJldHVybiBgJHtzaWdufSR7Y3VycmVuY3l9JHtpbnR9JHtkZWNpbWFsfWBcbn1cblxuLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLWRlc3RydWN0dXJpbmcgKi9cbmNsYXNzIFVJQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKGNvc3QsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgIHRoaXMuaW5wdXRUeXBlID0gY29zdFxuICAgIHRoaXMuaW5wdXREZXNjID0gZGVzY3JpcHRpb25cbiAgICB0aGlzLmlucHV0VmFsID0gdmFsdWVcbiAgfVxuXG4gIGdldElucHV0KCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiB0aGlzLmlucHV0VHlwZS52YWx1ZSwgLy8gV2lsbCBiZSBlaXRoZXIgaW5jIG9yIGV4cFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuaW5wdXREZXNjLnZhbHVlLFxuICAgICAgdmFsdWU6IE51bWJlcih0aGlzLmlucHV0VmFsLnZhbHVlKSxcbiAgICB9XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICByZW5kZXIob2JqLCB0eXBlKSB7XG4gICAgY29uc3QgaXRlbSA9XG4gICAgICB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiB0eXBlID09PSAnc2F2JyA/ICdzYXZpbmdzJyA6ICdpbmNvbWUnXG4gICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2l0ZW19X19saXN0YClcbiAgICBsZXQgaHRtbFxuXG4gICAgLy8gQ3JlYXRlIEhUTUwgc3RyaW5nIHdpdGggcGxhY2Vob2xkZXJcbiAgICBodG1sID0gYFxuICAgIDxsaSBjbGFzcz0nJHtpdGVtfV9faXRlbScgaWQ9JyR7dHlwZX0tJHtvYmouaWR9Jz5cbiAgICAgIDxkaXYgY2xhc3M9J2l0ZW0tZGVzYyc+PHA+JHtvYmouZGVzY308L3A+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiaXRlbXNcIj5cbiAgICAgICAgPGRpdiBjbGFzcz0naXRlbXNfX3ZhbHVlJz48cD4ke2Zvcm1hdE51bWJlcihcbiAgICAgICAgICBvYmoudmFsLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICBmYWxzZVxuICAgICAgICApfTwvcD48L2Rpdj5cbiAgICBgXG5cbiAgICBpZiAodHlwZSA9PT0gJ2V4cCcgfHwgdHlwZSA9PT0gJ3NhdicpIHtcbiAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJpdGVtc19fcGVyY2VudFwiPjxwPjAmIzM3OzwvcD48L2Rpdj4nXG4gICAgfVxuXG4gICAgaHRtbCArPSBgXG4gICAgICAgIDxidXR0b24gY2xhc3M9J2J0biBidG4tLWNsZWFyIGl0ZW1zX19kZWwnPlxuICAgICAgICAgIDxzdmcgaWQ9XCJkZWxldGVcIiBjbGFzcz1cImljb25cIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj1cIi9hc3NldHMvaW1hZ2VzL2ljb25zLnN2ZyNpY29uLWRlbGV0ZVwiPjwvdXNlPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvbGk+XG4gICAgYFxuXG4gICAgLy8gSW5zZXJ0IEhUTUwgaW50byB0aGUgRE9NXG4gICAgbGlzdC5pbm5lckhUTUwgKz0gaHRtbFxuICB9XG5cbiAgZ2V0QnVkZ2V0KGRhdGEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgIHRvdGFsSW5jOiBkYXRhLnRvdGFscy5pbmMsXG4gICAgICB0b3RhbEV4cDogZGF0YS50b3RhbHMuZXhwLFxuICAgICAgdG90YWxTYXY6IGRhdGEudG90YWxzLnNhdixcbiAgICAgIHBlcmNlbnRFeHA6IGRhdGEucGVyY2VudC5leHAsXG4gICAgICBwZXJjZW50U2F2OiBkYXRhLnBlcmNlbnQuc2F2LFxuICAgIH1cbiAgfVxuXG4gIGRpc3BsYXlCdWRnZXQob2JqKSB7XG4gICAgY29uc3QgdHlwZSA9IG9iai5idWRnZXQgPiAwID8gJ2luYycgOiAnZXhwJ1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ2luY29tZSdcbiAgICBjb25zdCBidWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVkZ2V0X192YWx1ZScpXG4gICAgY29uc3QgaW5jID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmJ1ZGdldF9faW5jb21lIC5idWRnZXRfX2Ftb3VudGApXG4gICAgY29uc3QgZXhwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmJ1ZGdldF9fZXhwZW5zZXMgLmJ1ZGdldF9fYW1vdW50YClcbiAgICBjb25zdCBzYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYnVkZ2V0X19zYXZpbmdzIC5idWRnZXRfX2Ftb3VudGApXG5cbiAgICBidWRnZXQuaW5uZXJIVE1MID0gZm9ybWF0TnVtYmVyKG9iai5idWRnZXQsIHR5cGUsIHRydWUpXG4gICAgaW5jLmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmoudG90YWxJbmMsICdpbmMnKVxuICAgIGV4cC5pbm5lckhUTUwgPSBmb3JtYXROdW1iZXIob2JqLnRvdGFsRXhwLCAnZXhwJylcbiAgICBzYXYuaW5uZXJIVE1MID0gZm9ybWF0TnVtYmVyKG9iai50b3RhbFNhdiwgJ2V4cCcpXG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coYFRoZSAke3R5cGVzfSBpcy9hcmUgJHtvYmouYnVkZ2V0fWApXG4gICAgICBjb25zb2xlLmxvZyhpbmMsIGV4cClcbiAgICB9XG4gIH1cblxuICBkaXNwbGF5UGVyY2VudGFnZShwZXJjZW50YWdlLCB0eXBlKSB7XG4gICAgY29uc3QgdHlwZXMgPSB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiAnc2F2aW5ncydcbiAgICBjb25zdCBwZXJjZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuYnVkZ2V0X18ke3R5cGVzfSAuYnVkZ2V0X19wZXJjZW50YWdlYFxuICAgIClcblxuICAgIGlmIChwZXJjZW50YWdlID4gMCkge1xuICAgICAgcGVyY2VudC5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICAgIHBlcmNlbnQuaW5uZXJIVE1MID0gYCR7cGVyY2VudGFnZX0mIzM3O2BcbiAgICB9IGVsc2Uge1xuICAgICAgcGVyY2VudC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcbiAgICB9XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2cocGVyY2VudClcbiAgICB9XG4gIH1cblxuICB1cGRhdGVCdWRnZXQoKSB7XG4gICAgLy8gMS4gQ2hlY2sgbG9jYWxTdG9yYWdlIGZvciBzYXZlIGJ1ZGdldCBkYXRhLCBlbHNlIGdldCBuZXcgZGF0YVxuICAgIGNvbnN0IGdldERhdGEgPSBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZUJ1ZGdldCgpXG5cbiAgICAvLyAyLiBSZXR1cm4gdGhlIGJ1ZGdldFxuICAgIGNvbnN0IG5ld0J1ZGdldCA9IHRoaXMuZ2V0QnVkZ2V0KGdldERhdGEpXG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2cobmV3QnVkZ2V0KVxuICAgIH1cblxuICAgIC8vIDMuIERpc3BsYXkgdGhlIHVwZGF0ZWQgYnVkZ2V0XG4gICAgdGhpcy5kaXNwbGF5QnVkZ2V0KG5ld0J1ZGdldClcblxuICAgIC8vIDQuIERpc3BsYXkgdGhlIG5ldyBvdmVyYWxsIGJ1ZGdldCBwZXJjZW50YWdlXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZShuZXdCdWRnZXQucGVyY2VudEV4cCwgJ2V4cCcpXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZShuZXdCdWRnZXQucGVyY2VudFNhdiwgJ3NhdicpXG4gIH1cblxuICBkaXNwbGF5UGVyY2VudGFnZXMocGVyY2VudGFnZXMsIHR5cGUpIHtcbiAgICBjb25zdCB0eXBlcyA9IHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6ICdzYXZpbmdzJ1xuICAgIGNvbnN0IGZpZWxkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke3R5cGVzfSAuaXRlbXNfX3BlcmNlbnRgKVxuICAgIGNvbnN0IG5vZGVMaXN0Rm9yRWFjaCA9IChsaXN0LCBjYikgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNiKGxpc3RbaV0sIGkpXG4gICAgICB9XG4gICAgfVxuICAgIG5vZGVMaXN0Rm9yRWFjaChmaWVsZHMsIChjdXJyZW50LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHBlcmNlbnRhZ2VzW2luZGV4XSA+IDApIHtcbiAgICAgICAgY3VycmVudC5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICAgICAgY3VycmVudC5pbm5lckhUTUwgPSBgJHtwZXJjZW50YWdlc1tpbmRleF19JiMzNztgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9ICcwJiMzNzsnXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHVwZGF0ZVBlcmNlbnRhZ2VzKCkge1xuICAgIC8vIDEuIENhbHVsYXRlIHBlcmNlbnRhZ2VzXG4gICAgYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVQZXJjZW50YWdlcyh0aGlzLmlucHV0VHlwZS52YWx1ZSlcblxuICAgIC8vIDIuIFJlYWQgcGVyY2VudGFnZXMgZnJvbSBidWRnZXQgY29udHJvbGxlclxuICAgIGNvbnN0IHBlcmNlbnRhZ2VzID0gYnVkZ2V0Q29udHJvbGxlci5nZXRQZXJjZW50YWdlcyh0aGlzLmlucHV0VHlwZS52YWx1ZSlcblxuICAgIC8vIDMuIFVwZGF0ZSBVSSB0byBzaG93IG5ldyBwZXJjZW50YWdlc1xuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2VzKHBlcmNlbnRhZ2VzLCB0aGlzLmlucHV0VHlwZS52YWx1ZSlcbiAgfVxuXG4gIGRpc3BsYXlEYXRlKCkge1xuICAgIGNvbnN0IGJ1ZGdldERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVkZ2V0X19kYXRlJylcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKVxuICAgIGNvbnN0IG1vbnRocyA9IFtcbiAgICAgICdKYW51YXJ5JyxcbiAgICAgICdGZWJydWFyeScsXG4gICAgICAnTWFyY2gnLFxuICAgICAgJ0FwcmlsJyxcbiAgICAgICdNYXknLFxuICAgICAgJ0p1bmUnLFxuICAgICAgJ0p1bHknLFxuICAgICAgJ0F1Z3VzdCcsXG4gICAgICAnU2VwZXRlbWJlcicsXG4gICAgICAnT2N0b2JlcicsXG4gICAgICAnTm92ZW1iZXInLFxuICAgICAgJ0RlY2VtYmVyJyxcbiAgICBdXG4gICAgYnVkZ2V0RGF0ZS50ZXh0Q29udGVudCA9IGAke21vbnRoc1tkYXRlLmdldE1vbnRoKCldfSAke2RhdGUuZ2V0RnVsbFllYXIoKX1gXG4gIH1cblxuICBjaGFuZ2VUeXBlKCkge1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLmlucHV0VHlwZVxuICAgIGNvbnN0IGNoZWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NoZWNrJylcblxuICAgIC8vIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgLy8gICBjb25zb2xlLmxvZyhmaWVsZHMpXG4gICAgLy8gfVxuXG4gICAgdHlwZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IEFycmF5LmZyb20odHlwZS5vcHRpb25zKVxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICB0eXBlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgdHlwZS5vcHRpb25zLFxuICAgICAgICAgIHR5cGUub3B0aW9ucy5zZWxlY3RlZEluZGV4LFxuICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgb3B0aW9uc1sxXVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG4gICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgICBvcHRpb24uc2V0QXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICAgICAgY2hlY2suY2xhc3NMaXN0LnJlbW92ZSgnZXhwJywgJ3NhdicpXG4gICAgICAgICAgaWYgKG9wdGlvbi52YWx1ZSA9PT0gJ2V4cCcpIHtcbiAgICAgICAgICAgIGNoZWNrLmNsYXNzTGlzdC5hZGQoJ2V4cCcpXG4gICAgICAgICAgfSBlbHNlIGlmIChvcHRpb24udmFsdWUgPT09ICdzYXYnKSB7XG4gICAgICAgICAgICBjaGVjay5jbGFzc0xpc3QuYWRkKCdzYXYnKVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvcHRpb24ucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgVmFsdWUgJHtvcHRpb24udmFsdWV9YClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgZGVsZXRlSXRlbSgpIHtcbiAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluY29tZS1leHBlbnNlcycpXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQuaWQgPT09ICdkZWxldGUnKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5pdGVtcycpLnBhcmVudEVsZW1lbnRcbiAgICAgICAgY29uc3Qgc3BsaXRJRCA9IHRhcmdldC5pZC5zcGxpdCgnLScpXG4gICAgICAgIGNvbnN0IHR5cGUgPSBzcGxpdElEWzBdXG4gICAgICAgIGNvbnN0IElEID0gTnVtYmVyKHNwbGl0SURbMV0pXG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlLnRhcmdldCwgdGFyZ2V0LCBzcGxpdElELCB0eXBlLCBJRClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDEuIERlbGV0ZSB0aGUgaXRlbSBmcm9tIHRoZSBkYXRhIHN0cnVjdHVyZVxuICAgICAgICBidWRnZXRDb250cm9sbGVyLnJlbW92ZUl0ZW0odHlwZSwgSUQpXG5cbiAgICAgICAgLy8gMi4gRGVsZXRlIHRoZSBpdGVtIGZyb20gdGhlIFVJXG4gICAgICAgIHRhcmdldC5yZW1vdmUoKVxuXG4gICAgICAgIC8vIDMuIFVwZGF0ZSBhbmQgc2hvdyB0aGUgbmV3IGJ1ZGdldFxuICAgICAgICB0aGlzLnVwZGF0ZUJ1ZGdldCgpXG5cbiAgICAgICAgLy8gNC4gVXBkYXRlIGFuZCBzaG93IHRoZSBuZXcgcGVyY2VudGFnZXNcbiAgICAgICAgdGhpcy51cGRhdGVQZXJjZW50YWdlcygpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHNhdmluZygpIHtcbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2F2ZScpXG4gICAgY29uc3QgZGF0YSA9IGJ1ZGdldENvbnRyb2xsZXIuZ2V0RGF0YSgpXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coZGF0YSwgZGF0YS5hbGxJdGVtcy5pbmMpXG4gICAgICBwYXN0YnVkZ2V0XG4gICAgICAgIC5zYXZlQnVkZ2V0KGRhdGEpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZWQnKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgICB9KVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVUlDb250cm9sbGVyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyZWFrcG9pbnRzOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblxuLy8gRXh0ZXJuYWxcbmltcG9ydCAnYWlyYm5iLWJyb3dzZXItc2hpbXMnXG5cbi8vIEludGVybmFsXG5pbXBvcnQgJy4vbW9kdWxlcy9oZWxwZXJzJ1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXInXG5pbXBvcnQgVUlDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy91aWNvbnRyb2xsZXInXG5pbXBvcnQgUGFzdEJ1ZGdldCBmcm9tICcuL21vZHVsZXMvcGFzdGJ1ZGdldCdcblxuLy8gUmVtb3ZlIGxvYWRpbmcgY2xhc3MgZnJvbSBib2R5IG9uIHdpbmRvdyBsb2FkLlxuY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG53aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1sb2FkaW5nJylcbiAgfSwgMTAwKVxufVxuXG4vLyBDcmVhdGUgdGhlIG1haW4gY29udHJvbGxlciBmb3IgdGhlIGFwcFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG5jb25zdCBjb250cm9sbGVyID0gKChidWRnZXRDdHJsKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX19mb3JtJylcbiAgY29uc3QgdHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX3R5cGUnKVxuICBjb25zdCBkZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZGVzY3JpcHRpb24nKVxuICBjb25zdCB2YWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX3ZhbHVlJylcblxuICBjb25zdCBVSUN0cmwgPSBuZXcgVUlDb250cm9sbGVyKHR5cGUsIGRlc2MsIHZhbHVlKVxuICBjb25zdCBwYXN0YnVkZ2V0ID0gbmV3IFBhc3RCdWRnZXQoKVxuXG4gIC8vIFNob2UgdGhlIGxhdGVzdCBkYXRlXG4gIFVJQ3RybC5kaXNwbGF5RGF0ZSgpXG5cbiAgLy8gVG9nZ2xlIHRoZSBzdWJtaXQgbmV3IGNvc3QgZnJvbSBlaXRoZXIgaW5jb21lIG9yIGV4cGVuc2UuXG4gIFVJQ3RybC5jaGFuZ2VUeXBlKClcblxuICAvLyBTYXZlIGJ1ZGdldHMgdG8gRmlyZWJhc2VcbiAgVUlDdHJsLnNhdmluZygpXG5cbiAgY29uc3QgdGVzdCA9IGJ1ZGdldEN0cmwuZ2V0RGF0YSgpXG4gIGNvbnN0IHsgaW5jIH0gPSB0ZXN0LmFsbEl0ZW1zXG5cbiAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgLy8gR2V0IGZpbGVkIGlucHV0IGRhdGFcbiAgICBjb25zdCBpbnB1dCA9IFVJQ3RybC5nZXRJbnB1dCgpXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKGlucHV0KVxuICAgICAgY29uc29sZS5sb2codHlwZW9mIGlucHV0LnZhbHVlKVxuICAgIH1cblxuICAgIC8vIENsZWFyIHRoZSBmb3JtIGZpZWxkc1xuICAgIGZvcm0ucmVzZXQoKVxuXG4gICAgLy8gT25seSBydW4gY2FsY3VsYXRpb25zIGlmIHZhbGlkIGlucHV0cyBhcmUgZW50ZXJlZFxuICAgIGlmIChpbnB1dC5kZXNjICE9PSAnJyAmJiAhaXNOYU4oaW5wdXQudmFsdWUpICYmIGlucHV0LnZhbHVlID4gMCkge1xuICAgICAgLy8gQWRkIHRoZSBpdGVtIHRvIHRoZSBidWRnZXRcbiAgICAgIGNvbnN0IG5ld0l0ZW0gPSBidWRnZXRDdHJsLmFkZEl0ZW0oXG4gICAgICAgIGlucHV0LnR5cGUsXG4gICAgICAgIGlucHV0LmRlc2NyaXB0aW9uLFxuICAgICAgICBpbnB1dC52YWx1ZVxuICAgICAgKVxuXG4gICAgICAvLyBDYWxjdWxhZSB0aGUgYnVkZ2V0IGFuZCB1cGRhdGUgdGhlIFVJXG4gICAgICBVSUN0cmwucmVuZGVyKG5ld0l0ZW0sIGlucHV0LnR5cGUpIC8vIEFkZCBpdGVtcyB0byBpbmNvbWUgb3IgZXhwZW5zZXMgbGlzdFxuICAgICAgVUlDdHJsLnVwZGF0ZUJ1ZGdldCgpIC8vIE91dHB1dCB0aGUgbmV3IGJ1ZGdldFxuICAgICAgVUlDdHJsLnVwZGF0ZVBlcmNlbnRhZ2VzKCkgLy8gT3V0cHV0IHRoZSBuZXcgcGVyY2VudGFnZXNcblxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Zvcm0gc3VibWl0dGVkIScpXG4gICAgICAgIGNvbnNvbGUubG9nKG5ld0l0ZW0pXG4gICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGluYylcbiAgfSlcbiAgLy8gRGVsZXRlIGFuIGFkZGVkIGluY29tZSBvciBleHBlbnNlXG4gIFVJQ3RybC5kZWxldGVJdGVtKClcblxuICBwYXN0YnVkZ2V0LmdldEJ1ZGdldCgoZGF0YSwgaWQpID0+IHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coZGF0YSwgaWQpXG4gICAgfVxuICB9KVxufSkoYnVkZ2V0Q29udHJvbGxlcilcbiIsIm1vZHVsZS5leHBvcnRzID0gYnJvd3NlcjsiLCJjb25zdCBidWRnZXRDb250cm9sbGVyID0gKCgpID0+IHtcbiAgY2xhc3MgQnVkZ2V0IHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgICB0aGlzLmlkID0gaWRcbiAgICAgIHRoaXMuZGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgICB0aGlzLnZhbCA9IHZhbHVlXG4gICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAtMVxuICAgIH1cblxuICAgIGNhbGNQZXJjZW50YWdlKHRvdGFsSW5jb21lKSB7XG4gICAgICBpZiAodG90YWxJbmNvbWUgPiAwKSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKHRoaXMudmFsIC8gdG90YWxJbmNvbWUpICogMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGB0aGlzIHZhbHVlIGlzICR7dHlwZW9mIHRoaXMudmFsfWAsXG4gICAgICAgICAgYHRoZSB0b3RhbEluY29tZSAke3R5cGVvZiB0b3RhbEluY29tZX1gXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQZXJjZW50YWdlKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGVyY2VudGFnZVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgYWxsSXRlbXM6IHtcbiAgICAgIGV4cDogW10sXG4gICAgICBpbmM6IFtdLFxuICAgICAgc2F2OiBbXSxcbiAgICB9LFxuICAgIHRvdGFsczoge1xuICAgICAgZXhwOiAwLFxuICAgICAgaW5jOiAwLFxuICAgICAgc2F2OiAwLFxuICAgIH0sXG4gICAgcGVyY2VudDoge1xuICAgICAgZXhwOiAtMSxcbiAgICAgIHNhdjogLTEsXG4gICAgfSxcbiAgICBidWRnZXQ6IDAsXG4gIH1cblxuICBjb25zdCBjYWxjdWxhdGVUb3RhbHMgPSAodHlwZSkgPT4ge1xuICAgIGxldCBzdW0gPSAwXG4gICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgIHN1bSArPSBjdXIudmFsXG4gICAgfSlcbiAgICBkYXRhLnRvdGFsc1t0eXBlXSA9IHN1bVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRJdGVtOiAodHlwZSwgZGVzYywgdmFsKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbmV3IElEXG4gICAgICBjb25zdCBJRCA9XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMFxuICAgICAgICAgID8gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMVxuICAgICAgICAgIDogMFxuXG4gICAgICAvLyBTZXQgbmV3IGl0ZW0gdG8gdXNlIG9iamVjdFxuICAgICAgY29uc3QgbmV3SXRlbSA9IG5ldyBCdWRnZXQoSUQsIGRlc2MsIHZhbClcblxuICAgICAgLy8gUHVzaCBpdCBpbnRvIGRhdGEgc3RydWN0dXJlXG4gICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSlcblxuICAgICAgLy8gY3JlYXRlIG5ldyBpdGVtXG4gICAgICByZXR1cm4gbmV3SXRlbVxuICAgIH0sXG4gICAgY2FsY3VsYXRlQnVkZ2V0OiAoKSA9PiB7XG4gICAgICAvLyAxLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldFxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdleHAnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdpbmMnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdzYXYnKVxuXG4gICAgICAvLyAyLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldDogaW5jb21lIC0gZXhwZW5zZXNcbiAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhbHMuaW5jIC0gKGRhdGEudG90YWxzLmV4cCArIGRhdGEudG90YWxzLnNhdilcblxuICAgICAgLy8gMy4gQ2FsY3VsYXRlIHRoZSBwZXJjZW50YWdlIG9mIGluY29tZSB0aGF0IHdlIHNwZW50XG4gICAgICBpZiAoZGF0YS50b3RhbHMuaW5jID4gMCkge1xuICAgICAgICBkYXRhLnBlcmNlbnQuZXhwID0gTWF0aC5yb3VuZCgoZGF0YS50b3RhbHMuZXhwIC8gZGF0YS50b3RhbHMuaW5jKSAqIDEwMClcbiAgICAgICAgZGF0YS5wZXJjZW50LnNhdiA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLnNhdiAvIGRhdGEudG90YWxzLmluYykgKiAxMDApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhLnBlcmNlbnQuZXhwID0gLTFcbiAgICAgICAgZGF0YS5wZXJjZW50LnNhdiA9IC0xXG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLnRvdGFscy5leHAsIGRhdGEudG90YWxzLmluYylcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS5idWRnZXQsIGRhdGEucGVyY2VudC5leHAsIGRhdGEucGVyY2VudC5zYXYpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSxcbiAgICBjYWxjdWxhdGVQZXJjZW50YWdlczogKHR5cGUpID0+IHtcbiAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICAgIGN1ci5jYWxjUGVyY2VudGFnZShkYXRhLnRvdGFscy5pbmMpXG4gICAgICB9KVxuICAgIH0sXG4gICAgZ2V0UGVyY2VudGFnZXM6ICh0eXBlKSA9PiB7XG4gICAgICBjb25zdCBhbGxQZXJjID0gZGF0YS5hbGxJdGVtc1t0eXBlXS5tYXAoKGN1cikgPT4ge1xuICAgICAgICByZXR1cm4gY3VyLmdldFBlcmNlbnRhZ2UoKVxuICAgICAgfSlcbiAgICAgIHJldHVybiBhbGxQZXJjXG4gICAgfSxcbiAgICByZW1vdmVJdGVtOiAodHlwZSwgaWQpID0+IHtcbiAgICAgIGNvbnN0IGlkcyA9IGRhdGEuYWxsSXRlbXNbdHlwZV0ubWFwKChjdXJyZW50KSA9PiB7XG4gICAgICAgIHJldHVybiBjdXJyZW50LmlkXG4gICAgICB9KVxuICAgICAgY29uc3QgaW5kZXggPSBpZHMuaW5kZXhPZihpZClcblxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnNwbGljZShpbmRleCwgMSlcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldERhdGE6ICgpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSxcbiAgfVxufSkoKVxuXG5leHBvcnQgZGVmYXVsdCBidWRnZXRDb250cm9sbGVyXG4iXSwic291cmNlUm9vdCI6IiJ9