(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{"+4zn":function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),o=n.n(a),s=n("yXPU"),c=n.n(s),i=n("lwsE"),l=n.n(i),u=n("W8MJ"),r=n.n(u),d=function(){function e(){l()(this,e),this.budgets=db.collection("budgets")}var t;return r()(e,[{key:"saveBudget",value:(t=c()(o.a.mark((function e(t){var n,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,a={budget:t.budget,totalInc:t.totals.inc,totalExp:t.totals.exp,totalSav:t.totals.sav,percentExp:t.percent.exp,percentSav:t.percent.sav,created_at:firebase.firestore.Timestamp.fromDate(n)},e.next=4,this.budgets.add(a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getBudget",value:function(e){this.budgets.orderBy("created_at").onSnapshot((function(t){t.docChanges().forEach((function(t){"added"===t.type&&e(t.doc.data(),t.doc.id)}))}))}}]),e}();t.default=d},0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,a=function(){},o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],s=o.length,c=window.console=window.console||{};s--;)c[n=o[s]]||(c[n]=a);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var i=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?i.classList.add("is-mobile"):(t.on(">medium",(function(){i.classList.remove("is-mobile"),i.classList.add("is-desktop")})),t.on("<=medium",(function(){i.classList.remove("is-desktop"),i.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var a=n("lwsE"),o=n.n(a),s=n("W8MJ"),c=n.n(s),i=n("xVb/"),l=new(n("+4zn").default),u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=Math.abs(e),s=(o=o.toFixed(2)).split("."),c=s[0],i=s[1];i=Number(i)>0?".".concat(i):"",c.length>3&&(c="".concat(c.substr(0,c.length-3),",").concat(c.substr(c.length-3,3)));var l=n?'<span class="currency">&pound;</span>':"";return"".concat(a?"exp"===t?'<span class="sign">&#45;</span> ':'<span class="sign">&#43;</span> ':"").concat(l).concat(c).concat(i)},r=function(){function e(t,n,a){o()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=a}return c()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"render",value:function(e,t){var n,a="exp"===t?"expenses":"sav"===t?"savings":"income",o=document.querySelector(".".concat(a,"__list"));n="\n    <li class='".concat(a,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p>").concat(u(e.val,t,!0,!1),"</p></div>\n    "),"exp"!==t&&"sav"!==t||(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',o.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,totalSav:e.totals.sav,percentExp:e.percent.exp,percentSav:e.percent.sav}}},{key:"displayBudget",value:function(e){var t=e.budget>0?"inc":"exp",n="exp"===t?"expenses":"income",a=document.querySelector(".budget__value"),o=document.querySelector(".budget__income .budget__amount"),s=document.querySelector(".budget__expenses .budget__amount"),c=document.querySelector(".budget__savings .budget__amount");a.innerHTML=u(e.budget,t,!0),o.innerHTML=u(e.totalInc,"inc"),s.innerHTML=u(e.totalExp,"exp"),c.innerHTML=u(e.totalSav,"exp"),console.log("The ".concat(n," is/are ").concat(e.budget)),console.log(o,s)}},{key:"displayPercentage",value:function(e,t){var n="exp"===t?"expenses":"savings",a=document.querySelector(".budget__".concat(n," .budget__percentage"));e>0?(a.classList.add("show"),a.innerHTML="".concat(e,"&#37;")):a.classList.remove("show"),console.log(a)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percentExp,"exp"),this.displayPercentage(t.percentSav,"sav")}},{key:"displayPercentages",value:function(e,t){var n="exp"===t?"expenses":"savings";!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".".concat(n," .items__percent")),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){i.default.calculatePercentages(this.inputType.value);var e=i.default.getPercentages(this.inputType.value);this.displayPercentages(e,this.inputType.value)}},{key:"displayDate",value:function(){var e=document.querySelector(".budget__date"),t=new Date;e.textContent="".concat(["January","February","March","April","May","June","July","August","Sepetember","October","November","December"][t.getMonth()]," ").concat(t.getFullYear())}},{key:"changeType",value:function(){var e=this.inputType,t=document.querySelector("#check");e.addEventListener("change",(function(n){var a=Array.from(e.options);console.log(n),console.log(e.attributes,e.options,e.options.selectedIndex,a,a[1]),a.forEach((function(e){e.selected?(e.setAttribute("selected","selected"),t.classList.remove("exp","sav"),"exp"===e.value?t.classList.add("exp"):"sav"===e.value&&t.classList.add("sav")):e.removeAttribute("selected","selected"),console.log("Value ".concat(e.value))}))}))}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,a=n.id.split("-"),o=a[0],s=Number(a[1]);console.log(t.target,n,a,o,s),i.default.removeItem(o,s),n.remove(),e.updateBudget(),e.updatePercentages()}}))}},{key:"saving",value:function(){var e=document.querySelector("#save"),t=i.default.getData();e.addEventListener("click",(function(){console.log(t),l.saveBudget(t).then((function(){console.log("saved")})).catch((function(e){console.error(e)}))}))}}]),e}();t.default=r},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var a=n("cDf5"),o=n.n(a),s=(n("OuUZ"),n("E4hX"),n("xVb/")),c=n("SEKM"),i=document.querySelector("body");window.onload=function(){window.setTimeout((function(){i.classList.remove("is-loading")}),100)};var l,u,r,d,p,v;l=s.default,u=document.querySelector(".add__form"),r=document.querySelector(".add__type"),d=document.querySelector(".add__description"),p=document.querySelector(".add__value"),(v=new c.default(r,d,p)).displayDate(),v.changeType(),v.saving(),u.addEventListener("submit",(function(e){e.preventDefault();var t=v.getInput();if(console.log(t),console.log(o()(t.value)),u.reset(),""!==t.desc&&!isNaN(t.value)&&t.value>0){var n=l.addItem(t.type,t.description,t.value);v.render(n,t.type),v.updateBudget(),v.updatePercentages(),console.log("form submitted!"),console.log(n)}})),v.deleteItem()},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var a,o,s,c=n("cDf5"),i=n.n(c),l=n("lwsE"),u=n.n(l),r=n("W8MJ"),d=n.n(r),p=(a=function(){function e(t,n,a){u()(this,e),this.id=t,this.desc=n,this.val=a,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(i()(this.val)),"the totalIncome ".concat(i()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),o={allItems:{exp:[],inc:[],sav:[]},totals:{exp:0,inc:0,sav:0},percent:{exp:-1,sav:-1},budget:0},s=function(e){var t=0;o.allItems[e].forEach((function(e){t+=e.val})),o.totals[e]=t},{addItem:function(e,t,n){var s=o.allItems[e].length>0?o.allItems[e][o.allItems[e].length-1].id+1:0,c=new a(s,t,n);return o.allItems[e].push(c),c},calculateBudget:function(){return s("exp"),s("inc"),s("sav"),o.budget=o.totals.inc-(o.totals.exp+o.totals.sav),o.totals.inc>0?(o.percent.exp=Math.round(o.totals.exp/o.totals.inc*100),o.percent.sav=Math.round(o.totals.sav/o.totals.inc*100)):(o.percent.exp=-1,o.percent.sav=-1),console.log(o.totals.exp,o.totals.inc),console.log(o.budget,o.percent.exp,o.percent.sav),o},calculatePercentages:function(e){o.allItems[e].forEach((function(e){e.calcPercentage(o.totals.inc)}))},getPercentages:function(e){return o.allItems[e].map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=o.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&o.allItems[e].splice(n,1)},getData:function(){return o}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL3Bhc3RidWRnZXQuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy9oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvdWljb250cm9sbGVyLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyZWFrcG9pbnRzXCIiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvYXBwLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyb3dzZXJcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiUGFzdEJ1ZGdldCIsInRoaXMiLCJidWRnZXRzIiwiZGIiLCJjb2xsZWN0aW9uIiwib2JqIiwibm93IiwiRGF0ZSIsImJ1ZGdldCIsInRvdGFsSW5jIiwidG90YWxzIiwiaW5jIiwidG90YWxFeHAiLCJleHAiLCJ0b3RhbFNhdiIsInNhdiIsInBlcmNlbnRFeHAiLCJwZXJjZW50IiwicGVyY2VudFNhdiIsImNyZWF0ZWRfYXQiLCJmaXJlYmFzZSIsImZpcmVzdG9yZSIsIlRpbWVzdGFtcCIsImZyb21EYXRlIiwiYWRkIiwicmVzcG9uc2UiLCJjYiIsIm9yZGVyQnkiLCJvblNuYXBzaG90Iiwic25hcHNob3QiLCJkb2NDaGFuZ2VzIiwiZm9yRWFjaCIsImNoYW5nZSIsInR5cGUiLCJkb2MiLCJkYXRhIiwiaWQiLCJtZXRob2QiLCJub29wIiwibWV0aG9kcyIsImxlbmd0aCIsImNvbnNvbGUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRmlyc3RUYWIiLCJlIiwia2V5Q29kZSIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiYnJvd3NlciIsIm5hbWUiLCJicmVha3BvaW50cyIsInhsYXJnZSIsImxhcmdlIiwibWVkaXVtIiwic21hbGwiLCJ4c21hbGwiLCJtb2JpbGUiLCJvbiIsInJlbW92ZSIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJsb2ciLCJwYXN0YnVkZ2V0IiwiZm9ybWF0TnVtYmVyIiwibnVtYmVyIiwibW9uZXkiLCJjYWxjIiwibnVtIiwiTWF0aCIsImFicyIsIm51bVNwbGl0IiwidG9GaXhlZCIsInNwbGl0IiwiaW50IiwiZGVjaW1hbCIsIk51bWJlciIsInN1YnN0ciIsImN1cnJlbmN5IiwiVUlDb250cm9sbGVyIiwiY29zdCIsImRlc2NyaXB0aW9uIiwidmFsdWUiLCJpbnB1dFR5cGUiLCJpbnB1dERlc2MiLCJpbnB1dFZhbCIsImh0bWwiLCJpdGVtIiwibGlzdCIsImRlc2MiLCJ2YWwiLCJpbm5lckhUTUwiLCJ0eXBlcyIsInBlcmNlbnRhZ2UiLCJnZXREYXRhIiwiYnVkZ2V0Q29udHJvbGxlciIsImNhbGN1bGF0ZUJ1ZGdldCIsIm5ld0J1ZGdldCIsImdldEJ1ZGdldCIsImRpc3BsYXlCdWRnZXQiLCJkaXNwbGF5UGVyY2VudGFnZSIsInBlcmNlbnRhZ2VzIiwiaSIsIm5vZGVMaXN0Rm9yRWFjaCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjdXJyZW50IiwiaW5kZXgiLCJjYWxjdWxhdGVQZXJjZW50YWdlcyIsImdldFBlcmNlbnRhZ2VzIiwiZGlzcGxheVBlcmNlbnRhZ2VzIiwiYnVkZ2V0RGF0ZSIsImRhdGUiLCJ0ZXh0Q29udGVudCIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJjaGVjayIsIm9wdGlvbnMiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwic2VsZWN0ZWRJbmRleCIsIm9wdGlvbiIsInNlbGVjdGVkIiwicmVtb3ZlQXR0cmlidXRlIiwidGFyZ2V0IiwiY2xvc2VzdCIsInBhcmVudEVsZW1lbnQiLCJzcGxpdElEIiwiSUQiLCJyZW1vdmVJdGVtIiwidXBkYXRlQnVkZ2V0IiwidXBkYXRlUGVyY2VudGFnZXMiLCJidXR0b24iLCJzYXZlQnVkZ2V0IiwidGhlbiIsImVyciIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyIsIm9ubG9hZCIsInNldFRpbWVvdXQiLCJidWRnZXRDdHJsIiwiZm9ybSIsIlVJQ3RybCIsImRpc3BsYXlEYXRlIiwiY2hhbmdlVHlwZSIsInNhdmluZyIsInByZXZlbnREZWZhdWx0IiwiaW5wdXQiLCJnZXRJbnB1dCIsInJlc2V0IiwiaXNOYU4iLCJuZXdJdGVtIiwiYWRkSXRlbSIsInJlbmRlciIsImRlbGV0ZUl0ZW0iLCJCdWRnZXQiLCJjYWxjdWxhdGVUb3RhbHMiLCJ0b3RhbEluY29tZSIsInJvdW5kIiwiYWxsSXRlbXMiLCJzdW0iLCJjdXIiLCJwdXNoIiwiY2FsY1BlcmNlbnRhZ2UiLCJtYXAiLCJnZXRQZXJjZW50YWdlIiwiaW5kZXhPZiIsInNwbGljZSJdLCJtYXBwaW5ncyI6ImdNQUFNQSxFLFdBQ0osYUFBYyxZQUNaQyxLQUFLQyxRQUFVQyxHQUFHQyxXQUFXLFcsd0VBR2RDLEcsa0ZBQ1RDLEVBQU0sSUFBSUMsS0FDVkMsRUFBUyxDQUNiQSxPQUFRSCxFQUFJRyxPQUNaQyxTQUFVSixFQUFJSyxPQUFPQyxJQUNyQkMsU0FBVVAsRUFBSUssT0FBT0csSUFDckJDLFNBQVVULEVBQUlLLE9BQU9LLElBQ3JCQyxXQUFZWCxFQUFJWSxRQUFRSixJQUN4QkssV0FBWWIsRUFBSVksUUFBUUYsSUFNeEJJLFdBQVlDLFNBQVNDLFVBQVVDLFVBQVVDLFNBQVNqQixJLFNBRTdCTCxLQUFLQyxRQUFRc0IsSUFBSWhCLEcsY0FBbENpQixFLHlCQUNDQSxHLDhIQUdDQyxHQUNSekIsS0FBS0MsUUFBUXlCLFFBQVEsY0FBY0MsWUFBVyxTQUFDQyxHQUM3Q0EsRUFBU0MsYUFBYUMsU0FBUSxTQUFDQyxHQUNULFVBQWhCQSxFQUFPQyxNQUNUUCxFQUFHTSxFQUFPRSxJQUFJQyxPQUFRSCxFQUFPRSxJQUFJRSxjLEtBTzVCcEMsYSwrRUNwQ2YsY0FxQ0UsSUEvQkEsSUFBSXFDLEVBQ0VDLEVBQU8s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RXdCLEVBQUtsQixRQUFRSixLQUFPLEVBQ3BCc0IsRUFBS2xCLFFBQVFGLEtBQU8sR0FLcEIwQixRQUFReUIsSUFBSS9CLEVBQUt6QixPQUFPRyxJQUFLc0IsRUFBS3pCLE9BQU9DLEtBQ3pDOEIsUUFBUXlCLElBQUkvQixFQUFLM0IsT0FBUTJCLEVBQUtsQixRQUFRSixJQUFLc0IsRUFBS2xCLFFBQVFGLEtBR25Eb0IsR0FFVDRFLHFCQUFzQixTQUFDOUUsR0FDckJFLEVBQUtpSSxTQUFTbkksR0FBTUYsU0FBUSxTQUFDdUksR0FDM0JBLEVBQUlFLGVBQWVySSxFQUFLekIsT0FBT0MsU0FHbkNxRyxlQUFnQixTQUFDL0UsR0FJZixPQUhnQkUsRUFBS2lJLFNBQVNuSSxHQUFNd0ksS0FBSSxTQUFDSCxHQUN2QyxPQUFPQSxFQUFJSSxvQkFJZnJDLFdBQVksU0FBQ3BHLEVBQU1HLEdBQ2pCLElBR00wRSxFQUhNM0UsRUFBS2lJLFNBQVNuSSxHQUFNd0ksS0FBSSxTQUFDNUQsR0FDbkMsT0FBT0EsRUFBUXpFLE1BRUN1SSxRQUFRdkksSUFFWCxJQUFYMEUsR0FDRjNFLEVBQUtpSSxTQUFTbkksR0FBTTJJLE9BQU85RCxFQUFPLElBR3RDWixRQUFTLFdBQ1AsT0FBTy9ELEtBS0VnRSxjIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBQYXN0QnVkZ2V0IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5idWRnZXRzID0gZGIuY29sbGVjdGlvbignYnVkZ2V0cycpXG4gIH1cblxuICBhc3luYyBzYXZlQnVkZ2V0KG9iaikge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBidWRnZXQgPSB7XG4gICAgICBidWRnZXQ6IG9iai5idWRnZXQsXG4gICAgICB0b3RhbEluYzogb2JqLnRvdGFscy5pbmMsXG4gICAgICB0b3RhbEV4cDogb2JqLnRvdGFscy5leHAsXG4gICAgICB0b3RhbFNhdjogb2JqLnRvdGFscy5zYXYsXG4gICAgICBwZXJjZW50RXhwOiBvYmoucGVyY2VudC5leHAsXG4gICAgICBwZXJjZW50U2F2OiBvYmoucGVyY2VudC5zYXYsXG4gICAgICAvLyBhbGxJdGVtczoge1xuICAgICAgLy8gICBleHA6IG9iai5hbGxJdGVtcy5leHAsXG4gICAgICAvLyAgIGluYzogb2JqLmFsbEl0ZW1zLmluYyxcbiAgICAgIC8vICAgc2F2OiBvYmouYWxsSXRlbXMuc2F2LFxuICAgICAgLy8gfSxcbiAgICAgIGNyZWF0ZWRfYXQ6IGZpcmViYXNlLmZpcmVzdG9yZS5UaW1lc3RhbXAuZnJvbURhdGUobm93KSxcbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmJ1ZGdldHMuYWRkKGJ1ZGdldClcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIGdldEJ1ZGdldChjYikge1xuICAgIHRoaXMuYnVkZ2V0cy5vcmRlckJ5KCdjcmVhdGVkX2F0Jykub25TbmFwc2hvdCgoc25hcHNob3QpID0+IHtcbiAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKChjaGFuZ2UpID0+IHtcbiAgICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAnYWRkZWQnKSB7XG4gICAgICAgICAgY2IoY2hhbmdlLmRvYy5kYXRhKCksIGNoYW5nZS5kb2MuaWQpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQYXN0QnVkZ2V0XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcGx1c3BsdXMgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuXG4vLyBBdm9pZCBgY29uc29sZWAgZXJyb3JzIGluIGJyb3dzZXJzIHRoYXQgbGFjayBhIGNvbnNvbGUuXG57XG4gIGxldCBtZXRob2RcbiAgY29uc3Qgbm9vcCA9ICgpID0+IHt9XG4gIGNvbnN0IG1ldGhvZHMgPSBbXG4gICAgJ2Fzc2VydCcsXG4gICAgJ2NsZWFyJyxcbiAgICAnY291bnQnLFxuICAgICdkZWJ1ZycsXG4gICAgJ2RpcicsXG4gICAgJ2RpcnhtbCcsXG4gICAgJ2Vycm9yJyxcbiAgICAnZXhjZXB0aW9uJyxcbiAgICAnZ3JvdXAnLFxuICAgICdncm91cENvbGxhcHNlZCcsXG4gICAgJ2dyb3VwRW5kJyxcbiAgICAnaW5mbycsXG4gICAgJ2xvZycsXG4gICAgJ21hcmtUaW1lbGluZScsXG4gICAgJ3Byb2ZpbGUnLFxuICAgICdwcm9maWxlRW5kJyxcbiAgICAndGFibGUnLFxuICAgICd0aW1lJyxcbiAgICAndGltZUVuZCcsXG4gICAgJ3RpbWVsaW5lJyxcbiAgICAndGltZWxpbmVFbmQnLFxuICAgICd0aW1lU3RhbXAnLFxuICAgICd0cmFjZScsXG4gICAgJ3dhcm4nLFxuICBdXG4gIGxldCB7IGxlbmd0aCB9ID0gbWV0aG9kc1xuICBjb25zdCBjb25zb2xlID0gKHdpbmRvdy5jb25zb2xlID0gd2luZG93LmNvbnNvbGUgfHwge30pXG5cbiAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgbWV0aG9kID0gbWV0aG9kc1tsZW5ndGhdXG5cbiAgICAvLyBPbmx5IHN0dWIgdW5kZWZpbmVkIG1ldGhvZHMuXG4gICAgaWYgKCFjb25zb2xlW21ldGhvZF0pIHtcbiAgICAgIGNvbnNvbGVbbWV0aG9kXSA9IG5vb3BcbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHRhYmJpbmcgaW5kaWNhdG9yIHRvIHdpbmRvd1xuY29uc3QgaGFuZGxlRmlyc3RUYWIgPSAoZSkgPT4ge1xuICBpZiAoZS5rZXlDb2RlID09PSA5KSB7XG4gICAgLy8gdGhlIFwiSSBhbSBhIGtleWJvYXJkIHVzZXJcIiBrZXlcbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3VzZXItaXMtdGFiYmluZycpXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVGaXJzdFRhYilcbiAgfVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUZpcnN0VGFiKVxuXG4vLyBBZGQgYSBicm93ZXIgaW5kaWNhdG9yIHRvIHRoZSBIVE1MIGVsZW1lbnQuXG5jb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpXG5odG1sLnNldEF0dHJpYnV0ZSgnZGF0YS1icm93c2VyJywgYnJvd3Nlci5uYW1lKVxuXG4vLyBEZXRlY3QgaWYgbW9iaWxlIG9yIGRlc2t0b3AuXG5jb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpXG5cbmJyZWFrcG9pbnRzKHtcbiAgeGxhcmdlOiBbJzEyODFweCcsICcxNjgwcHgnXSxcbiAgbGFyZ2U6IFsnOTgxcHgnLCAnMTI4MHB4J10sXG4gIG1lZGl1bTogWyc3MzdweCcsICc5ODBweCddLFxuICBzbWFsbDogWyc0ODFweCcsICc3MzZweCddLFxuICB4c21hbGw6IFtudWxsLCAnNDgwcHgnXSxcbn0pXG5cbmlmIChicm93c2VyLm1vYmlsZSkge1xuICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpXG59IGVsc2Uge1xuICBicmVha3BvaW50cy5vbignPm1lZGl1bScsICgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW1vYmlsZScpXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1kZXNrdG9wJylcbiAgfSlcbiAgYnJlYWtwb2ludHMub24oJzw9bWVkaXVtJywgKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZGVza3RvcCcpXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1tb2JpbGUnKVxuICB9KVxufVxuXG4vLyBMb2cgaWYgcnVubmluZyBpbiBsb2NhbGhvc3Qgd2hlbiBpbiBkZXZlbG9wbWVudCBtb2RlLlxuaWYgKFxuICB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnICYmXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbidcbikge1xuICBjb25zb2xlLmxvZygnbG9jYWxob3N0IGRldGVjdGVkIScpXG59XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzICovXG5pbXBvcnQgYnVkZ2V0Q29udHJvbGxlciBmcm9tICcuL2J1ZGdldGNvbnRyb2xsZXInXG5pbXBvcnQgUGFzdEJ1ZGdldCBmcm9tICcuL3Bhc3RidWRnZXQnXG5cbmNvbnN0IHBhc3RidWRnZXQgPSBuZXcgUGFzdEJ1ZGdldCgpXG5cbmNvbnN0IGZvcm1hdE51bWJlciA9IChudW1iZXIsIHR5cGUsIG1vbmV5ID0gZmFsc2UsIGNhbGMgPSB0cnVlKSA9PiB7XG4gIC8qKlxuICAgKiArIG9yIC0gYmVmb3JlIHRoZSBudW1iZXJcbiAgICogZXhhY3RseSAyIGRlY2ltYWwgcG9pbnRzXG4gICAqIGNvbW1hIHNlcGVyYXRpbmcgdGhlIHRob3VzYW5kc1xuICAgKlxuICAgKiAyMzEwLjQ1NjcgPSArIDIsMzEwLjQ2XG4gICAqL1xuICBsZXQgbnVtID0gTWF0aC5hYnMobnVtYmVyKVxuICBudW0gPSBudW0udG9GaXhlZCgyKVxuXG4gIGNvbnN0IG51bVNwbGl0ID0gbnVtLnNwbGl0KCcuJykgLy8gbm93IGEgc3RyaW5nIGFuZCB3aWxsIHNwbGl0IHRoZSAuIHRvIHJlcGxhY2Ugd2l0aCBhICxcbiAgbGV0IGludCA9IG51bVNwbGl0WzBdXG4gIGxldCBkZWNpbWFsID0gbnVtU3BsaXRbMV1cbiAgZGVjaW1hbCA9IE51bWJlcihkZWNpbWFsKSA+IDAgPyBgLiR7ZGVjaW1hbH1gIDogJydcblxuICBpZiAoaW50Lmxlbmd0aCA+IDMpIHtcbiAgICAvLyBzdWJzdHIgYWxsb3dzIGZvciBvbmx5IHBhcnQgb2YgdGhlIHN0cmluZyB0byBiZSB0YWtlblxuICAgIGludCA9IGAke2ludC5zdWJzdHIoMCwgaW50Lmxlbmd0aCAtIDMpfSwke2ludC5zdWJzdHIoaW50Lmxlbmd0aCAtIDMsIDMpfWAgLy8gaW5wdXQgMjMxMCwgb3V0cHV0IDIsMzEwXG4gIH1cblxuICBsZXQgc2lnblxuICBpZiAoY2FsYykge1xuICAgIHNpZ24gPVxuICAgICAgdHlwZSA9PT0gJ2V4cCdcbiAgICAgICAgPyAnPHNwYW4gY2xhc3M9XCJzaWduXCI+JiM0NTs8L3NwYW4+ICdcbiAgICAgICAgOiAnPHNwYW4gY2xhc3M9XCJzaWduXCI+JiM0Mzs8L3NwYW4+ICdcbiAgfSBlbHNlIHtcbiAgICBzaWduID0gJydcbiAgfVxuICBjb25zdCBjdXJyZW5jeSA9IG1vbmV5ID8gJzxzcGFuIGNsYXNzPVwiY3VycmVuY3lcIj4mcG91bmQ7PC9zcGFuPicgOiAnJ1xuXG4gIC8vIFJldHVybiB0aGUgZm9ybWF0dGVkIHN0cmluZ1xuICByZXR1cm4gYCR7c2lnbn0ke2N1cnJlbmN5fSR7aW50fSR7ZGVjaW1hbH1gXG59XG5cbi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1kZXN0cnVjdHVyaW5nICovXG5jbGFzcyBVSUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3Rvcihjb3N0LCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICB0aGlzLmlucHV0VHlwZSA9IGNvc3RcbiAgICB0aGlzLmlucHV0RGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgdGhpcy5pbnB1dFZhbCA9IHZhbHVlXG4gIH1cblxuICBnZXRJbnB1dCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogdGhpcy5pbnB1dFR5cGUudmFsdWUsIC8vIFdpbGwgYmUgZWl0aGVyIGluYyBvciBleHBcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmlucHV0RGVzYy52YWx1ZSxcbiAgICAgIHZhbHVlOiBOdW1iZXIodGhpcy5pbnB1dFZhbC52YWx1ZSksXG4gICAgfVxuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNsYXNzLW1ldGhvZHMtdXNlLXRoaXNcbiAgcmVuZGVyKG9iaiwgdHlwZSkge1xuICAgIGNvbnN0IGl0ZW0gPVxuICAgICAgdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogdHlwZSA9PT0gJ3NhdicgPyAnc2F2aW5ncycgOiAnaW5jb21lJ1xuICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpdGVtfV9fbGlzdGApXG4gICAgbGV0IGh0bWxcblxuICAgIC8vIENyZWF0ZSBIVE1MIHN0cmluZyB3aXRoIHBsYWNlaG9sZGVyXG4gICAgaHRtbCA9IGBcbiAgICA8bGkgY2xhc3M9JyR7aXRlbX1fX2l0ZW0nIGlkPScke3R5cGV9LSR7b2JqLmlkfSc+XG4gICAgICA8ZGl2IGNsYXNzPSdpdGVtLWRlc2MnPjxwPiR7b2JqLmRlc2N9PC9wPjwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cIml0ZW1zXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9J2l0ZW1zX192YWx1ZSc+PHA+JHtmb3JtYXROdW1iZXIoXG4gICAgICAgICAgb2JqLnZhbCxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHRydWUsXG4gICAgICAgICAgZmFsc2VcbiAgICAgICAgKX08L3A+PC9kaXY+XG4gICAgYFxuXG4gICAgaWYgKHR5cGUgPT09ICdleHAnIHx8IHR5cGUgPT09ICdzYXYnKSB7XG4gICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiaXRlbXNfX3BlcmNlbnRcIj48cD4wJiMzNzs8L3A+PC9kaXY+J1xuICAgIH1cblxuICAgIGh0bWwgKz0gYFxuICAgICAgICA8YnV0dG9uIGNsYXNzPSdidG4gYnRuLS1jbGVhciBpdGVtc19fZGVsJz5cbiAgICAgICAgICA8c3ZnIGlkPVwiZGVsZXRlXCIgY2xhc3M9XCJpY29uXCIgd2lkdGg9XCIyMFwiIGhlaWdodD1cIjIwXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9XCIvYXNzZXRzL2ltYWdlcy9pY29ucy5zdmcjaWNvbi1kZWxldGVcIj48L3VzZT5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2xpPlxuICAgIGBcblxuICAgIC8vIEluc2VydCBIVE1MIGludG8gdGhlIERPTVxuICAgIGxpc3QuaW5uZXJIVE1MICs9IGh0bWxcbiAgfVxuXG4gIGdldEJ1ZGdldChkYXRhKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1ZGdldDogZGF0YS5idWRnZXQsXG4gICAgICB0b3RhbEluYzogZGF0YS50b3RhbHMuaW5jLFxuICAgICAgdG90YWxFeHA6IGRhdGEudG90YWxzLmV4cCxcbiAgICAgIHRvdGFsU2F2OiBkYXRhLnRvdGFscy5zYXYsXG4gICAgICBwZXJjZW50RXhwOiBkYXRhLnBlcmNlbnQuZXhwLFxuICAgICAgcGVyY2VudFNhdjogZGF0YS5wZXJjZW50LnNhdixcbiAgICB9XG4gIH1cblxuICBkaXNwbGF5QnVkZ2V0KG9iaikge1xuICAgIGNvbnN0IHR5cGUgPSBvYmouYnVkZ2V0ID4gMCA/ICdpbmMnIDogJ2V4cCdcbiAgICBjb25zdCB0eXBlcyA9IHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6ICdpbmNvbWUnXG4gICAgY29uc3QgYnVkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1ZGdldF9fdmFsdWUnKVxuICAgIGNvbnN0IGluYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXRfX2luY29tZSAuYnVkZ2V0X19hbW91bnRgKVxuICAgIGNvbnN0IGV4cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXRfX2V4cGVuc2VzIC5idWRnZXRfX2Ftb3VudGApXG4gICAgY29uc3Qgc2F2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmJ1ZGdldF9fc2F2aW5ncyAuYnVkZ2V0X19hbW91bnRgKVxuXG4gICAgYnVkZ2V0LmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmouYnVkZ2V0LCB0eXBlLCB0cnVlKVxuICAgIGluYy5pbm5lckhUTUwgPSBmb3JtYXROdW1iZXIob2JqLnRvdGFsSW5jLCAnaW5jJylcbiAgICBleHAuaW5uZXJIVE1MID0gZm9ybWF0TnVtYmVyKG9iai50b3RhbEV4cCwgJ2V4cCcpXG4gICAgc2F2LmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmoudG90YWxTYXYsICdleHAnKVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBUaGUgJHt0eXBlc30gaXMvYXJlICR7b2JqLmJ1ZGdldH1gKVxuICAgICAgY29uc29sZS5sb2coaW5jLCBleHApXG4gICAgfVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2UocGVyY2VudGFnZSwgdHlwZSkge1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ3NhdmluZ3MnXG4gICAgY29uc3QgcGVyY2VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmJ1ZGdldF9fJHt0eXBlc30gLmJ1ZGdldF9fcGVyY2VudGFnZWBcbiAgICApXG5cbiAgICBpZiAocGVyY2VudGFnZSA+IDApIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpXG4gICAgICBwZXJjZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2V9JiMzNztgXG4gICAgfSBlbHNlIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgfVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKHBlcmNlbnQpXG4gICAgfVxuICB9XG5cbiAgdXBkYXRlQnVkZ2V0KCkge1xuICAgIC8vIDEuIENoZWNrIGxvY2FsU3RvcmFnZSBmb3Igc2F2ZSBidWRnZXQgZGF0YSwgZWxzZSBnZXQgbmV3IGRhdGFcbiAgICBjb25zdCBnZXREYXRhID0gYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVCdWRnZXQoKVxuXG4gICAgLy8gMi4gUmV0dXJuIHRoZSBidWRnZXRcbiAgICBjb25zdCBuZXdCdWRnZXQgPSB0aGlzLmdldEJ1ZGdldChnZXREYXRhKVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKG5ld0J1ZGdldClcbiAgICB9XG5cbiAgICAvLyAzLiBEaXNwbGF5IHRoZSB1cGRhdGVkIGJ1ZGdldFxuICAgIHRoaXMuZGlzcGxheUJ1ZGdldChuZXdCdWRnZXQpXG5cbiAgICAvLyA0LiBEaXNwbGF5IHRoZSBuZXcgb3ZlcmFsbCBidWRnZXQgcGVyY2VudGFnZVxuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2UobmV3QnVkZ2V0LnBlcmNlbnRFeHAsICdleHAnKVxuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2UobmV3QnVkZ2V0LnBlcmNlbnRTYXYsICdzYXYnKVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2VzKHBlcmNlbnRhZ2VzLCB0eXBlKSB7XG4gICAgY29uc3QgdHlwZXMgPSB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiAnc2F2aW5ncydcbiAgICBjb25zdCBmaWVsZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHt0eXBlc30gLml0ZW1zX19wZXJjZW50YClcbiAgICBjb25zdCBub2RlTGlzdEZvckVhY2ggPSAobGlzdCwgY2IpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjYihsaXN0W2ldLCBpKVxuICAgICAgfVxuICAgIH1cbiAgICBub2RlTGlzdEZvckVhY2goZmllbGRzLCAoY3VycmVudCwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChwZXJjZW50YWdlc1tpbmRleF0gPiAwKSB7XG4gICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpXG4gICAgICAgIGN1cnJlbnQuaW5uZXJIVE1MID0gYCR7cGVyY2VudGFnZXNbaW5kZXhdfSYjMzc7YFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcbiAgICAgICAgY3VycmVudC5pbm5lckhUTUwgPSAnMCYjMzc7J1xuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICB1cGRhdGVQZXJjZW50YWdlcygpIHtcbiAgICAvLyAxLiBDYWx1bGF0ZSBwZXJjZW50YWdlc1xuICAgIGJ1ZGdldENvbnRyb2xsZXIuY2FsY3VsYXRlUGVyY2VudGFnZXModGhpcy5pbnB1dFR5cGUudmFsdWUpXG5cbiAgICAvLyAyLiBSZWFkIHBlcmNlbnRhZ2VzIGZyb20gYnVkZ2V0IGNvbnRyb2xsZXJcbiAgICBjb25zdCBwZXJjZW50YWdlcyA9IGJ1ZGdldENvbnRyb2xsZXIuZ2V0UGVyY2VudGFnZXModGhpcy5pbnB1dFR5cGUudmFsdWUpXG5cbiAgICAvLyAzLiBVcGRhdGUgVUkgdG8gc2hvdyBuZXcgcGVyY2VudGFnZXNcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlcyhwZXJjZW50YWdlcywgdGhpcy5pbnB1dFR5cGUudmFsdWUpXG4gIH1cblxuICBkaXNwbGF5RGF0ZSgpIHtcbiAgICBjb25zdCBidWRnZXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1ZGdldF9fZGF0ZScpXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBtb250aHMgPSBbXG4gICAgICAnSmFudWFyeScsXG4gICAgICAnRmVicnVhcnknLFxuICAgICAgJ01hcmNoJyxcbiAgICAgICdBcHJpbCcsXG4gICAgICAnTWF5JyxcbiAgICAgICdKdW5lJyxcbiAgICAgICdKdWx5JyxcbiAgICAgICdBdWd1c3QnLFxuICAgICAgJ1NlcGV0ZW1iZXInLFxuICAgICAgJ09jdG9iZXInLFxuICAgICAgJ05vdmVtYmVyJyxcbiAgICAgICdEZWNlbWJlcicsXG4gICAgXVxuICAgIGJ1ZGdldERhdGUudGV4dENvbnRlbnQgPSBgJHttb250aHNbZGF0ZS5nZXRNb250aCgpXX0gJHtkYXRlLmdldEZ1bGxZZWFyKCl9YFxuICB9XG5cbiAgY2hhbmdlVHlwZSgpIHtcbiAgICBjb25zdCB0eXBlID0gdGhpcy5pbnB1dFR5cGVcbiAgICBjb25zdCBjaGVjayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjaGVjaycpXG5cbiAgICAvLyBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIC8vICAgY29uc29sZS5sb2coZmllbGRzKVxuICAgIC8vIH1cblxuICAgIHR5cGUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSBBcnJheS5mcm9tKHR5cGUub3B0aW9ucylcblxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgdHlwZS5hdHRyaWJ1dGVzLFxuICAgICAgICAgIHR5cGUub3B0aW9ucyxcbiAgICAgICAgICB0eXBlLm9wdGlvbnMuc2VsZWN0ZWRJbmRleCxcbiAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgIG9wdGlvbnNbMV1cbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBvcHRpb25zLmZvckVhY2goKG9wdGlvbikgPT4ge1xuICAgICAgICBpZiAob3B0aW9uLnNlbGVjdGVkKSB7XG4gICAgICAgICAgb3B0aW9uLnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKVxuICAgICAgICAgIGNoZWNrLmNsYXNzTGlzdC5yZW1vdmUoJ2V4cCcsICdzYXYnKVxuICAgICAgICAgIGlmIChvcHRpb24udmFsdWUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICBjaGVjay5jbGFzc0xpc3QuYWRkKCdleHAnKVxuICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uLnZhbHVlID09PSAnc2F2Jykge1xuICAgICAgICAgICAgY2hlY2suY2xhc3NMaXN0LmFkZCgnc2F2JylcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb3B0aW9uLnJlbW92ZUF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKVxuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFZhbHVlICR7b3B0aW9uLnZhbHVlfWApXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIGRlbGV0ZUl0ZW0oKSB7XG4gICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmNvbWUtZXhwZW5zZXMnKVxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmlkID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KCcuaXRlbXMnKS5wYXJlbnRFbGVtZW50XG4gICAgICAgIGNvbnN0IHNwbGl0SUQgPSB0YXJnZXQuaWQuc3BsaXQoJy0nKVxuICAgICAgICBjb25zdCB0eXBlID0gc3BsaXRJRFswXVxuICAgICAgICBjb25zdCBJRCA9IE51bWJlcihzcGxpdElEWzFdKVxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQsIHRhcmdldCwgc3BsaXRJRCwgdHlwZSwgSUQpXG4gICAgICAgIH1cblxuICAgICAgICAvLyAxLiBEZWxldGUgdGhlIGl0ZW0gZnJvbSB0aGUgZGF0YSBzdHJ1Y3R1cmVcbiAgICAgICAgYnVkZ2V0Q29udHJvbGxlci5yZW1vdmVJdGVtKHR5cGUsIElEKVxuXG4gICAgICAgIC8vIDIuIERlbGV0ZSB0aGUgaXRlbSBmcm9tIHRoZSBVSVxuICAgICAgICB0YXJnZXQucmVtb3ZlKClcblxuICAgICAgICAvLyAzLiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBidWRnZXRcbiAgICAgICAgdGhpcy51cGRhdGVCdWRnZXQoKVxuXG4gICAgICAgIC8vIDQuIFVwZGF0ZSBhbmQgc2hvdyB0aGUgbmV3IHBlcmNlbnRhZ2VzXG4gICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZXMoKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBzYXZpbmcoKSB7XG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NhdmUnKVxuICAgIGNvbnN0IGRhdGEgPSBidWRnZXRDb250cm9sbGVyLmdldERhdGEoKVxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpXG4gICAgICBwYXN0YnVkZ2V0XG4gICAgICAgIC5zYXZlQnVkZ2V0KGRhdGEpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZWQnKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgICB9KVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVUlDb250cm9sbGVyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyZWFrcG9pbnRzOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblxuLy8gRXh0ZXJuYWxcbmltcG9ydCAnYWlyYm5iLWJyb3dzZXItc2hpbXMnXG5cbi8vIEludGVybmFsXG5pbXBvcnQgJy4vbW9kdWxlcy9oZWxwZXJzJ1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXInXG5pbXBvcnQgVUlDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy91aWNvbnRyb2xsZXInXG5cbi8vIFJlbW92ZSBsb2FkaW5nIGNsYXNzIGZyb20gYm9keSBvbiB3aW5kb3cgbG9hZC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jylcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbG9hZGluZycpXG4gIH0sIDEwMClcbn1cblxuLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRyb2xsZXIgZm9yIHRoZSBhcHBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuY29uc3QgY29udHJvbGxlciA9ICgoYnVkZ2V0Q3RybCkgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZm9ybScpXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX190eXBlJylcbiAgY29uc3QgZGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX2Rlc2NyaXB0aW9uJylcbiAgY29uc3QgdmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX192YWx1ZScpXG5cbiAgY29uc3QgVUlDdHJsID0gbmV3IFVJQ29udHJvbGxlcih0eXBlLCBkZXNjLCB2YWx1ZSlcblxuICAvLyBTaG9lIHRoZSBsYXRlc3QgZGF0ZVxuICBVSUN0cmwuZGlzcGxheURhdGUoKVxuXG4gIC8vIFRvZ2dsZSB0aGUgc3VibWl0IG5ldyBjb3N0IGZyb20gZWl0aGVyIGluY29tZSBvciBleHBlbnNlLlxuICBVSUN0cmwuY2hhbmdlVHlwZSgpXG5cbiAgLy8gU2F2ZSBidWRnZXRzIHRvIEZpcmViYXNlXG4gIFVJQ3RybC5zYXZpbmcoKVxuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIC8vIEdldCBmaWxlZCBpbnB1dCBkYXRhXG4gICAgY29uc3QgaW5wdXQgPSBVSUN0cmwuZ2V0SW5wdXQoKVxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhpbnB1dClcbiAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpbnB1dC52YWx1ZSlcbiAgICB9XG5cbiAgICAvLyBDbGVhciB0aGUgZm9ybSBmaWVsZHNcbiAgICBmb3JtLnJlc2V0KClcblxuICAgIC8vIE9ubHkgcnVuIGNhbGN1bGF0aW9ucyBpZiB2YWxpZCBpbnB1dHMgYXJlIGVudGVyZWRcbiAgICBpZiAoaW5wdXQuZGVzYyAhPT0gJycgJiYgIWlzTmFOKGlucHV0LnZhbHVlKSAmJiBpbnB1dC52YWx1ZSA+IDApIHtcbiAgICAgIC8vIEFkZCB0aGUgaXRlbSB0byB0aGUgYnVkZ2V0XG4gICAgICBjb25zdCBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKFxuICAgICAgICBpbnB1dC50eXBlLFxuICAgICAgICBpbnB1dC5kZXNjcmlwdGlvbixcbiAgICAgICAgaW5wdXQudmFsdWVcbiAgICAgIClcblxuICAgICAgLy8gQ2FsY3VsYWUgdGhlIGJ1ZGdldCBhbmQgdXBkYXRlIHRoZSBVSVxuICAgICAgVUlDdHJsLnJlbmRlcihuZXdJdGVtLCBpbnB1dC50eXBlKSAvLyBBZGQgaXRlbXMgdG8gaW5jb21lIG9yIGV4cGVuc2VzIGxpc3RcbiAgICAgIFVJQ3RybC51cGRhdGVCdWRnZXQoKSAvLyBPdXRwdXQgdGhlIG5ldyBidWRnZXRcbiAgICAgIFVJQ3RybC51cGRhdGVQZXJjZW50YWdlcygpIC8vIE91dHB1dCB0aGUgbmV3IHBlcmNlbnRhZ2VzXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmb3JtIHN1Ym1pdHRlZCEnKVxuICAgICAgICBjb25zb2xlLmxvZyhuZXdJdGVtKVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgLy8gRGVsZXRlIGFuIGFkZGVkIGluY29tZSBvciBleHBlbnNlXG4gIFVJQ3RybC5kZWxldGVJdGVtKClcbn0pKGJ1ZGdldENvbnRyb2xsZXIpXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyb3dzZXI7IiwiY29uc3QgYnVkZ2V0Q29udHJvbGxlciA9ICgoKSA9PiB7XG4gIGNsYXNzIEJ1ZGdldCB7XG4gICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgICAgdGhpcy5pZCA9IGlkXG4gICAgICB0aGlzLmRlc2MgPSBkZXNjcmlwdGlvblxuICAgICAgdGhpcy52YWwgPSB2YWx1ZVxuICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICB9XG5cbiAgICBjYWxjUGVyY2VudGFnZSh0b3RhbEluY29tZSkge1xuICAgICAgaWYgKHRvdGFsSW5jb21lID4gMCkge1xuICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh0aGlzLnZhbCAvIHRvdGFsSW5jb21lKSAqIDEwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IC0xXG4gICAgICB9XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBgdGhpcyB2YWx1ZSBpcyAke3R5cGVvZiB0aGlzLnZhbH1gLFxuICAgICAgICAgIGB0aGUgdG90YWxJbmNvbWUgJHt0eXBlb2YgdG90YWxJbmNvbWV9YFxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2V0UGVyY2VudGFnZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBlcmNlbnRhZ2VcbiAgICB9XG4gIH1cblxuICBjb25zdCBkYXRhID0ge1xuICAgIGFsbEl0ZW1zOiB7XG4gICAgICBleHA6IFtdLFxuICAgICAgaW5jOiBbXSxcbiAgICAgIHNhdjogW10sXG4gICAgfSxcbiAgICB0b3RhbHM6IHtcbiAgICAgIGV4cDogMCxcbiAgICAgIGluYzogMCxcbiAgICAgIHNhdjogMCxcbiAgICB9LFxuICAgIHBlcmNlbnQ6IHtcbiAgICAgIGV4cDogLTEsXG4gICAgICBzYXY6IC0xLFxuICAgIH0sXG4gICAgYnVkZ2V0OiAwLFxuICB9XG5cbiAgY29uc3QgY2FsY3VsYXRlVG90YWxzID0gKHR5cGUpID0+IHtcbiAgICBsZXQgc3VtID0gMFxuICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICBzdW0gKz0gY3VyLnZhbFxuICAgIH0pXG4gICAgZGF0YS50b3RhbHNbdHlwZV0gPSBzdW1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkSXRlbTogKHR5cGUsIGRlc2MsIHZhbCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIG5ldyBJRFxuICAgICAgY29uc3QgSUQgPVxuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IGRhdGEuYWxsSXRlbXNbdHlwZV1bZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggLSAxXS5pZCArIDFcbiAgICAgICAgICA6IDBcblxuICAgICAgLy8gU2V0IG5ldyBpdGVtIHRvIHVzZSBvYmplY3RcbiAgICAgIGNvbnN0IG5ld0l0ZW0gPSBuZXcgQnVkZ2V0KElELCBkZXNjLCB2YWwpXG5cbiAgICAgIC8vIFB1c2ggaXQgaW50byBkYXRhIHN0cnVjdHVyZVxuICAgICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5wdXNoKG5ld0l0ZW0pXG5cbiAgICAgIC8vIGNyZWF0ZSBuZXcgaXRlbVxuICAgICAgcmV0dXJuIG5ld0l0ZW1cbiAgICB9LFxuICAgIGNhbGN1bGF0ZUJ1ZGdldDogKCkgPT4ge1xuICAgICAgLy8gMS4gQ2FsY3VsYXRlIHRoZSBidWRnZXRcbiAgICAgIGNhbGN1bGF0ZVRvdGFscygnZXhwJylcbiAgICAgIGNhbGN1bGF0ZVRvdGFscygnaW5jJylcbiAgICAgIGNhbGN1bGF0ZVRvdGFscygnc2F2JylcblxuICAgICAgLy8gMi4gQ2FsY3VsYXRlIHRoZSBidWRnZXQ6IGluY29tZSAtIGV4cGVuc2VzXG4gICAgICBkYXRhLmJ1ZGdldCA9IGRhdGEudG90YWxzLmluYyAtIChkYXRhLnRvdGFscy5leHAgKyBkYXRhLnRvdGFscy5zYXYpXG5cbiAgICAgIC8vIDMuIENhbGN1bGF0ZSB0aGUgcGVyY2VudGFnZSBvZiBpbmNvbWUgdGhhdCB3ZSBzcGVudFxuICAgICAgaWYgKGRhdGEudG90YWxzLmluYyA+IDApIHtcbiAgICAgICAgZGF0YS5wZXJjZW50LmV4cCA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLmV4cCAvIGRhdGEudG90YWxzLmluYykgKiAxMDApXG4gICAgICAgIGRhdGEucGVyY2VudC5zYXYgPSBNYXRoLnJvdW5kKChkYXRhLnRvdGFscy5zYXYgLyBkYXRhLnRvdGFscy5pbmMpICogMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YS5wZXJjZW50LmV4cCA9IC0xXG4gICAgICAgIGRhdGEucGVyY2VudC5zYXYgPSAtMVxuICAgICAgfVxuXG4gICAgICAvLyAzLiBSZXR1cm4gdGhlIGJ1ZGdldFxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS50b3RhbHMuZXhwLCBkYXRhLnRvdGFscy5pbmMpXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEuYnVkZ2V0LCBkYXRhLnBlcmNlbnQuZXhwLCBkYXRhLnBlcmNlbnQuc2F2KVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0sXG4gICAgY2FsY3VsYXRlUGVyY2VudGFnZXM6ICh0eXBlKSA9PiB7XG4gICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmZvckVhY2goKGN1cikgPT4ge1xuICAgICAgICBjdXIuY2FsY1BlcmNlbnRhZ2UoZGF0YS50b3RhbHMuaW5jKVxuICAgICAgfSlcbiAgICB9LFxuICAgIGdldFBlcmNlbnRhZ2VzOiAodHlwZSkgPT4ge1xuICAgICAgY29uc3QgYWxsUGVyYyA9IGRhdGEuYWxsSXRlbXNbdHlwZV0ubWFwKChjdXIpID0+IHtcbiAgICAgICAgcmV0dXJuIGN1ci5nZXRQZXJjZW50YWdlKClcbiAgICAgIH0pXG4gICAgICByZXR1cm4gYWxsUGVyY1xuICAgIH0sXG4gICAgcmVtb3ZlSXRlbTogKHR5cGUsIGlkKSA9PiB7XG4gICAgICBjb25zdCBpZHMgPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcCgoY3VycmVudCkgPT4ge1xuICAgICAgICByZXR1cm4gY3VycmVudC5pZFxuICAgICAgfSlcbiAgICAgIGNvbnN0IGluZGV4ID0gaWRzLmluZGV4T2YoaWQpXG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICB9XG4gICAgfSxcbiAgICBnZXREYXRhOiAoKSA9PiB7XG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0sXG4gIH1cbn0pKClcblxuZXhwb3J0IGRlZmF1bHQgYnVkZ2V0Q29udHJvbGxlclxuIl0sInNvdXJjZVJvb3QiOiIifQ==