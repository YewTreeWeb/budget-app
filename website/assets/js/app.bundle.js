(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,o=function(){},a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],c=a.length,s=window.console=window.console||{};c--;)s[n=a[c]]||(s[n]=o);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var i=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?i.classList.add("is-mobile"):(t.on(">medium",(function(){i.classList.remove("is-mobile"),i.classList.add("is-desktop")})),t.on("<=medium",(function(){i.classList.remove("is-desktop"),i.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var o=n("lwsE"),a=n.n(o),c=n("W8MJ"),s=n.n(c),i=n("xVb/"),l=function(){function e(t,n,o){a()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=o}return s()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"formatNumber",value:function(e,t){var n=Math.abs(e);(n=n.toFixed(2)).split(".")}},{key:"render",value:function(e,t){var n,o="exp"===t?"expenses":"income",a=document.querySelector(".".concat(o,"__list"));n="\n    <li class='".concat(o,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p><span>&pound;</span>").concat(e.val,"</p></div>\n    "),"exp"===t&&(n+='<div class="item-percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',a.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,percent:e.percent}}},{key:"displayBudget",value:function(e){var t="exp"===(e.budget>0?"inc":"exp")?"expenses":"income",n=document.querySelector(".budget__value .budget"),o=document.querySelector(".budget__income .budget__amount .amount"),a=document.querySelector(".budget__expenses .budget__amount .amount");n.textContent=e.budget,o.textContent=e.totalInc,a.textContent=e.totalExp,console.log("The ".concat(t," is/are ").concat(e.budget)),console.log(o,a)}},{key:"displayPercentage",value:function(e){var t=document.querySelector(".budget__percentage");e>0?(t.classList.add("show"),t.innerHTML="".concat(e,"&#37;")):t.classList.remove("show"),console.log(t)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percent)}},{key:"displayPercentages",value:function(e){!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".item-percent"),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){i.default.calculatePercentages();var e=i.default.getPercentages();this.displayPercentages(e)}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,o=n.id.split("-"),a=o[0],c=Number(o[1]);console.log(t.target,n,o,a,c),i.default.removeItem(a,c),n.remove(),e.updateBudget(),e.updatePercentages()}}))}}]),e}();t.default=l},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var o=n("cDf5"),a=n.n(o),c=(n("OuUZ"),n("E4hX"),n("xVb/")),s=n("SEKM"),i=document.querySelector("body");window.onload=function(){window.setTimeout((function(){i.classList.remove("is-loading")}),100)};var l,u,r,d,p,m,g;l=c.default,u=document.querySelector(".add__form"),r=document.querySelector(".add__type"),d=document.querySelector(".add__description"),p=document.querySelector(".add__value"),m=document.querySelector("#check"),g=new s.default(r,d,p),r.addEventListener("change",(function(e){console.log(e);var t=Array.from(r.options);console.log(t),"exp"===r.value?m.classList.add(r.value):m.classList.remove("exp")})),u.addEventListener("submit",(function(e){e.preventDefault();var t=g.getInput();if(console.log(t),console.log(a()(t.value)),u.reset(),""!==t.desc&&!isNaN(t.value)&&t.value>0){var n=l.addItem(t.type,t.description,t.value);g.render(n,t.type),g.updateBudget(),g.updatePercentages(),console.log("form submitted!"),console.log(n)}})),g.deleteItem()},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var o,a,c,s=n("cDf5"),i=n.n(s),l=n("lwsE"),u=n.n(l),r=n("W8MJ"),d=n.n(r),p=(o=function(){function e(t,n,o){u()(this,e),this.id=t,this.desc=n,this.val=o,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(i()(this.val)),"the totalIncome ".concat(i()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),a={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0},c=function(e){var t=0;a.allItems[e].forEach((function(e){t+=e.val})),a.totals[e]=t},{addItem:function(e,t,n){var c=a.allItems[e].length>0?a.allItems[e][a.allItems[e].length-1].id+1:0,s=new o(c,t,n);return a.allItems[e].push(s),s},calculateBudget:function(){return c("exp"),c("inc"),a.budget=a.totals.inc-a.totals.exp,a.totals.inc>0?a.percent=Math.round(a.totals.exp/a.totals.inc*100):a.percent=-1,console.log(a.totals.exp,a.totals.inc),console.log(a.budget,a.percent),a},calculatePercentages:function(){a.allItems.exp.forEach((function(e){e.calcPercentage(a.totals.inc)}))},getPercentages:function(){return a.allItems.exp.map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=a.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&a.allItems[e].splice(n,1)}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy91aWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJlYWtwb2ludHNcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9hcHAuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJvd3NlclwiIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvYnVkZ2V0Y29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJtZXRob2QiLCJub29wIiwibWV0aG9kcyIsImxlbmd0aCIsImNvbnNvbGUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRmlyc3RUYWIiLCJlIiwia2V5Q29kZSIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiYnJvd3NlciIsIm5hbWUiLCJicmVha3BvaW50cyIsInhsYXJnZSIsImxhcmdlIiwibWVkaXVtIiwic21hbGwiLCJ4c21hbGwiLCJtb2JpbGUiLCJvbiIsInJlbW92ZSIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJsb2ciLCJVSUNvbnRyb2xsZXIiLCJjb3N0IiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsInRoaXMiLCJpbnB1dFR5cGUiLCJpbnB1dERlc2MiLCJpbnB1dFZhbCIsInR5cGUiLCJOdW1iZXIiLCJudW1iZXIiLCJudW0iLCJNYXRoIiwiYWJzIiwidG9GaXhlZCIsInNwbGl0Iiwib2JqIiwiaHRtbCIsIml0ZW0iLCJsaXN0IiwiaWQiLCJkZXNjIiwidmFsIiwiaW5uZXJIVE1MIiwiZGF0YSIsImJ1ZGdldCIsInRvdGFsSW5jIiwidG90YWxzIiwiaW5jIiwidG90YWxFeHAiLCJleHAiLCJwZXJjZW50IiwidHlwZXMiLCJ0ZXh0Q29udGVudCIsInBlcmNlbnRhZ2UiLCJnZXREYXRhIiwiYnVkZ2V0Q29udHJvbGxlciIsImNhbGN1bGF0ZUJ1ZGdldCIsIm5ld0J1ZGdldCIsImdldEJ1ZGdldCIsImRpc3BsYXlCdWRnZXQiLCJkaXNwbGF5UGVyY2VudGFnZSIsInBlcmNlbnRhZ2VzIiwiY2IiLCJpIiwibm9kZUxpc3RGb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnQiLCJpbmRleCIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwiZ2V0UGVyY2VudGFnZXMiLCJkaXNwbGF5UGVyY2VudGFnZXMiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicGFyZW50RWxlbWVudCIsInNwbGl0SUQiLCJJRCIsInJlbW92ZUl0ZW0iLCJ1cGRhdGVCdWRnZXQiLCJ1cGRhdGVQZXJjZW50YWdlcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJvbmxvYWQiLCJzZXRUaW1lb3V0IiwiYnVkZ2V0Q3RybCIsImZvcm0iLCJjaGVjayIsIlVJQ3RybCIsIm9wdGlvbnMiLCJBcnJheSIsImZyb20iLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0IiwiZ2V0SW5wdXQiLCJyZXNldCIsImlzTmFOIiwibmV3SXRlbSIsImFkZEl0ZW0iLCJyZW5kZXIiLCJkZWxldGVJdGVtIiwiQnVkZ2V0IiwiY2FsY3VsYXRlVG90YWxzIiwidG90YWxJbmNvbWUiLCJyb3VuZCIsImFsbEl0ZW1zIiwic3VtIiwiZm9yRWFjaCIsImN1ciIsInB1c2giLCJjYWxjUGVyY2VudGFnZSIsIm1hcCIsImdldFBlcmNlbnRhZ2UiLCJpbmRleE9mIiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiNElBQUEsY0FxQ0UsSUEvQkEsSUFBSUEsRUFDRUMsRUFBTyxhQUNQQyxFQUFVLENBQ2QsU0FDQSxRQUNBLFFBQ0EsUUFDQSxNQUNBLFNBQ0EsUUFDQSxZQUNBLFFBQ0EsaUJBQ0EsV0FDQSxPQUNBLE1BQ0EsZUFDQSxVQUNBLGFBQ0EsUUFDQSxPQUNBLFVBQ0EsV0FDQSxjQUNBLFlBQ0EsUUFDQSxR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QUFLRyxPQUFPRyxJQUFLTixFQUFLRyxPQUFPQyxLQUN6Q3ZELFFBQVEwQixJQUFJeUIsRUFBS0MsT0FBUUQsRUFBS08sU0FHekJQLEdBRVR5QixxQkFBc0IsV0FDcEJ6QixFQUFLNEQsU0FBU3RELElBQUl3RCxTQUFRLFNBQUNDLEdBQ3pCQSxFQUFJRSxlQUFlakUsRUFBS0csT0FBT0MsU0FHbkNzQixlQUFnQixXQUlkLE9BSGdCMUIsRUFBSzRELFNBQVN0RCxJQUFJNEQsS0FBSSxTQUFDSCxHQUNyQyxPQUFPQSxFQUFJSSxvQkFJZmxDLFdBQVksU0FBQ2pELEVBQU1ZLEdBQ2pCLElBR000QixFQUhNeEIsRUFBSzRELFNBQVM1RSxHQUFNa0YsS0FBSSxTQUFDM0MsR0FDbkMsT0FBT0EsRUFBUTNCLE1BRUN3RSxRQUFReEUsSUFFWCxJQUFYNEIsR0FDRnhCLEVBQUs0RCxTQUFTNUUsR0FBTXFGLE9BQU83QyxFQUFPLE1BTTNCWixjIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcGx1c3BsdXMgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuXG4vLyBBdm9pZCBgY29uc29sZWAgZXJyb3JzIGluIGJyb3dzZXJzIHRoYXQgbGFjayBhIGNvbnNvbGUuXG57XG4gIGxldCBtZXRob2RcbiAgY29uc3Qgbm9vcCA9ICgpID0+IHt9XG4gIGNvbnN0IG1ldGhvZHMgPSBbXG4gICAgJ2Fzc2VydCcsXG4gICAgJ2NsZWFyJyxcbiAgICAnY291bnQnLFxuICAgICdkZWJ1ZycsXG4gICAgJ2RpcicsXG4gICAgJ2RpcnhtbCcsXG4gICAgJ2Vycm9yJyxcbiAgICAnZXhjZXB0aW9uJyxcbiAgICAnZ3JvdXAnLFxuICAgICdncm91cENvbGxhcHNlZCcsXG4gICAgJ2dyb3VwRW5kJyxcbiAgICAnaW5mbycsXG4gICAgJ2xvZycsXG4gICAgJ21hcmtUaW1lbGluZScsXG4gICAgJ3Byb2ZpbGUnLFxuICAgICdwcm9maWxlRW5kJyxcbiAgICAndGFibGUnLFxuICAgICd0aW1lJyxcbiAgICAndGltZUVuZCcsXG4gICAgJ3RpbWVsaW5lJyxcbiAgICAndGltZWxpbmVFbmQnLFxuICAgICd0aW1lU3RhbXAnLFxuICAgICd0cmFjZScsXG4gICAgJ3dhcm4nLFxuICBdXG4gIGxldCB7IGxlbmd0aCB9ID0gbWV0aG9kc1xuICBjb25zdCBjb25zb2xlID0gKHdpbmRvdy5jb25zb2xlID0gd2luZG93LmNvbnNvbGUgfHwge30pXG5cbiAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgbWV0aG9kID0gbWV0aG9kc1tsZW5ndGhdXG5cbiAgICAvLyBPbmx5IHN0dWIgdW5kZWZpbmVkIG1ldGhvZHMuXG4gICAgaWYgKCFjb25zb2xlW21ldGhvZF0pIHtcbiAgICAgIGNvbnNvbGVbbWV0aG9kXSA9IG5vb3BcbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHRhYmJpbmcgaW5kaWNhdG9yIHRvIHdpbmRvd1xuY29uc3QgaGFuZGxlRmlyc3RUYWIgPSAoZSkgPT4ge1xuICBpZiAoZS5rZXlDb2RlID09PSA5KSB7XG4gICAgLy8gdGhlIFwiSSBhbSBhIGtleWJvYXJkIHVzZXJcIiBrZXlcbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3VzZXItaXMtdGFiYmluZycpXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVGaXJzdFRhYilcbiAgfVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUZpcnN0VGFiKVxuXG4vLyBBZGQgYSBicm93ZXIgaW5kaWNhdG9yIHRvIHRoZSBIVE1MIGVsZW1lbnQuXG5jb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpXG5odG1sLnNldEF0dHJpYnV0ZSgnZGF0YS1icm93c2VyJywgYnJvd3Nlci5uYW1lKVxuXG4vLyBEZXRlY3QgaWYgbW9iaWxlIG9yIGRlc2t0b3AuXG5jb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpXG5cbmJyZWFrcG9pbnRzKHtcbiAgeGxhcmdlOiBbJzEyODFweCcsICcxNjgwcHgnXSxcbiAgbGFyZ2U6IFsnOTgxcHgnLCAnMTI4MHB4J10sXG4gIG1lZGl1bTogWyc3MzdweCcsICc5ODBweCddLFxuICBzbWFsbDogWyc0ODFweCcsICc3MzZweCddLFxuICB4c21hbGw6IFtudWxsLCAnNDgwcHgnXSxcbn0pXG5cbmlmIChicm93c2VyLm1vYmlsZSkge1xuICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpXG59IGVsc2Uge1xuICBicmVha3BvaW50cy5vbignPm1lZGl1bScsICgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW1vYmlsZScpXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1kZXNrdG9wJylcbiAgfSlcbiAgYnJlYWtwb2ludHMub24oJzw9bWVkaXVtJywgKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZGVza3RvcCcpXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1tb2JpbGUnKVxuICB9KVxufVxuXG4vLyBMb2cgaWYgcnVubmluZyBpbiBsb2NhbGhvc3Qgd2hlbiBpbiBkZXZlbG9wbWVudCBtb2RlLlxuaWYgKFxuICB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnICYmXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbidcbikge1xuICBjb25zb2xlLmxvZygnbG9jYWxob3N0IGRldGVjdGVkIScpXG59XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzICovXG5cbmltcG9ydCBidWRnZXRDb250cm9sbGVyIGZyb20gJy4vYnVkZ2V0Y29udHJvbGxlcidcblxuLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLWRlc3RydWN0dXJpbmcgKi9cbmNsYXNzIFVJQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKGNvc3QsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgIHRoaXMuaW5wdXRUeXBlID0gY29zdFxuICAgIHRoaXMuaW5wdXREZXNjID0gZGVzY3JpcHRpb25cbiAgICB0aGlzLmlucHV0VmFsID0gdmFsdWVcbiAgfVxuXG4gIGdldElucHV0KCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiB0aGlzLmlucHV0VHlwZS52YWx1ZSwgLy8gV2lsbCBiZSBlaXRoZXIgaW5jIG9yIGV4cFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuaW5wdXREZXNjLnZhbHVlLFxuICAgICAgdmFsdWU6IE51bWJlcih0aGlzLmlucHV0VmFsLnZhbHVlKSxcbiAgICB9XG4gIH1cblxuICBmb3JtYXROdW1iZXIobnVtYmVyLCB0eXBlKSB7XG4gICAgLyoqXG4gICAgICogKyBvciAtIGJlZm9yZSB0aGUgbnVtYmVyXG4gICAgICogZXhhY3RseSAyIGRlY2ltYWwgcG9pbnRzXG4gICAgICogY29tbWEgc2VwZXJhdGluZyB0aGUgdGhvdXNhbmRzXG4gICAgICpcbiAgICAgKiAyMzEwLjQ1NjcgPSArIDIsMzEwLjQ2XG4gICAgICovXG4gICAgbGV0IG51bSA9IE1hdGguYWJzKG51bWJlcilcbiAgICBudW0gPSBudW0udG9GaXhlZCgyKVxuXG4gICAgY29uc3QgbnVtU3BsaXQgPSBudW0uc3BsaXQoJy4nKVxuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNsYXNzLW1ldGhvZHMtdXNlLXRoaXNcbiAgcmVuZGVyKG9iaiwgdHlwZSkge1xuICAgIGNvbnN0IGl0ZW0gPSB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiAnaW5jb21lJ1xuICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpdGVtfV9fbGlzdGApXG4gICAgbGV0IGh0bWxcblxuICAgIC8vIENyZWF0ZSBIVE1MIHN0cmluZyB3aXRoIHBsYWNlaG9sZGVyXG4gICAgaHRtbCA9IGBcbiAgICA8bGkgY2xhc3M9JyR7aXRlbX1fX2l0ZW0nIGlkPScke3R5cGV9LSR7b2JqLmlkfSc+XG4gICAgICA8ZGl2IGNsYXNzPSdpdGVtLWRlc2MnPjxwPiR7b2JqLmRlc2N9PC9wPjwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cIml0ZW1zXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9J2l0ZW1zX192YWx1ZSc+PHA+PHNwYW4+JnBvdW5kOzwvc3Bhbj4ke29iai52YWx9PC9wPjwvZGl2PlxuICAgIGBcblxuICAgIGlmICh0eXBlID09PSAnZXhwJykge1xuICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIml0ZW0tcGVyY2VudFwiPjxwPjAmIzM3OzwvcD48L2Rpdj4nXG4gICAgfVxuXG4gICAgaHRtbCArPSBgXG4gICAgICAgIDxidXR0b24gY2xhc3M9J2J0biBidG4tLWNsZWFyIGl0ZW1zX19kZWwnPlxuICAgICAgICAgIDxzdmcgaWQ9XCJkZWxldGVcIiBjbGFzcz1cImljb25cIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj1cIi9hc3NldHMvaW1hZ2VzL2ljb25zLnN2ZyNpY29uLWRlbGV0ZVwiPjwvdXNlPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvbGk+XG4gICAgYFxuXG4gICAgLy8gSW5zZXJ0IEhUTUwgaW50byB0aGUgRE9NXG4gICAgbGlzdC5pbm5lckhUTUwgKz0gaHRtbFxuICB9XG5cbiAgZ2V0QnVkZ2V0KGRhdGEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgIHRvdGFsSW5jOiBkYXRhLnRvdGFscy5pbmMsXG4gICAgICB0b3RhbEV4cDogZGF0YS50b3RhbHMuZXhwLFxuICAgICAgcGVyY2VudDogZGF0YS5wZXJjZW50LFxuICAgIH1cbiAgfVxuXG4gIGRpc3BsYXlCdWRnZXQob2JqKSB7XG4gICAgY29uc3QgdHlwZSA9IG9iai5idWRnZXQgPiAwID8gJ2luYycgOiAnZXhwJ1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ2luY29tZSdcbiAgICBjb25zdCBidWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVkZ2V0X192YWx1ZSAuYnVkZ2V0JylcbiAgICBjb25zdCBpbmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC5idWRnZXRfX2luY29tZSAuYnVkZ2V0X19hbW91bnQgLmFtb3VudGBcbiAgICApXG4gICAgY29uc3QgZXhwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuYnVkZ2V0X19leHBlbnNlcyAuYnVkZ2V0X19hbW91bnQgLmFtb3VudGBcbiAgICApXG5cbiAgICBidWRnZXQudGV4dENvbnRlbnQgPSBvYmouYnVkZ2V0XG4gICAgaW5jLnRleHRDb250ZW50ID0gb2JqLnRvdGFsSW5jXG4gICAgZXhwLnRleHRDb250ZW50ID0gb2JqLnRvdGFsRXhwXG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coYFRoZSAke3R5cGVzfSBpcy9hcmUgJHtvYmouYnVkZ2V0fWApXG4gICAgICBjb25zb2xlLmxvZyhpbmMsIGV4cClcbiAgICB9XG4gIH1cblxuICBkaXNwbGF5UGVyY2VudGFnZShwZXJjZW50YWdlKSB7XG4gICAgY29uc3QgcGVyY2VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idWRnZXRfX3BlcmNlbnRhZ2UnKVxuXG4gICAgaWYgKHBlcmNlbnRhZ2UgPiAwKSB7XG4gICAgICBwZXJjZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgICAgcGVyY2VudC5pbm5lckhUTUwgPSBgJHtwZXJjZW50YWdlfSYjMzc7YFxuICAgIH0gZWxzZSB7XG4gICAgICBwZXJjZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhwZXJjZW50KVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUJ1ZGdldCgpIHtcbiAgICAvLyAxLiBDaGVjayBsb2NhbFN0b3JhZ2UgZm9yIHNhdmUgYnVkZ2V0IGRhdGEsIGVsc2UgZ2V0IG5ldyBkYXRhXG4gICAgY29uc3QgZ2V0RGF0YSA9IGJ1ZGdldENvbnRyb2xsZXIuY2FsY3VsYXRlQnVkZ2V0KClcblxuICAgIC8vIDIuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgY29uc3QgbmV3QnVkZ2V0ID0gdGhpcy5nZXRCdWRnZXQoZ2V0RGF0YSlcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhuZXdCdWRnZXQpXG4gICAgfVxuXG4gICAgLy8gMy4gRGlzcGxheSB0aGUgdXBkYXRlZCBidWRnZXRcbiAgICB0aGlzLmRpc3BsYXlCdWRnZXQobmV3QnVkZ2V0KVxuXG4gICAgLy8gNC4gRGlzcGxheSB0aGUgbmV3IG92ZXJhbGwgYnVkZ2V0IHBlcmNlbnRhZ2VcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlKG5ld0J1ZGdldC5wZXJjZW50KVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2VzKHBlcmNlbnRhZ2VzKSB7XG4gICAgY29uc3QgZmllbGRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0tcGVyY2VudCcpXG4gICAgY29uc3Qgbm9kZUxpc3RGb3JFYWNoID0gKGxpc3QsIGNiKSA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSwgaSlcbiAgICAgIH1cbiAgICB9XG4gICAgbm9kZUxpc3RGb3JFYWNoKGZpZWxkcywgKGN1cnJlbnQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocGVyY2VudGFnZXNbaW5kZXhdID4gMCkge1xuICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2VzW2luZGV4XX0mIzM3O2BcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgICAgIGN1cnJlbnQuaW5uZXJIVE1MID0gJzAmIzM3OydcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgdXBkYXRlUGVyY2VudGFnZXMoKSB7XG4gICAgLy8gMS4gQ2FsdWxhdGUgcGVyY2VudGFnZXNcbiAgICBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKClcblxuICAgIC8vIDIuIFJlYWQgcGVyY2VudGFnZXMgZnJvbSBidWRnZXQgY29udHJvbGxlclxuICAgIGNvbnN0IHBlcmNlbnRhZ2VzID0gYnVkZ2V0Q29udHJvbGxlci5nZXRQZXJjZW50YWdlcygpXG5cbiAgICAvLyAzLiBVcGRhdGUgVUkgdG8gc2hvdyBuZXcgcGVyY2VudGFnZXNcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlcyhwZXJjZW50YWdlcylcbiAgfVxuXG4gIGRlbGV0ZUl0ZW0oKSB7XG4gICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmNvbWUtZXhwZW5zZXMnKVxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmlkID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KCcuaXRlbXMnKS5wYXJlbnRFbGVtZW50XG4gICAgICAgIGNvbnN0IHNwbGl0SUQgPSB0YXJnZXQuaWQuc3BsaXQoJy0nKVxuICAgICAgICBjb25zdCB0eXBlID0gc3BsaXRJRFswXVxuICAgICAgICBjb25zdCBJRCA9IE51bWJlcihzcGxpdElEWzFdKVxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQsIHRhcmdldCwgc3BsaXRJRCwgdHlwZSwgSUQpXG4gICAgICAgIH1cblxuICAgICAgICAvLyAxLiBEZWxldGUgdGhlIGl0ZW0gZnJvbSB0aGUgZGF0YSBzdHJ1Y3R1cmVcbiAgICAgICAgYnVkZ2V0Q29udHJvbGxlci5yZW1vdmVJdGVtKHR5cGUsIElEKVxuXG4gICAgICAgIC8vIDIuIERlbGV0ZSB0aGUgaXRlbSBmcm9tIHRoZSBVSVxuICAgICAgICB0YXJnZXQucmVtb3ZlKClcblxuICAgICAgICAvLyAzLiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBidWRnZXRcbiAgICAgICAgdGhpcy51cGRhdGVCdWRnZXQoKVxuXG4gICAgICAgIC8vIDQuIFVwZGF0ZSBhbmQgc2hvdyB0aGUgbmV3IHBlcmNlbnRhZ2VzXG4gICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZXMoKVxuICAgICAgfVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVUlDb250cm9sbGVyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyZWFrcG9pbnRzOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblxuLy8gRXh0ZXJuYWxcbmltcG9ydCAnYWlyYm5iLWJyb3dzZXItc2hpbXMnXG5cbi8vIEludGVybmFsXG5pbXBvcnQgJy4vbW9kdWxlcy9oZWxwZXJzJ1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXInXG5pbXBvcnQgVUlDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy91aWNvbnRyb2xsZXInXG5cbi8vIFJlbW92ZSBsb2FkaW5nIGNsYXNzIGZyb20gYm9keSBvbiB3aW5kb3cgbG9hZC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jylcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbG9hZGluZycpXG4gIH0sIDEwMClcbn1cblxuLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRyb2xsZXIgZm9yIHRoZSBhcHBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuY29uc3QgY29udHJvbGxlciA9ICgoYnVkZ2V0Q3RybCkgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZm9ybScpXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX190eXBlJylcbiAgY29uc3QgZGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX2Rlc2NyaXB0aW9uJylcbiAgY29uc3QgdmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX192YWx1ZScpXG4gIGNvbnN0IGNoZWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NoZWNrJylcblxuICBjb25zdCBVSUN0cmwgPSBuZXcgVUlDb250cm9sbGVyKHR5cGUsIGRlc2MsIHZhbHVlKVxuXG4gIC8vIFRvZ2dsZSB0aGUgc3VibWl0IG5ldyBjb3N0IGZyb20gZWl0aGVyIGluY29tZSBvciBleHBlbnNlLlxuICB0eXBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgY29uc29sZS5sb2coZSlcbiAgICBjb25zdCBvcHRpb25zID0gQXJyYXkuZnJvbSh0eXBlLm9wdGlvbnMpXG4gICAgY29uc29sZS5sb2cob3B0aW9ucylcbiAgICBpZiAodHlwZS52YWx1ZSA9PT0gJ2V4cCcpIHtcbiAgICAgIGNoZWNrLmNsYXNzTGlzdC5hZGQodHlwZS52YWx1ZSlcbiAgICAgIC8vIHR5cGUub3B0aW9uc1swXS5yZW1vdmVBdHRyaWJ1dGUoJ3NlbGVjdGVkJylcbiAgICAgIC8vIHR5cGUub3B0aW9ucy5zZWxlY3RlZEluZGV4LnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBvcHRpb25zWzFdLnJlbW92ZUF0dHJpYnV0ZSgnc2VsZWN0ZWQnKVxuICAgICAgLy8gb3B0aW9uc1swXS5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJylcbiAgICAgIGNoZWNrLmNsYXNzTGlzdC5yZW1vdmUoJ2V4cCcpXG4gICAgfVxuICB9KVxuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIC8vIEdldCBmaWxlZCBpbnB1dCBkYXRhXG4gICAgY29uc3QgaW5wdXQgPSBVSUN0cmwuZ2V0SW5wdXQoKVxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhpbnB1dClcbiAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpbnB1dC52YWx1ZSlcbiAgICB9XG5cbiAgICAvLyBDbGVhciB0aGUgZm9ybSBmaWVsZHNcbiAgICBmb3JtLnJlc2V0KClcblxuICAgIC8vIE9ubHkgcnVuIGNhbGN1bGF0aW9ucyBpZiB2YWxpZCBpbnB1dHMgYXJlIGVudGVyZWRcbiAgICBpZiAoaW5wdXQuZGVzYyAhPT0gJycgJiYgIWlzTmFOKGlucHV0LnZhbHVlKSAmJiBpbnB1dC52YWx1ZSA+IDApIHtcbiAgICAgIC8vIEFkZCB0aGUgaXRlbSB0byB0aGUgYnVkZ2V0XG4gICAgICBjb25zdCBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKFxuICAgICAgICBpbnB1dC50eXBlLFxuICAgICAgICBpbnB1dC5kZXNjcmlwdGlvbixcbiAgICAgICAgaW5wdXQudmFsdWVcbiAgICAgIClcblxuICAgICAgLy8gQ2FsY3VsYWUgdGhlIGJ1ZGdldCBhbmQgdXBkYXRlIHRoZSBVSVxuICAgICAgVUlDdHJsLnJlbmRlcihuZXdJdGVtLCBpbnB1dC50eXBlKSAvLyBBZGQgaXRlbXMgdG8gaW5jb21lIG9yIGV4cGVuc2VzIGxpc3RcbiAgICAgIFVJQ3RybC51cGRhdGVCdWRnZXQoKSAvLyBPdXRwdXQgdGhlIG5ldyBidWRnZXRcbiAgICAgIFVJQ3RybC51cGRhdGVQZXJjZW50YWdlcygpIC8vIE91dHB1dCB0aGUgbmV3IHBlcmNlbnRhZ2VzXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmb3JtIHN1Ym1pdHRlZCEnKVxuICAgICAgICBjb25zb2xlLmxvZyhuZXdJdGVtKVxuICAgICAgfVxuICAgIH1cbiAgfSlcblxuICAvLyBEZWxldGUgYW4gYWRkZWQgaW5jb21lIG9yIGV4cGVuc2VcbiAgVUlDdHJsLmRlbGV0ZUl0ZW0oKVxufSkoYnVkZ2V0Q29udHJvbGxlcilcbiIsIm1vZHVsZS5leHBvcnRzID0gYnJvd3NlcjsiLCJjb25zdCBidWRnZXRDb250cm9sbGVyID0gKCgpID0+IHtcbiAgY2xhc3MgQnVkZ2V0IHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgICB0aGlzLmlkID0gaWRcbiAgICAgIHRoaXMuZGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgICB0aGlzLnZhbCA9IHZhbHVlXG4gICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAtMVxuICAgIH1cblxuICAgIGNhbGNQZXJjZW50YWdlKHRvdGFsSW5jb21lKSB7XG4gICAgICBpZiAodG90YWxJbmNvbWUgPiAwKSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKHRoaXMudmFsIC8gdG90YWxJbmNvbWUpICogMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGB0aGlzIHZhbHVlIGlzICR7dHlwZW9mIHRoaXMudmFsfWAsXG4gICAgICAgICAgYHRoZSB0b3RhbEluY29tZSAke3R5cGVvZiB0b3RhbEluY29tZX1gXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQZXJjZW50YWdlKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGVyY2VudGFnZVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgYWxsSXRlbXM6IHtcbiAgICAgIGV4cDogW10sXG4gICAgICBpbmM6IFtdLFxuICAgIH0sXG4gICAgdG90YWxzOiB7XG4gICAgICBleHA6IDAsXG4gICAgICBpbmM6IDAsXG4gICAgfSxcbiAgICBidWRnZXQ6IDAsXG4gIH1cblxuICBjb25zdCBjYWxjdWxhdGVUb3RhbHMgPSAodHlwZSkgPT4ge1xuICAgIGxldCBzdW0gPSAwXG4gICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgIHN1bSArPSBjdXIudmFsXG4gICAgfSlcbiAgICBkYXRhLnRvdGFsc1t0eXBlXSA9IHN1bVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRJdGVtOiAodHlwZSwgZGVzYywgdmFsKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbmV3IElEXG4gICAgICBjb25zdCBJRCA9XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMFxuICAgICAgICAgID8gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMVxuICAgICAgICAgIDogMFxuXG4gICAgICAvLyBTZXQgbmV3IGl0ZW0gdG8gdXNlIG9iamVjdFxuICAgICAgY29uc3QgbmV3SXRlbSA9IG5ldyBCdWRnZXQoSUQsIGRlc2MsIHZhbClcblxuICAgICAgLy8gUHVzaCBpdCBpbnRvIGRhdGEgc3RydWN0dXJlXG4gICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSlcblxuICAgICAgLy8gY3JlYXRlIG5ldyBpdGVtXG4gICAgICByZXR1cm4gbmV3SXRlbVxuICAgIH0sXG4gICAgY2FsY3VsYXRlQnVkZ2V0OiAoKSA9PiB7XG4gICAgICAvLyAxLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldFxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdleHAnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdpbmMnKVxuXG4gICAgICAvLyAyLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldDogaW5jb21lIC0gZXhwZW5zZXNcbiAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhbHMuaW5jIC0gZGF0YS50b3RhbHMuZXhwXG5cbiAgICAgIC8vIDMuIENhbGN1bGF0ZSB0aGUgcGVyY2VudGFnZSBvZiBpbmNvbWUgdGhhdCB3ZSBzcGVudFxuICAgICAgaWYgKGRhdGEudG90YWxzLmluYyA+IDApIHtcbiAgICAgICAgZGF0YS5wZXJjZW50ID0gTWF0aC5yb3VuZCgoZGF0YS50b3RhbHMuZXhwIC8gZGF0YS50b3RhbHMuaW5jKSAqIDEwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRhdGEucGVyY2VudCA9IC0xXG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLnRvdGFscy5leHAsIGRhdGEudG90YWxzLmluYylcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS5idWRnZXQsIGRhdGEucGVyY2VudClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9LFxuICAgIGNhbGN1bGF0ZVBlcmNlbnRhZ2VzOiAoKSA9PiB7XG4gICAgICBkYXRhLmFsbEl0ZW1zLmV4cC5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgICAgY3VyLmNhbGNQZXJjZW50YWdlKGRhdGEudG90YWxzLmluYylcbiAgICAgIH0pXG4gICAgfSxcbiAgICBnZXRQZXJjZW50YWdlczogKCkgPT4ge1xuICAgICAgY29uc3QgYWxsUGVyYyA9IGRhdGEuYWxsSXRlbXMuZXhwLm1hcCgoY3VyKSA9PiB7XG4gICAgICAgIHJldHVybiBjdXIuZ2V0UGVyY2VudGFnZSgpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIGFsbFBlcmNcbiAgICB9LFxuICAgIHJlbW92ZUl0ZW06ICh0eXBlLCBpZCkgPT4ge1xuICAgICAgY29uc3QgaWRzID0gZGF0YS5hbGxJdGVtc1t0eXBlXS5tYXAoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuaWRcbiAgICAgIH0pXG4gICAgICBjb25zdCBpbmRleCA9IGlkcy5pbmRleE9mKGlkKVxuXG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKVxuICAgICAgfVxuICAgIH0sXG4gIH1cbn0pKClcblxuZXhwb3J0IGRlZmF1bHQgYnVkZ2V0Q29udHJvbGxlclxuIl0sInNvdXJjZVJvb3QiOiIifQ==