(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{"+4zn":function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),s=n.n(a),o=n("yXPU"),c=n.n(o),r=n("lwsE"),i=n.n(r),l=n("W8MJ"),u=n.n(l),d=n("E4hX"),p=function(){function e(){i()(this,e),this.budgets=db.collection("budgets")}var t,n;return u()(e,[{key:"saveBudget",value:(n=c()(s.a.mark((function e(t){var n,a,o,c,r,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,a=t.allItems,o=t.budget,c=t.percent,r=t.totals,i={budget:o,totalInc:r.inc,totalExp:r.exp,totalSav:r.sav,percentExp:c.exp,percentSav:c.sav,allItems:{inc:Object(d.arrayReassign)(a.inc),exp:Object(d.arrayReassign)(a.exp),sav:Object(d.arrayReassign)(a.sav)},created_at:firebase.firestore.Timestamp.fromDate(n)},e.next=5,this.budgets.add(i);case 5:return l=e.sent,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateBudget",value:(t=c()(s.a.mark((function e(t,n){var a,o,c,r,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.allItems,o=t.budget,c=t.percent,r=t.totals,i={budget:o,totalInc:r.inc,totalExp:r.exp,totalSav:r.sav,percentExp:c.exp,percentSav:c.sav,allItems:{inc:Object(d.arrayReassign)(a.inc),exp:Object(d.arrayReassign)(a.exp),sav:Object(d.arrayReassign)(a.sav)}},e.next=4,this.budgets.doc(n).update(i);case 4:return l=e.sent,e.abrupt("return",l);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getBudget",value:function(e){this.budgets.orderBy("created_at").onSnapshot((function(t){t.docChanges().forEach((function(t){"added"===t.type&&e(t.doc.data(),t.doc.id)}))}))}}]),e}();t.default=p},0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){"use strict";n.r(t),function(e,a){n.d(t,"arrayReassign",(function(){return u}));for(var s,o=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],r=c.length,i=window.console=window.console||{};r--;)i[s=c[r]]||(i[s]=o);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var l=document.querySelector("body");a({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?l.classList.add("is-mobile"):(a.on(">medium",(function(){l.classList.remove("is-mobile"),l.classList.add("is-desktop")})),a.on("<=medium",(function(){l.classList.remove("is-desktop"),l.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!");var u=function(e){return e.map((function(e){return Object.assign({},e)}))}}.call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var a=n("lwsE"),s=n.n(a),o=n("W8MJ"),c=n.n(o),r=n("b/SL"),i=n("xVb/"),l=new(n("+4zn").default),u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=Math.abs(e),o=(s=s.toFixed(2)).split("."),c=o[0],r=o[1];r=Number(r)>0?".".concat(r):"",c.length>3&&(c="".concat(c.substr(0,c.length-3),",").concat(c.substr(c.length-3,3)));var i=n?'<span class="currency">&pound;</span>':"";return"".concat(a?"exp"===t?'<span class="sign">&#45;</span> ':'<span class="sign">&#43;</span> ':"").concat(i).concat(c).concat(r)},d=function(){function e(t,n,a){s()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=a}return c()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"render",value:function(e,t){var n,a="exp"===t?"expenses":"sav"===t?"savings":"income",s=document.querySelector(".".concat(a,"__list"));n="\n    <li class='".concat(a,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p>").concat(u(e.val,t,!0,!1),"</p></div>\n    "),"exp"!==t&&"sav"!==t||(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',s.innerHTML+=n}},{key:"loadedRender",value:function(e,t){var n=this,a=e.allItems,s=document.querySelector("#chosen-ID"),o=i.default.getData(),c=document.querySelector(".budget__title");if(t===s.value){var l=e.created_at.toDate(),u=Object(r.format)(new Date(l),"do MMMM yyyy");c.textContent="Available budget saved on ".concat(u),this.displayBudget(e),this.displayPercentage(e.percentExp,"exp"),this.displayPercentage(e.percentSav,"sav"),o.budget=e.budget,o.totals.inc=e.totalInc,o.totals.exp=e.totalExp,o.totals.sav=e.totalSav,o.percent.exp=e.percentExp,o.percent.sav=e.percentSav,a.inc.forEach((function(e){n.render(e,"inc"),i.default.addItem("inc",e.desc,e.val)})),a.exp.forEach((function(e){n.render(e,"exp"),i.default.addItem("exp",e.desc,e.val),n.updatePercentages("exp")})),a.sav.forEach((function(e){n.render(e,"sav"),i.default.addItem("sav",e.desc,e.val),n.updatePercentages("sav")})),console.log(o)}}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,totalSav:e.totals.sav,percentExp:e.percent.exp,percentSav:e.percent.sav}}},{key:"displayBudget",value:function(e){var t=e.budget>0?"inc":"exp",n=document.querySelector(".budget__value"),a=document.querySelector(".budget__income .budget__amount"),s=document.querySelector(".budget__expenses .budget__amount"),o=document.querySelector(".budget__savings .budget__amount");n.innerHTML=u(e.budget,t,!0),a.innerHTML=u(e.totalInc,"inc"),s.innerHTML=u(e.totalExp,"exp"),o.innerHTML=u(e.totalSav,"exp")}},{key:"displayPercentage",value:function(e,t){var n="exp"===t?"expenses":"savings",a=document.querySelector(".budget__".concat(n," .budget__percentage"));e>0?(a.classList.add("show"),a.innerHTML="".concat(e,"&#37;")):a.classList.remove("show"),console.log(a)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percentExp,"exp"),this.displayPercentage(t.percentSav,"sav")}},{key:"displayPercentages",value:function(e,t){var n="exp"===t?"expenses":"savings";!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".".concat(n," .items__percent")),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(e){var t=e||this.inputType.value;i.default.calculatePercentages(t);var n=i.default.getPercentages(t);this.displayPercentages(n,t)}},{key:"displayDate",value:function(){var e=document.querySelector(".budget__date"),t=new Date;e.textContent="".concat(["January","February","March","April","May","June","July","August","Sepetember","October","November","December"][t.getMonth()]," ").concat(t.getFullYear())}},{key:"changeType",value:function(){var e=this.inputType,t=document.querySelector("#check");e.addEventListener("change",(function(n){var a=Array.from(e.options);console.log(n),console.log(e.attributes,e.options,e.options.selectedIndex,a,a[1]),a.forEach((function(e){e.selected?(e.setAttribute("selected","selected"),t.classList.remove("exp","sav"),"exp"===e.value?t.classList.add("exp"):"sav"===e.value&&t.classList.add("sav")):e.removeAttribute("selected","selected"),console.log("Value ".concat(e.value))}))}))}},{key:"deleteItem",value:function(){var e=this,t=document.querySelector(".income-expenses"),n=0;t.addEventListener("mouseout",(function(e){n=0,e.target.closest(".items__del")&&e.target.closest(".items").parentElement.classList.remove("confirm")})),t.addEventListener("click",(function(t){if(t.target.closest(".items__del")){var a=t.target.closest(".items").parentElement,s=a.id.split("-"),o=s[0],c=Number(s[1]);n+=1,console.log(t.target,a,s,o,c),n>1?(i.default.removeItem(o,c),a.remove(),e.updateBudget(),e.updatePercentages()):(console.log("this is the grandparent of e.target",t.target.parentElement.parentElement),t.target.closest(".items").parentElement.firstElementChild.appendChild("<p>Confirm deletion</p>"))}}))}},{key:"saving",value:function(){var e=document.querySelector("#save"),t=i.default.getData();e.addEventListener("click",(function(){var n=document.querySelector("#chosen-ID"),a=n.value||null,s=!1;n.classList.contains("chosen")&&(s=!0),console.log(t,t.allItems.inc,a),s&&a?l.updateBudget(t,a).then((function(){console.log("updated"),e.textContent="Updated",e.classList.remove("btn--ghost"),setTimeout((function(){e.textContent="Save",e.classList.add("btn--ghost")}),2e3)})).catch((function(e){console.error(e)})):l.saveBudget(t).then((function(){console.log("saved"),e.textContent="Saved",e.classList.remove("btn--ghost"),setTimeout((function(){e.textContent="Save",e.classList.add("btn--ghost")}),2e3)})).catch((function(e){console.error(e)}))}))}},{key:"styledDropdown",value:function(){var e=document.querySelector("#chosen-date"),t=document.querySelector("#chosen-ID"),n=document.querySelector(".date-list");e.addEventListener("focus",(function(){e.placeholder="Type to filter",n.classList.add("open")})),e.addEventListener("blur",(function(){n.classList.remove("open"),e.placeholder="Choose a date"})),e.addEventListener("input",(function(t){var a=e.value.trim().toLowerCase();!function(e,t){Array.from(e.children).filter((function(e){return!e.textContent.toLowerCase().includes(t)})).forEach((function(e){return e.classList.add("filtered")})),Array.from(e.children).filter((function(e){return e.textContent.toLowerCase().includes(t)})).forEach((function(e){return e.classList.remove("filtered")}))}(n,a),console.log(t)})),n.addEventListener("click",(function(a){if(console.log(a,a.target),t.classList.add("chosen"),Array.from(n.children).forEach((function(e){e.classList.remove("selected")})),"LI"===a.target.tagName){var s=a.target.textContent,o=a.target.getAttribute("data-id");e.setAttribute("value",s),e.placeholder=s,t.setAttribute("value",o),a.target.classList.add("selected")}}))}},{key:"Loaded",value:function(){var e=this,t=document.querySelector(".load-budgets"),n=i.default.getData(),a=document.querySelector(".income__list"),s=document.querySelector(".expenses__list"),o=document.querySelector(".savings__list"),c=0;t.addEventListener("submit",(function(r){r.preventDefault(),(c+=1)>1&&(n.allItems.inc=[],n.allItems.exp=[],n.allItems.sav=[],a.innerHTML="",s.innerHTML="",o.innerHTML="",console.log(n.allItems.inc)),l.getBudget((function(t,n){return e.loadedRender(t,n)})),t.reset()}))}},{key:"loading",value:function(){var e=document.querySelector(".date-list"),t=document.querySelector(".date-list li");l.getBudget((function(n,a){var s=n.created_at.toDate();if(s){var o=Object(r.format)(new Date(s),"dd/MM/yyyy"),c='<li class="date-list__item" data-id="'.concat(a,'">').concat(o,"</li>");"No saved dates"===t.textContent&&t.remove(),e.innerHTML+=c}})),this.styledDropdown(),this.Loaded()}}]),e}();t.default=d},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var a=n("cDf5"),s=n.n(a),o=(n("OuUZ"),n("E4hX"),n("xVb/")),c=n("SEKM"),r=n("+4zn"),i=document.querySelector("body");window.onload=function(){window.setTimeout((function(){i.classList.remove("is-loading")}),100)};!function(e){var t=document.querySelector(".add__form"),n=document.querySelector(".add__type"),a=document.querySelector(".add__description"),o=document.querySelector(".add__value"),i=new c.default(n,a,o),l=new r.default;i.displayDate(),i.changeType(),i.loading(),i.saving();var u=e.getData().allItems.inc;t.addEventListener("submit",(function(n){n.preventDefault();var a=i.getInput();if(console.log(a),console.log(s()(a.value)),t.reset(),""!==a.desc&&!isNaN(a.value)&&a.value>0){var o=e.addItem(a.type,a.description,a.value);i.render(o,a.type),i.updateBudget(),i.updatePercentages(),console.log("form submitted!"),console.log(o)}console.log(u)})),i.deleteItem(),l.getBudget((function(e,t){console.log(e,t)}))}(o.default)},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var a,s,o,c=n("cDf5"),r=n.n(c),i=n("lwsE"),l=n.n(i),u=n("W8MJ"),d=n.n(u),p=(a=function(){function e(t,n,a){l()(this,e),this.id=t,this.desc=n,this.val=a,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(r()(this.val)),"the totalIncome ".concat(r()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),s={allItems:{exp:[],inc:[],sav:[]},totals:{exp:0,inc:0,sav:0},percent:{exp:-1,sav:-1},budget:0},o=function(e){var t=0;s.allItems[e].forEach((function(e){t+=e.val})),s.totals[e]=t},{addItem:function(e,t,n){var o=s.allItems[e].length>0?s.allItems[e][s.allItems[e].length-1].id+1:0,c=new a(o,t,n);return s.allItems[e].push(c),c},calculateBudget:function(){return o("exp"),o("inc"),o("sav"),s.budget=s.totals.inc-(s.totals.exp+s.totals.sav),s.totals.inc>0?(s.percent.exp=Math.round(s.totals.exp/s.totals.inc*100),s.percent.sav=Math.round(s.totals.sav/s.totals.inc*100)):(s.percent.exp=-1,s.percent.sav=-1),console.log(s.totals.exp,s.totals.inc),console.log(s.budget,s.percent.exp,s.percent.sav),s},calculatePercentages:function(e){s.allItems[e].forEach((function(e){e.calcPercentage(s.totals.inc)}))},getPercentages:function(e){return s.allItems[e].map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=s.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&s.allItems[e].splice(n,1)},getData:function(){return s}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL3Bhc3RidWRnZXQuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy9oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvdWljb250cm9sbGVyLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyZWFrcG9pbnRzXCIiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvYXBwLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyb3dzZXJcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiUGFzdEJ1ZGdldCIsInRoaXMiLCJidWRnZXRzIiwiZGIiLCJjb2xsZWN0aW9uIiwib2JqIiwibm93IiwiRGF0ZSIsImFsbEl0ZW1zIiwiYnVkZ2V0IiwicGVyY2VudCIsInRvdGFscyIsImJ1ZGdldERhdGEiLCJ0b3RhbEluYyIsImluYyIsInRvdGFsRXhwIiwiZXhwIiwidG90YWxTYXYiLCJzYXYiLCJwZXJjZW50RXhwIiwicGVyY2VudFNhdiIsImFycmF5UmVhc3NpZ24iLCJjcmVhdGVkX2F0IiwiZmlyZWJhc2UiLCJmaXJlc3RvcmUiLCJUaW1lc3RhbXAiLCJmcm9tRGF0ZSIsImFkZCIsInJlc3BvbnNlIiwiaWQiLCJkb2MiLCJ1cGRhdGUiLCJjYiIsIm9yZGVyQnkiLCJvblNuYXBzaG90Iiwic25hcHNob3QiLCJkb2NDaGFuZ2VzIiwiZm9yRWFjaCIsImNoYW5nZSIsInR5cGUiLCJkYXRhIiwibWV0aG9kIiwibm9vcCIsIm1ldGhvZHMiLCJsZW5ndGgiLCJjb25zb2xlIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUZpcnN0VGFiIiwiZSIsImtleUNvZGUiLCJkb2N1bWVudCIsImJvZHkiLCJjbGFzc0xpc3QiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImJyb3dzZXIiLCJuYW1lIiwiYnJlYWtwb2ludHMiLCJ4bGFyZ2UiLCJsYXJnZSIsIm1lZGl1bSIsInNtYWxsIiwieHNtYWxsIiwibW9iaWxlIiwib24iLCJyZW1vdmUiLCJsb2NhdGlvbiIsImhvc3RuYW1lIiwibG9nIiwiYXIiLCJtYXAiLCJPYmplY3QiLCJhc3NpZ24iLCJwYXN0YnVkZ2V0IiwiZm9ybWF0TnVtYmVyIiwibnVtYmVyIiwibW9uZXkiLCJjYWxjIiwibnVtIiwiTWF0aCIsImFicyIsIm51bVNwbGl0IiwidG9GaXhlZCIsInNwbGl0IiwiaW50IiwiZGVjaW1hbCIsIk51bWJlciIsInN1YnN0ciIsImN1cnJlbmN5IiwiVUlDb250cm9sbGVyIiwiY29zdCIsImRlc2NyaXB0aW9uIiwidmFsdWUiLCJpbnB1dFR5cGUiLCJpbnB1dERlc2MiLCJpbnB1dFZhbCIsImh0bWwiLCJpdGVtIiwibGlzdCIsImRlc2MiLCJ2YWwiLCJpbm5lckhUTUwiLCJpbnB1dCIsImxvY2FsRGF0YSIsImJ1ZGdldENvbnRyb2xsZXIiLCJnZXREYXRhIiwiYnVkZ2V0RGF0ZSIsImRhdGUiLCJ0b0RhdGUiLCJwYXN0IiwiZm9ybWF0IiwidGV4dENvbnRlbnQiLCJkaXNwbGF5QnVkZ2V0IiwiZGlzcGxheVBlcmNlbnRhZ2UiLCJyZW5kZXIiLCJhZGRJdGVtIiwidXBkYXRlUGVyY2VudGFnZXMiLCJwZXJjZW50YWdlIiwidHlwZXMiLCJjYWxjdWxhdGVCdWRnZXQiLCJuZXdCdWRnZXQiLCJnZXRCdWRnZXQiLCJwZXJjZW50YWdlcyIsImkiLCJub2RlTGlzdEZvckVhY2giLCJxdWVyeVNlbGVjdG9yQWxsIiwiY3VycmVudCIsImluZGV4IiwiY2FsY3VsYXRlUGVyY2VudGFnZXMiLCJnZXRQZXJjZW50YWdlcyIsImRpc3BsYXlQZXJjZW50YWdlcyIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJjaGVjayIsIm9wdGlvbnMiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwic2VsZWN0ZWRJbmRleCIsIm9wdGlvbiIsInNlbGVjdGVkIiwicmVtb3ZlQXR0cmlidXRlIiwidGltZXNDbGlja2VkIiwidGFyZ2V0IiwiY2xvc2VzdCIsInBhcmVudEVsZW1lbnQiLCJzcGxpdElEIiwiSUQiLCJyZW1vdmVJdGVtIiwidXBkYXRlQnVkZ2V0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhcHBlbmRDaGlsZCIsImJ1dHRvbiIsImNvbnRhaW5zIiwidGhlbiIsInNldFRpbWVvdXQiLCJlcnIiLCJlcnJvciIsInNhdmVCdWRnZXQiLCJpbnB1dElEIiwiZHJvcGRvd24iLCJwbGFjZWhvbGRlciIsInRlcm0iLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJlbCIsImNoaWxkcmVuIiwiZmlsdGVyIiwiaW5jbHVkZXMiLCJmaWx0ZXJUZXJtcyIsImNoaWxkIiwidGFnTmFtZSIsInRhcmdldFR4dCIsInRhcmdldElEIiwiZ2V0QXR0cmlidXRlIiwiZm9ybSIsImluY29tZSIsImV4cGVuc2VzIiwic2F2aW5ncyIsImRhdGFMb2FkZWQiLCJwcmV2ZW50RGVmYXVsdCIsImxvYWRlZFJlbmRlciIsInJlc2V0IiwiZHJvcGRvd25MaXN0Iiwid2hlbiIsInN0eWxlZERyb3Bkb3duIiwiTG9hZGVkIiwibW9kdWxlIiwiZXhwb3J0cyIsIm9ubG9hZCIsImJ1ZGdldEN0cmwiLCJVSUN0cmwiLCJkaXNwbGF5RGF0ZSIsImNoYW5nZVR5cGUiLCJsb2FkaW5nIiwic2F2aW5nIiwiZ2V0SW5wdXQiLCJpc05hTiIsIm5ld0l0ZW0iLCJkZWxldGVJdGVtIiwiQnVkZ2V0IiwiY2FsY3VsYXRlVG90YWxzIiwidG90YWxJbmNvbWUiLCJyb3VuZCIsInN1bSIsImN1ciIsInB1c2giLCJjYWxjUGVyY2VudGFnZSIsImdldFBlcmNlbnRhZ2UiLCJpbmRleE9mIiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiNE1BT01BLEUsV0FDSixhQUFjLFlBQ1pDLEtBQUtDLFFBQVVDLEdBQUdDLFdBQVcsVywwRUFHZEMsRywwRkFD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QU8sT0FFcEUwQixFQUFLOUIsUUFBUU0sS0FBTyxFQUNwQndCLEVBQUs5QixRQUFRUSxLQUFPLEdBS3BCMkIsUUFBUXlCLElBQUk5QixFQUFLN0IsT0FBT0ssSUFBS3dCLEVBQUs3QixPQUFPRyxLQUN6QytCLFFBQVF5QixJQUFJOUIsRUFBSy9CLE9BQVErQixFQUFLOUIsUUFBUU0sSUFBS3dCLEVBQUs5QixRQUFRUSxLQUduRHNCLEdBRVQwRixxQkFBc0IsU0FBQzNGLEdBQ3JCQyxFQUFLaEMsU0FBUytCLEdBQU1GLFNBQVEsU0FBQzBLLEdBQzNCQSxFQUFJRSxlQUFlekssRUFBSzdCLE9BQU9HLFNBR25DcUgsZUFBZ0IsU0FBQzVGLEdBSWYsT0FIZ0JDLEVBQUtoQyxTQUFTK0IsR0FBTWlDLEtBQUksU0FBQ3VJLEdBQ3ZDLE9BQU9BLEVBQUlHLG9CQUlmNUQsV0FBWSxTQUFDL0csRUFBTVYsR0FDakIsSUFHTW9HLEVBSE16RixFQUFLaEMsU0FBUytCLEdBQU1pQyxLQUFJLFNBQUN3RCxHQUNuQyxPQUFPQSxFQUFRbkcsTUFFQ3NMLFFBQVF0TCxJQUVYLElBQVhvRyxHQUNGekYsRUFBS2hDLFNBQVMrQixHQUFNNkssT0FBT25GLEVBQU8sSUFHdEN0QixRQUFTLFdBQ1AsT0FBT25FLEtBS0VrRSxjIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItb2JqZWN0LXNwcmVhZCAqL1xuLy8gdG9kbzogc2F2ZSBidWRnZXQgZGF0YSB0byBmaXJlYmFzZVxuLy8gdG9kbzogZ2V0IGFsbEl0ZW1zIGRhdGEgdG8gc2F2ZSBzbyB0aGV5IGNhbiBiZSByZXBvcHVsYXRlZCB3aGVuIGxvYWRlZC5cbi8vIHRvZG86IGdldCB0aGUgZGF0YSBmcm9tIGZpcmViYXNlIHdoZW4gYSBkYXRlIGhhcyBiZWVuIGNob3NlbiBmcm9tIHRoZSBzZWxlY3Qgb3B0aW9ucyBhbmQgdXBkYXRlIHRoZSBVSVxuXG5pbXBvcnQgeyBhcnJheVJlYXNzaWduIH0gZnJvbSAnLi9oZWxwZXJzJ1xuXG5jbGFzcyBQYXN0QnVkZ2V0IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5idWRnZXRzID0gZGIuY29sbGVjdGlvbignYnVkZ2V0cycpXG4gIH1cblxuICBhc3luYyBzYXZlQnVkZ2V0KG9iaikge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBjb25zdCB7IGFsbEl0ZW1zLCBidWRnZXQsIHBlcmNlbnQsIHRvdGFscyB9ID0gb2JqXG4gICAgY29uc3QgYnVkZ2V0RGF0YSA9IHtcbiAgICAgIGJ1ZGdldCxcbiAgICAgIHRvdGFsSW5jOiB0b3RhbHMuaW5jLFxuICAgICAgdG90YWxFeHA6IHRvdGFscy5leHAsXG4gICAgICB0b3RhbFNhdjogdG90YWxzLnNhdixcbiAgICAgIHBlcmNlbnRFeHA6IHBlcmNlbnQuZXhwLFxuICAgICAgcGVyY2VudFNhdjogcGVyY2VudC5zYXYsXG4gICAgICBhbGxJdGVtczoge1xuICAgICAgICBpbmM6IGFycmF5UmVhc3NpZ24oYWxsSXRlbXMuaW5jKSxcbiAgICAgICAgZXhwOiBhcnJheVJlYXNzaWduKGFsbEl0ZW1zLmV4cCksXG4gICAgICAgIHNhdjogYXJyYXlSZWFzc2lnbihhbGxJdGVtcy5zYXYpLFxuICAgICAgfSxcbiAgICAgIGNyZWF0ZWRfYXQ6IGZpcmViYXNlLmZpcmVzdG9yZS5UaW1lc3RhbXAuZnJvbURhdGUobm93KSxcbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmJ1ZGdldHMuYWRkKGJ1ZGdldERhdGEpXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICBhc3luYyB1cGRhdGVCdWRnZXQob2JqLCBpZCkge1xuICAgIGNvbnN0IHsgYWxsSXRlbXMsIGJ1ZGdldCwgcGVyY2VudCwgdG90YWxzIH0gPSBvYmpcbiAgICBjb25zdCBidWRnZXREYXRhID0ge1xuICAgICAgYnVkZ2V0LFxuICAgICAgdG90YWxJbmM6IHRvdGFscy5pbmMsXG4gICAgICB0b3RhbEV4cDogdG90YWxzLmV4cCxcbiAgICAgIHRvdGFsU2F2OiB0b3RhbHMuc2F2LFxuICAgICAgcGVyY2VudEV4cDogcGVyY2VudC5leHAsXG4gICAgICBwZXJjZW50U2F2OiBwZXJjZW50LnNhdixcbiAgICAgIGFsbEl0ZW1zOiB7XG4gICAgICAgIGluYzogYXJyYXlSZWFzc2lnbihhbGxJdGVtcy5pbmMpLFxuICAgICAgICBleHA6IGFycmF5UmVhc3NpZ24oYWxsSXRlbXMuZXhwKSxcbiAgICAgICAgc2F2OiBhcnJheVJlYXNzaWduKGFsbEl0ZW1zLnNhdiksXG4gICAgICB9LFxuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYnVkZ2V0cy5kb2MoaWQpLnVwZGF0ZShidWRnZXREYXRhKVxuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgZ2V0QnVkZ2V0KGNiKSB7XG4gICAgdGhpcy5idWRnZXRzLm9yZGVyQnkoJ2NyZWF0ZWRfYXQnKS5vblNuYXBzaG90KChzbmFwc2hvdCkgPT4ge1xuICAgICAgc25hcHNob3QuZG9jQ2hhbmdlcygpLmZvckVhY2goKGNoYW5nZSkgPT4ge1xuICAgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGRlZCcpIHtcbiAgICAgICAgICBjYihjaGFuZ2UuZG9jLmRhdGEoKSwgY2hhbmdlLmRvYy5pZClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBhc3RCdWRnZXRcbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wbHVzcGx1cyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tbXVsdGktYXNzaWduICovXG5cbi8vIEF2b2lkIGBjb25zb2xlYCBlcnJvcnMgaW4gYnJvd3NlcnMgdGhhdCBsYWNrIGEgY29uc29sZS5cbntcbiAgbGV0IG1ldGhvZFxuICBjb25zdCBub29wID0gKCkgPT4ge31cbiAgY29uc3QgbWV0aG9kcyA9IFtcbiAgICAnYXNzZXJ0JyxcbiAgICAnY2xlYXInLFxuICAgICdjb3VudCcsXG4gICAgJ2RlYnVnJyxcbiAgICAnZGlyJyxcbiAgICAnZGlyeG1sJyxcbiAgICAnZXJyb3InLFxuICAgICdleGNlcHRpb24nLFxuICAgICdncm91cCcsXG4gICAgJ2dyb3VwQ29sbGFwc2VkJyxcbiAgICAnZ3JvdXBFbmQnLFxuICAgICdpbmZvJyxcbiAgICAnbG9nJyxcbiAgICAnbWFya1RpbWVsaW5lJyxcbiAgICAncHJvZmlsZScsXG4gICAgJ3Byb2ZpbGVFbmQnLFxuICAgICd0YWJsZScsXG4gICAgJ3RpbWUnLFxuICAgICd0aW1lRW5kJyxcbiAgICAndGltZWxpbmUnLFxuICAgICd0aW1lbGluZUVuZCcsXG4gICAgJ3RpbWVTdGFtcCcsXG4gICAgJ3RyYWNlJyxcbiAgICAnd2FybicsXG4gIF1cbiAgbGV0IHsgbGVuZ3RoIH0gPSBtZXRob2RzXG4gIGNvbnN0IGNvbnNvbGUgPSAod2luZG93LmNvbnNvbGUgPSB3aW5kb3cuY29uc29sZSB8fCB7fSlcblxuICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICBtZXRob2QgPSBtZXRob2RzW2xlbmd0aF1cblxuICAgIC8vIE9ubHkgc3R1YiB1bmRlZmluZWQgbWV0aG9kcy5cbiAgICBpZiAoIWNvbnNvbGVbbWV0aG9kXSkge1xuICAgICAgY29uc29sZVttZXRob2RdID0gbm9vcFxuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdGFiYmluZyBpbmRpY2F0b3IgdG8gd2luZG93XG5jb25zdCBoYW5kbGVGaXJzdFRhYiA9IChlKSA9PiB7XG4gIGlmIChlLmtleUNvZGUgPT09IDkpIHtcbiAgICAvLyB0aGUgXCJJIGFtIGEga2V5Ym9hcmQgdXNlclwiIGtleVxuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgndXNlci1pcy10YWJiaW5nJylcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUZpcnN0VGFiKVxuICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlRmlyc3RUYWIpXG5cbi8vIEFkZCBhIGJyb3dlciBpbmRpY2F0b3IgdG8gdGhlIEhUTUwgZWxlbWVudC5cbmNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJylcbmh0bWwuc2V0QXR0cmlidXRlKCdkYXRhLWJyb3dzZXInLCBicm93c2VyLm5hbWUpXG5cbi8vIERldGVjdCBpZiBtb2JpbGUgb3IgZGVza3RvcC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JylcblxuYnJlYWtwb2ludHMoe1xuICB4bGFyZ2U6IFsnMTI4MXB4JywgJzE2ODBweCddLFxuICBsYXJnZTogWyc5ODFweCcsICcxMjgwcHgnXSxcbiAgbWVkaXVtOiBbJzczN3B4JywgJzk4MHB4J10sXG4gIHNtYWxsOiBbJzQ4MXB4JywgJzczNnB4J10sXG4gIHhzbWFsbDogW251bGwsICc0ODBweCddLFxufSlcblxuaWYgKGJyb3dzZXIubW9iaWxlKSB7XG4gIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbW9iaWxlJylcbn0gZWxzZSB7XG4gIGJyZWFrcG9pbnRzLm9uKCc+bWVkaXVtJywgKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbW9iaWxlJylcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLWRlc2t0b3AnKVxuICB9KVxuICBicmVha3BvaW50cy5vbignPD1tZWRpdW0nLCAoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kZXNrdG9wJylcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpXG4gIH0pXG59XG5cbi8vIExvZyBpZiBydW5uaW5nIGluIGxvY2FsaG9zdCB3aGVuIGluIGRldmVsb3BtZW50IG1vZGUuXG5pZiAoXG4gIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgJiZcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJ1xuKSB7XG4gIGNvbnNvbGUubG9nKCdsb2NhbGhvc3QgZGV0ZWN0ZWQhJylcbn1cblxuLy8gUmVhc3NpZ24gYW4gYXJyYXkgYXMgYW4gT2JqZWN0XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxuZXhwb3J0IGNvbnN0IGFycmF5UmVhc3NpZ24gPSAoYXIpID0+IHtcbiAgcmV0dXJuIGFyLm1hcCgob2JqKSA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1vYmplY3Qtc3ByZWFkXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIG9iailcbiAgfSlcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGNsYXNzLW1ldGhvZHMtdXNlLXRoaXMgKi9cbmltcG9ydCB7IGZvcm1hdCB9IGZyb20gJ2RhdGUtZm5zJ1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9idWRnZXRjb250cm9sbGVyJ1xuaW1wb3J0IFBhc3RCdWRnZXQgZnJvbSAnLi9wYXN0YnVkZ2V0J1xuXG5jb25zdCBwYXN0YnVkZ2V0ID0gbmV3IFBhc3RCdWRnZXQoKVxuXG5jb25zdCBmb3JtYXROdW1iZXIgPSAobnVtYmVyLCB0eXBlLCBtb25leSA9IGZhbHNlLCBjYWxjID0gdHJ1ZSkgPT4ge1xuICAvKipcbiAgICogKyBvciAtIGJlZm9yZSB0aGUgbnVtYmVyXG4gICAqIGV4YWN0bHkgMiBkZWNpbWFsIHBvaW50c1xuICAgKiBjb21tYSBzZXBlcmF0aW5nIHRoZSB0aG91c2FuZHNcbiAgICpcbiAgICogMjMxMC40NTY3ID0gKyAyLDMxMC40NlxuICAgKi9cbiAgbGV0IG51bSA9IE1hdGguYWJzKG51bWJlcilcbiAgbnVtID0gbnVtLnRvRml4ZWQoMilcblxuICBjb25zdCBudW1TcGxpdCA9IG51bS5zcGxpdCgnLicpIC8vIG5vdyBhIHN0cmluZyBhbmQgd2lsbCBzcGxpdCB0aGUgLiB0byByZXBsYWNlIHdpdGggYSAsXG4gIGxldCBpbnQgPSBudW1TcGxpdFswXVxuICBsZXQgZGVjaW1hbCA9IG51bVNwbGl0WzFdXG4gIGRlY2ltYWwgPSBOdW1iZXIoZGVjaW1hbCkgPiAwID8gYC4ke2RlY2ltYWx9YCA6ICcnXG5cbiAgaWYgKGludC5sZW5ndGggPiAzKSB7XG4gICAgLy8gc3Vic3RyIGFsbG93cyBmb3Igb25seSBwYXJ0IG9mIHRoZSBzdHJpbmcgdG8gYmUgdGFrZW5cbiAgICBpbnQgPSBgJHtpbnQuc3Vic3RyKDAsIGludC5sZW5ndGggLSAzKX0sJHtpbnQuc3Vic3RyKGludC5sZW5ndGggLSAzLCAzKX1gIC8vIGlucHV0IDIzMTAsIG91dHB1dCAyLDMxMFxuICB9XG5cbiAgbGV0IHNpZ25cbiAgaWYgKGNhbGMpIHtcbiAgICBzaWduID1cbiAgICAgIHR5cGUgPT09ICdleHAnXG4gICAgICAgID8gJzxzcGFuIGNsYXNzPVwic2lnblwiPiYjNDU7PC9zcGFuPiAnXG4gICAgICAgIDogJzxzcGFuIGNsYXNzPVwic2lnblwiPiYjNDM7PC9zcGFuPiAnXG4gIH0gZWxzZSB7XG4gICAgc2lnbiA9ICcnXG4gIH1cbiAgY29uc3QgY3VycmVuY3kgPSBtb25leSA/ICc8c3BhbiBjbGFzcz1cImN1cnJlbmN5XCI+JnBvdW5kOzwvc3Bhbj4nIDogJydcblxuICAvLyBSZXR1cm4gdGhlIGZvcm1hdHRlZCBzdHJpbmdcbiAgcmV0dXJuIGAke3NpZ259JHtjdXJyZW5jeX0ke2ludH0ke2RlY2ltYWx9YFxufVxuXG4vLyBHcmFiIHNlYXJjaCB0ZXJtIGFuZCBmaWx0ZXIuXG5jb25zdCBmaWx0ZXJUZXJtcyA9IChlbCwgdGVybSkgPT4ge1xuICBBcnJheS5mcm9tKGVsLmNoaWxkcmVuKVxuICAgIC5maWx0ZXIoKGl0ZW0pID0+ICFpdGVtLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGVybSkpXG4gICAgLmZvckVhY2goKGl0ZW0pID0+IGl0ZW0uY2xhc3NMaXN0LmFkZCgnZmlsdGVyZWQnKSlcbiAgQXJyYXkuZnJvbShlbC5jaGlsZHJlbilcbiAgICAuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGVybSkpXG4gICAgLmZvckVhY2goKGl0ZW0pID0+IGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZmlsdGVyZWQnKSlcbn1cblxuLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLWRlc3RydWN0dXJpbmcgKi9cbmNsYXNzIFVJQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKGNvc3QsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgIHRoaXMuaW5wdXRUeXBlID0gY29zdFxuICAgIHRoaXMuaW5wdXREZXNjID0gZGVzY3JpcHRpb25cbiAgICB0aGlzLmlucHV0VmFsID0gdmFsdWVcbiAgfVxuXG4gIGdldElucHV0KCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiB0aGlzLmlucHV0VHlwZS52YWx1ZSwgLy8gV2lsbCBiZSBlaXRoZXIgaW5jIG9yIGV4cFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuaW5wdXREZXNjLnZhbHVlLFxuICAgICAgdmFsdWU6IE51bWJlcih0aGlzLmlucHV0VmFsLnZhbHVlKSxcbiAgICB9XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICByZW5kZXIob2JqLCB0eXBlKSB7XG4gICAgY29uc3QgaXRlbSA9XG4gICAgICB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiB0eXBlID09PSAnc2F2JyA/ICdzYXZpbmdzJyA6ICdpbmNvbWUnXG4gICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2l0ZW19X19saXN0YClcbiAgICBsZXQgaHRtbFxuXG4gICAgLy8gQ3JlYXRlIEhUTUwgc3RyaW5nIHdpdGggcGxhY2Vob2xkZXJcbiAgICBodG1sID0gYFxuICAgIDxsaSBjbGFzcz0nJHtpdGVtfV9faXRlbScgaWQ9JyR7dHlwZX0tJHtvYmouaWR9Jz5cbiAgICAgIDxkaXYgY2xhc3M9J2l0ZW0tZGVzYyc+PHA+JHtvYmouZGVzY308L3A+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiaXRlbXNcIj5cbiAgICAgICAgPGRpdiBjbGFzcz0naXRlbXNfX3ZhbHVlJz48cD4ke2Zvcm1hdE51bWJlcihcbiAgICAgICAgICBvYmoudmFsLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICBmYWxzZVxuICAgICAgICApfTwvcD48L2Rpdj5cbiAgICBgXG5cbiAgICBpZiAodHlwZSA9PT0gJ2V4cCcgfHwgdHlwZSA9PT0gJ3NhdicpIHtcbiAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJpdGVtc19fcGVyY2VudFwiPjxwPjAmIzM3OzwvcD48L2Rpdj4nXG4gICAgfVxuXG4gICAgaHRtbCArPSBgXG4gICAgICAgIDxidXR0b24gY2xhc3M9J2J0biBidG4tLWNsZWFyIGl0ZW1zX19kZWwnPlxuICAgICAgICAgIDxzdmcgaWQ9XCJkZWxldGVcIiBjbGFzcz1cImljb25cIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj1cIi9hc3NldHMvaW1hZ2VzL2ljb25zLnN2ZyNpY29uLWRlbGV0ZVwiPjwvdXNlPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvbGk+XG4gICAgYFxuXG4gICAgLy8gSW5zZXJ0IEhUTUwgaW50byB0aGUgRE9NXG4gICAgbGlzdC5pbm5lckhUTUwgKz0gaHRtbFxuICB9XG5cbiAgbG9hZGVkUmVuZGVyKGRhdGEsIGlkKSB7XG4gICAgY29uc3QgeyBhbGxJdGVtcyB9ID0gZGF0YVxuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Nob3Nlbi1JRCcpXG4gICAgY29uc3QgbG9jYWxEYXRhID0gYnVkZ2V0Q29udHJvbGxlci5nZXREYXRhKClcbiAgICBjb25zdCBidWRnZXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1ZGdldF9fdGl0bGUnKVxuXG4gICAgaWYgKGlkID09PSBpbnB1dC52YWx1ZSkge1xuICAgICAgLy8gQ2hhbmdlIHRoZSBkYXRlIGZvciB0aGUgYXZhaWxhYmxlIGJ1ZGdldCBmcm9tIHRvZGF5J3MgZGF0ZVxuICAgICAgY29uc3QgZGF0ZSA9IGRhdGEuY3JlYXRlZF9hdC50b0RhdGUoKVxuICAgICAgY29uc3QgcGFzdCA9IGZvcm1hdChuZXcgRGF0ZShkYXRlKSwgJ2RvIE1NTU0geXl5eScpXG4gICAgICBidWRnZXREYXRlLnRleHRDb250ZW50ID0gYEF2YWlsYWJsZSBidWRnZXQgc2F2ZWQgb24gJHtwYXN0fWBcblxuICAgICAgLy8gRGlzcGxheSB0aGUgc2F2ZWQgZGF0YVxuICAgICAgdGhpcy5kaXNwbGF5QnVkZ2V0KGRhdGEpXG4gICAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlKGRhdGEucGVyY2VudEV4cCwgJ2V4cCcpXG4gICAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlKGRhdGEucGVyY2VudFNhdiwgJ3NhdicpXG5cbiAgICAgIC8vIFB1c2ggdGhlIHNhdmVkIEZpcmViYXNlIGRhdGEgdG8gdGhlIGJ1ZGdldGNvbnRyb2xsZXIgZGF0YSBvYmplY3RcbiAgICAgIGxvY2FsRGF0YS5idWRnZXQgPSBkYXRhLmJ1ZGdldFxuICAgICAgbG9jYWxEYXRhLnRvdGFscy5pbmMgPSBkYXRhLnRvdGFsSW5jXG4gICAgICBsb2NhbERhdGEudG90YWxzLmV4cCA9IGRhdGEudG90YWxFeHBcbiAgICAgIGxvY2FsRGF0YS50b3RhbHMuc2F2ID0gZGF0YS50b3RhbFNhdlxuICAgICAgbG9jYWxEYXRhLnBlcmNlbnQuZXhwID0gZGF0YS5wZXJjZW50RXhwXG4gICAgICBsb2NhbERhdGEucGVyY2VudC5zYXYgPSBkYXRhLnBlcmNlbnRTYXZcblxuICAgICAgLy8gTG9vcCB0aHJvdWdoIHRoZSBGaXJlYmFzZSBhbGxJdGVtcyBvYmplY3QsIHJlbmRlciBpdCBpbiB0aGUgVUkgYW5kIHB1c2ggdG8gdGhlIGJ1ZGdldGNvbnRyb2xsZXIgZGF0YSBvYmplY3RcbiAgICAgIGFsbEl0ZW1zLmluYy5mb3JFYWNoKChpbmMpID0+IHtcbiAgICAgICAgdGhpcy5yZW5kZXIoaW5jLCAnaW5jJylcbiAgICAgICAgYnVkZ2V0Q29udHJvbGxlci5hZGRJdGVtKCdpbmMnLCBpbmMuZGVzYywgaW5jLnZhbClcbiAgICAgIH0pXG4gICAgICBhbGxJdGVtcy5leHAuZm9yRWFjaCgoZXhwKSA9PiB7XG4gICAgICAgIHRoaXMucmVuZGVyKGV4cCwgJ2V4cCcpXG4gICAgICAgIGJ1ZGdldENvbnRyb2xsZXIuYWRkSXRlbSgnZXhwJywgZXhwLmRlc2MsIGV4cC52YWwpXG4gICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZXMoJ2V4cCcpXG4gICAgICB9KVxuICAgICAgYWxsSXRlbXMuc2F2LmZvckVhY2goKHNhdikgPT4ge1xuICAgICAgICB0aGlzLnJlbmRlcihzYXYsICdzYXYnKVxuICAgICAgICBidWRnZXRDb250cm9sbGVyLmFkZEl0ZW0oJ3NhdicsIHNhdi5kZXNjLCBzYXYudmFsKVxuICAgICAgICB0aGlzLnVwZGF0ZVBlcmNlbnRhZ2VzKCdzYXYnKVxuICAgICAgfSlcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIC8vIGlkLFxuICAgICAgICAgIC8vIGRhdGEuYnVkZ2V0LFxuICAgICAgICAgIC8vIGRhdGEudG90YWxJbmMsXG4gICAgICAgICAgLy8gZGF0YS50b3RhbEV4cCxcbiAgICAgICAgICAvLyBhbGxJdGVtcyxcbiAgICAgICAgICAvLyBhbGxJdGVtcy5oYXNPd25Qcm9wZXJ0eSgnaW5jJyksXG4gICAgICAgICAgLy8gdHlwZW9mIGFsbEl0ZW1zLmluYyxcbiAgICAgICAgICAvLyBhbGxJdGVtcy5leHAsXG4gICAgICAgICAgbG9jYWxEYXRhXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRCdWRnZXQoZGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICBidWRnZXQ6IGRhdGEuYnVkZ2V0LFxuICAgICAgdG90YWxJbmM6IGRhdGEudG90YWxzLmluYyxcbiAgICAgIHRvdGFsRXhwOiBkYXRhLnRvdGFscy5leHAsXG4gICAgICB0b3RhbFNhdjogZGF0YS50b3RhbHMuc2F2LFxuICAgICAgcGVyY2VudEV4cDogZGF0YS5wZXJjZW50LmV4cCxcbiAgICAgIHBlcmNlbnRTYXY6IGRhdGEucGVyY2VudC5zYXYsXG4gICAgfVxuICB9XG5cbiAgZGlzcGxheUJ1ZGdldChvYmopIHtcbiAgICBjb25zdCB0eXBlID0gb2JqLmJ1ZGdldCA+IDAgPyAnaW5jJyA6ICdleHAnXG4gICAgY29uc3QgYnVkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1ZGdldF9fdmFsdWUnKVxuICAgIGNvbnN0IGluYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXRfX2luY29tZSAuYnVkZ2V0X19hbW91bnRgKVxuICAgIGNvbnN0IGV4cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXRfX2V4cGVuc2VzIC5idWRnZXRfX2Ftb3VudGApXG4gICAgY29uc3Qgc2F2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmJ1ZGdldF9fc2F2aW5ncyAuYnVkZ2V0X19hbW91bnRgKVxuXG4gICAgYnVkZ2V0LmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmouYnVkZ2V0LCB0eXBlLCB0cnVlKVxuICAgIGluYy5pbm5lckhUTUwgPSBmb3JtYXROdW1iZXIob2JqLnRvdGFsSW5jLCAnaW5jJylcbiAgICBleHAuaW5uZXJIVE1MID0gZm9ybWF0TnVtYmVyKG9iai50b3RhbEV4cCwgJ2V4cCcpXG4gICAgc2F2LmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmoudG90YWxTYXYsICdleHAnKVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2UocGVyY2VudGFnZSwgdHlwZSkge1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ3NhdmluZ3MnXG4gICAgY29uc3QgcGVyY2VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmJ1ZGdldF9fJHt0eXBlc30gLmJ1ZGdldF9fcGVyY2VudGFnZWBcbiAgICApXG5cbiAgICBpZiAocGVyY2VudGFnZSA+IDApIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpXG4gICAgICBwZXJjZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2V9JiMzNztgXG4gICAgfSBlbHNlIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgfVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKHBlcmNlbnQpXG4gICAgfVxuICB9XG5cbiAgdXBkYXRlQnVkZ2V0KCkge1xuICAgIC8vIDEuIENoZWNrIGxvY2FsU3RvcmFnZSBmb3Igc2F2ZSBidWRnZXQgZGF0YSwgZWxzZSBnZXQgbmV3IGRhdGFcbiAgICBjb25zdCBnZXREYXRhID0gYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVCdWRnZXQoKVxuXG4gICAgLy8gMi4gUmV0dXJuIHRoZSBidWRnZXRcbiAgICBjb25zdCBuZXdCdWRnZXQgPSB0aGlzLmdldEJ1ZGdldChnZXREYXRhKVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKG5ld0J1ZGdldClcbiAgICB9XG5cbiAgICAvLyAzLiBEaXNwbGF5IHRoZSB1cGRhdGVkIGJ1ZGdldFxuICAgIHRoaXMuZGlzcGxheUJ1ZGdldChuZXdCdWRnZXQpXG5cbiAgICAvLyA0LiBEaXNwbGF5IHRoZSBuZXcgb3ZlcmFsbCBidWRnZXQgcGVyY2VudGFnZVxuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2UobmV3QnVkZ2V0LnBlcmNlbnRFeHAsICdleHAnKVxuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2UobmV3QnVkZ2V0LnBlcmNlbnRTYXYsICdzYXYnKVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2VzKHBlcmNlbnRhZ2VzLCB0eXBlKSB7XG4gICAgY29uc3QgdHlwZXMgPSB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiAnc2F2aW5ncydcbiAgICBjb25zdCBmaWVsZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHt0eXBlc30gLml0ZW1zX19wZXJjZW50YClcbiAgICBjb25zdCBub2RlTGlzdEZvckVhY2ggPSAobGlzdCwgY2IpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjYihsaXN0W2ldLCBpKVxuICAgICAgfVxuICAgIH1cbiAgICBub2RlTGlzdEZvckVhY2goZmllbGRzLCAoY3VycmVudCwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChwZXJjZW50YWdlc1tpbmRleF0gPiAwKSB7XG4gICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpXG4gICAgICAgIGN1cnJlbnQuaW5uZXJIVE1MID0gYCR7cGVyY2VudGFnZXNbaW5kZXhdfSYjMzc7YFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcbiAgICAgICAgY3VycmVudC5pbm5lckhUTUwgPSAnMCYjMzc7J1xuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICB1cGRhdGVQZXJjZW50YWdlcyhkYXRhKSB7XG4gICAgY29uc3QgaW5wdXQgPSBkYXRhIHx8IHRoaXMuaW5wdXRUeXBlLnZhbHVlXG4gICAgLy8gMS4gQ2FsdWxhdGUgcGVyY2VudGFnZXNcbiAgICBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKGlucHV0KVxuXG4gICAgLy8gMi4gUmVhZCBwZXJjZW50YWdlcyBmcm9tIGJ1ZGdldCBjb250cm9sbGVyXG4gICAgY29uc3QgcGVyY2VudGFnZXMgPSBidWRnZXRDb250cm9sbGVyLmdldFBlcmNlbnRhZ2VzKGlucHV0KVxuXG4gICAgLy8gMy4gVXBkYXRlIFVJIHRvIHNob3cgbmV3IHBlcmNlbnRhZ2VzXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZXMocGVyY2VudGFnZXMsIGlucHV0KVxuICB9XG5cbiAgZGlzcGxheURhdGUoKSB7XG4gICAgY29uc3QgYnVkZ2V0RGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idWRnZXRfX2RhdGUnKVxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgbW9udGhzID0gW1xuICAgICAgJ0phbnVhcnknLFxuICAgICAgJ0ZlYnJ1YXJ5JyxcbiAgICAgICdNYXJjaCcsXG4gICAgICAnQXByaWwnLFxuICAgICAgJ01heScsXG4gICAgICAnSnVuZScsXG4gICAgICAnSnVseScsXG4gICAgICAnQXVndXN0JyxcbiAgICAgICdTZXBldGVtYmVyJyxcbiAgICAgICdPY3RvYmVyJyxcbiAgICAgICdOb3ZlbWJlcicsXG4gICAgICAnRGVjZW1iZXInLFxuICAgIF1cbiAgICBidWRnZXREYXRlLnRleHRDb250ZW50ID0gYCR7bW9udGhzW2RhdGUuZ2V0TW9udGgoKV19ICR7ZGF0ZS5nZXRGdWxsWWVhcigpfWBcbiAgfVxuXG4gIGNoYW5nZVR5cGUoKSB7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMuaW5wdXRUeXBlXG4gICAgY29uc3QgY2hlY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2hlY2snKVxuXG4gICAgdHlwZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IEFycmF5LmZyb20odHlwZS5vcHRpb25zKVxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICB0eXBlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgdHlwZS5vcHRpb25zLFxuICAgICAgICAgIHR5cGUub3B0aW9ucy5zZWxlY3RlZEluZGV4LFxuICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgb3B0aW9uc1sxXVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG4gICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgICBvcHRpb24uc2V0QXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICAgICAgY2hlY2suY2xhc3NMaXN0LnJlbW92ZSgnZXhwJywgJ3NhdicpXG4gICAgICAgICAgaWYgKG9wdGlvbi52YWx1ZSA9PT0gJ2V4cCcpIHtcbiAgICAgICAgICAgIGNoZWNrLmNsYXNzTGlzdC5hZGQoJ2V4cCcpXG4gICAgICAgICAgfSBlbHNlIGlmIChvcHRpb24udmFsdWUgPT09ICdzYXYnKSB7XG4gICAgICAgICAgICBjaGVjay5jbGFzc0xpc3QuYWRkKCdzYXYnKVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvcHRpb24ucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgVmFsdWUgJHtvcHRpb24udmFsdWV9YClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgZGVsZXRlSXRlbSgpIHtcbiAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluY29tZS1leHBlbnNlcycpXG4gICAgbGV0IHRpbWVzQ2xpY2tlZCA9IDBcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKGUpID0+IHtcbiAgICAgIHRpbWVzQ2xpY2tlZCA9IDBcbiAgICAgIGNvbnN0IGJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5pdGVtc19fZGVsJylcbiAgICAgIGlmIChidG4pIHtcbiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLml0ZW1zJykucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjb25maXJtJylcbiAgICAgICAgLy8gZS50YXJnZXQuY2xvc2VzdCgnLml0ZW1zJykucGFyZW50RWxlbWVudC5maW5kKCdwJykucmVtb3ZlKClcbiAgICAgIH1cbiAgICB9KVxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgY29uc3QgYnRuID0gZS50YXJnZXQuY2xvc2VzdCgnLml0ZW1zX19kZWwnKVxuICAgICAgaWYgKGJ0bikge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KCcuaXRlbXMnKS5wYXJlbnRFbGVtZW50XG4gICAgICAgIGNvbnN0IHNwbGl0SUQgPSB0YXJnZXQuaWQuc3BsaXQoJy0nKVxuICAgICAgICBjb25zdCB0eXBlID0gc3BsaXRJRFswXVxuICAgICAgICBjb25zdCBJRCA9IE51bWJlcihzcGxpdElEWzFdKVxuICAgICAgICB0aW1lc0NsaWNrZWQgKz0gMVxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQsIHRhcmdldCwgc3BsaXRJRCwgdHlwZSwgSUQpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBjb25maXJtZWQgZGVsZXRpb24gYmVmb3JlIGRlbGV0aW5nXG4gICAgICAgIGlmICh0aW1lc0NsaWNrZWQgPiAxKSB7XG4gICAgICAgICAgLy8gMS4gRGVsZXRlIHRoZSBpdGVtIGZyb20gdGhlIGRhdGEgc3RydWN0dXJlXG4gICAgICAgICAgYnVkZ2V0Q29udHJvbGxlci5yZW1vdmVJdGVtKHR5cGUsIElEKVxuXG4gICAgICAgICAgLy8gMi4gRGVsZXRlIHRoZSBpdGVtIGZyb20gdGhlIFVJXG4gICAgICAgICAgdGFyZ2V0LnJlbW92ZSgpXG5cbiAgICAgICAgICAvLyAzLiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBidWRnZXRcbiAgICAgICAgICB0aGlzLnVwZGF0ZUJ1ZGdldCgpXG5cbiAgICAgICAgICAvLyA0LiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBwZXJjZW50YWdlc1xuICAgICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZXMoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgJ3RoaXMgaXMgdGhlIGdyYW5kcGFyZW50IG9mIGUudGFyZ2V0JyxcbiAgICAgICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgICAgICAgIClcbiAgICAgICAgICBlLnRhcmdldFxuICAgICAgICAgICAgLmNsb3Nlc3QoJy5pdGVtcycpXG4gICAgICAgICAgICAucGFyZW50RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgICAgJzxwPkNvbmZpcm0gZGVsZXRpb248L3A+J1xuICAgICAgICAgICAgKVxuICAgICAgICAgIC8vIC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWJlZ2luJywgJzxwPkNvbmZpcm0gZGVsZXRpb248L3A+JylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBzYXZpbmcoKSB7XG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NhdmUnKVxuICAgIGNvbnN0IGRhdGEgPSBidWRnZXRDb250cm9sbGVyLmdldERhdGEoKVxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Nob3Nlbi1JRCcpXG4gICAgICBjb25zdCBJRCA9IGlucHV0LnZhbHVlIHx8IG51bGxcbiAgICAgIGxldCBzZWxlY3RlZCA9IGZhbHNlXG5cbiAgICAgIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nob3NlbicpKSB7XG4gICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxuICAgICAgfVxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLCBkYXRhLmFsbEl0ZW1zLmluYywgSUQpXG4gICAgICB9XG5cbiAgICAgIGlmIChzZWxlY3RlZCAmJiBJRCkge1xuICAgICAgICBwYXN0YnVkZ2V0XG4gICAgICAgICAgLnVwZGF0ZUJ1ZGdldChkYXRhLCBJRClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndXBkYXRlZCcpXG4gICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnVXBkYXRlZCdcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdidG4tLWdob3N0JylcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnU2F2ZSdcbiAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2J0bi0tZ2hvc3QnKVxuICAgICAgICAgICAgfSwgMjAwMClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFzdGJ1ZGdldFxuICAgICAgICAgIC5zYXZlQnVkZ2V0KGRhdGEpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmVkJylcbiAgICAgICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZlZCdcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdidG4tLWdob3N0JylcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnU2F2ZSdcbiAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2J0bi0tZ2hvc3QnKVxuICAgICAgICAgICAgfSwgMjAwMClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBzdHlsZWREcm9wZG93bigpIHtcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjaG9zZW4tZGF0ZScpXG4gICAgY29uc3QgaW5wdXRJRCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjaG9zZW4tSUQnKVxuICAgIGNvbnN0IGRyb3Bkb3duID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtbGlzdCcpXG5cbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+IHtcbiAgICAgIGlucHV0LnBsYWNlaG9sZGVyID0gJ1R5cGUgdG8gZmlsdGVyJ1xuICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LmFkZCgnb3BlbicpXG4gICAgfSlcblxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoKSA9PiB7XG4gICAgICBkcm9wZG93bi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJylcbiAgICAgIGlucHV0LnBsYWNlaG9sZGVyID0gJ0Nob29zZSBhIGRhdGUnXG4gICAgfSlcblxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICAgIGNvbnN0IHRlcm0gPSBpbnB1dC52YWx1ZS50cmltKCkudG9Mb3dlckNhc2UoKVxuICAgICAgZmlsdGVyVGVybXMoZHJvcGRvd24sIHRlcm0pXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgY29uc29sZS5sb2coZSlcbiAgICB9KVxuXG4gICAgZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGNvbnNvbGUubG9nKGUsIGUudGFyZ2V0KVxuICAgICAgaW5wdXRJRC5jbGFzc0xpc3QuYWRkKCdjaG9zZW4nKVxuICAgICAgQXJyYXkuZnJvbShkcm9wZG93bi5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgY2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgfSlcbiAgICAgIGlmIChlLnRhcmdldC50YWdOYW1lID09PSAnTEknKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFR4dCA9IGUudGFyZ2V0LnRleHRDb250ZW50XG4gICAgICAgIGNvbnN0IHRhcmdldElEID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJylcbiAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHRhcmdldFR4dClcbiAgICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSB0YXJnZXRUeHRcbiAgICAgICAgaW5wdXRJRC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgdGFyZ2V0SUQpXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgTG9hZGVkKCkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1idWRnZXRzJylcbiAgICBjb25zdCBsb2NhbERhdGEgPSBidWRnZXRDb250cm9sbGVyLmdldERhdGEoKVxuICAgIGNvbnN0IGluY29tZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmNvbWVfX2xpc3QnKVxuICAgIGNvbnN0IGV4cGVuc2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmV4cGVuc2VzX19saXN0JylcbiAgICBjb25zdCBzYXZpbmdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNhdmluZ3NfX2xpc3QnKVxuICAgIGxldCBkYXRhTG9hZGVkID0gMFxuXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICBkYXRhTG9hZGVkICs9IDFcblxuICAgICAgaWYgKGRhdGFMb2FkZWQgPiAxKSB7XG4gICAgICAgIGxvY2FsRGF0YS5hbGxJdGVtcy5pbmMgPSBbXVxuICAgICAgICBsb2NhbERhdGEuYWxsSXRlbXMuZXhwID0gW11cbiAgICAgICAgbG9jYWxEYXRhLmFsbEl0ZW1zLnNhdiA9IFtdXG4gICAgICAgIGluY29tZS5pbm5lckhUTUwgPSAnJ1xuICAgICAgICBleHBlbnNlcy5pbm5lckhUTUwgPSAnJ1xuICAgICAgICBzYXZpbmdzLmlubmVySFRNTCA9ICcnXG4gICAgICAgIGNvbnNvbGUubG9nKGxvY2FsRGF0YS5hbGxJdGVtcy5pbmMpXG4gICAgICB9XG4gICAgICBwYXN0YnVkZ2V0LmdldEJ1ZGdldCgoZGF0YSwgaWQpID0+IHRoaXMubG9hZGVkUmVuZGVyKGRhdGEsIGlkKSlcbiAgICAgIGZvcm0ucmVzZXQoKVxuICAgIH0pXG4gIH1cblxuICBsb2FkaW5nKCkge1xuICAgIGNvbnN0IGRyb3Bkb3duID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtbGlzdCcpXG4gICAgY29uc3QgZHJvcGRvd25MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtbGlzdCBsaScpXG5cbiAgICAvLyBHZXQgc2F2ZWQgZW50cnkgZGF0ZXMgZnJvbSBGaXJlYmFzZVxuICAgIHBhc3RidWRnZXQuZ2V0QnVkZ2V0KChidWRnZXRzLCBpZCkgPT4ge1xuICAgICAgY29uc3QgZGF0ZSA9IGJ1ZGdldHMuY3JlYXRlZF9hdC50b0RhdGUoKVxuICAgICAgaWYgKGRhdGUpIHtcbiAgICAgICAgY29uc3Qgd2hlbiA9IGZvcm1hdChuZXcgRGF0ZShkYXRlKSwgJ2RkL01NL3l5eXknKVxuICAgICAgICBjb25zdCBsaXN0ID0gYDxsaSBjbGFzcz1cImRhdGUtbGlzdF9faXRlbVwiIGRhdGEtaWQ9XCIke2lkfVwiPiR7d2hlbn08L2xpPmBcbiAgICAgICAgaWYgKGRyb3Bkb3duTGlzdC50ZXh0Q29udGVudCA9PT0gJ05vIHNhdmVkIGRhdGVzJykgZHJvcGRvd25MaXN0LnJlbW92ZSgpXG4gICAgICAgIGRyb3Bkb3duLmlubmVySFRNTCArPSBsaXN0XG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIEFkZCBmdW5jdGlvbmFsaXR5IHRvIGRyb3Bkb3duIHNlYXJjaFxuICAgIHRoaXMuc3R5bGVkRHJvcGRvd24oKVxuICAgIC8vIExvYWQgdGhlIGRhdGEgZnJvbSBGaXJlYmFzZSBvbmNlIGRhdGUgaXMgY2hvc2VuXG4gICAgdGhpcy5Mb2FkZWQoKVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVJQ29udHJvbGxlclxuIiwibW9kdWxlLmV4cG9ydHMgPSBicmVha3BvaW50czsiLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG5cbi8vIEV4dGVybmFsXG5pbXBvcnQgJ2FpcmJuYi1icm93c2VyLXNoaW1zJ1xuXG4vLyBJbnRlcm5hbFxuaW1wb3J0ICcuL21vZHVsZXMvaGVscGVycydcbmltcG9ydCBidWRnZXRDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy9idWRnZXRjb250cm9sbGVyJ1xuaW1wb3J0IFVJQ29udHJvbGxlciBmcm9tICcuL21vZHVsZXMvdWljb250cm9sbGVyJ1xuaW1wb3J0IFBhc3RCdWRnZXQgZnJvbSAnLi9tb2R1bGVzL3Bhc3RidWRnZXQnXG5cbi8vIFJlbW92ZSBsb2FkaW5nIGNsYXNzIGZyb20gYm9keSBvbiB3aW5kb3cgbG9hZC5cbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jylcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtbG9hZGluZycpXG4gIH0sIDEwMClcbn1cblxuLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRyb2xsZXIgZm9yIHRoZSBhcHBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuY29uc3QgY29udHJvbGxlciA9ICgoYnVkZ2V0Q3RybCkgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZm9ybScpXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX190eXBlJylcbiAgY29uc3QgZGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX2Rlc2NyaXB0aW9uJylcbiAgY29uc3QgdmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX192YWx1ZScpXG5cbiAgY29uc3QgVUlDdHJsID0gbmV3IFVJQ29udHJvbGxlcih0eXBlLCBkZXNjLCB2YWx1ZSlcbiAgY29uc3QgcGFzdGJ1ZGdldCA9IG5ldyBQYXN0QnVkZ2V0KClcblxuICAvLyBTaG9lIHRoZSBsYXRlc3QgZGF0ZVxuICBVSUN0cmwuZGlzcGxheURhdGUoKVxuXG4gIC8vIFRvZ2dsZSB0aGUgc3VibWl0IG5ldyBjb3N0IGZyb20gZWl0aGVyIGluY29tZSBvciBleHBlbnNlLlxuICBVSUN0cmwuY2hhbmdlVHlwZSgpXG5cbiAgLy8gTG9hZCBidWRnZXRzIGZyb20gRmlyZWJhc2VcbiAgVUlDdHJsLmxvYWRpbmcoKVxuXG4gIC8vIFNhdmUgYnVkZ2V0cyB0byBGaXJlYmFzZVxuICBVSUN0cmwuc2F2aW5nKClcblxuICBjb25zdCB0ZXN0ID0gYnVkZ2V0Q3RybC5nZXREYXRhKClcbiAgY29uc3QgeyBpbmMgfSA9IHRlc3QuYWxsSXRlbXNcblxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAvLyBHZXQgZmlsZWQgaW5wdXQgZGF0YVxuICAgIGNvbnN0IGlucHV0ID0gVUlDdHJsLmdldElucHV0KClcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coaW5wdXQpXG4gICAgICBjb25zb2xlLmxvZyh0eXBlb2YgaW5wdXQudmFsdWUpXG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgdGhlIGZvcm0gZmllbGRzXG4gICAgZm9ybS5yZXNldCgpXG5cbiAgICAvLyBPbmx5IHJ1biBjYWxjdWxhdGlvbnMgaWYgdmFsaWQgaW5wdXRzIGFyZSBlbnRlcmVkXG4gICAgaWYgKGlucHV0LmRlc2MgIT09ICcnICYmICFpc05hTihpbnB1dC52YWx1ZSkgJiYgaW5wdXQudmFsdWUgPiAwKSB7XG4gICAgICAvLyBBZGQgdGhlIGl0ZW0gdG8gdGhlIGJ1ZGdldFxuICAgICAgY29uc3QgbmV3SXRlbSA9IGJ1ZGdldEN0cmwuYWRkSXRlbShcbiAgICAgICAgaW5wdXQudHlwZSxcbiAgICAgICAgaW5wdXQuZGVzY3JpcHRpb24sXG4gICAgICAgIGlucHV0LnZhbHVlXG4gICAgICApXG5cbiAgICAgIC8vIENhbGN1bGFlIHRoZSBidWRnZXQgYW5kIHVwZGF0ZSB0aGUgVUlcbiAgICAgIFVJQ3RybC5yZW5kZXIobmV3SXRlbSwgaW5wdXQudHlwZSkgLy8gQWRkIGl0ZW1zIHRvIGluY29tZSBvciBleHBlbnNlcyBsaXN0XG4gICAgICBVSUN0cmwudXBkYXRlQnVkZ2V0KCkgLy8gT3V0cHV0IHRoZSBuZXcgYnVkZ2V0XG4gICAgICBVSUN0cmwudXBkYXRlUGVyY2VudGFnZXMoKSAvLyBPdXRwdXQgdGhlIG5ldyBwZXJjZW50YWdlc1xuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZygnZm9ybSBzdWJtaXR0ZWQhJylcbiAgICAgICAgY29uc29sZS5sb2cobmV3SXRlbSlcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coaW5jKVxuICB9KVxuICAvLyBEZWxldGUgYW4gYWRkZWQgaW5jb21lIG9yIGV4cGVuc2VcbiAgVUlDdHJsLmRlbGV0ZUl0ZW0oKVxuXG4gIHBhc3RidWRnZXQuZ2V0QnVkZ2V0KChkYXRhLCBpZCkgPT4ge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhLCBpZClcbiAgICB9XG4gIH0pXG59KShidWRnZXRDb250cm9sbGVyKVxuIiwibW9kdWxlLmV4cG9ydHMgPSBicm93c2VyOyIsImNvbnN0IGJ1ZGdldENvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICBjbGFzcyBCdWRnZXQge1xuICAgIGNvbnN0cnVjdG9yKGlkLCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICAgIHRoaXMuaWQgPSBpZFxuICAgICAgdGhpcy5kZXNjID0gZGVzY3JpcHRpb25cbiAgICAgIHRoaXMudmFsID0gdmFsdWVcbiAgICAgIHRoaXMucGVyY2VudGFnZSA9IC0xXG4gICAgfVxuXG4gICAgY2FsY1BlcmNlbnRhZ2UodG90YWxJbmNvbWUpIHtcbiAgICAgIGlmICh0b3RhbEluY29tZSA+IDApIHtcbiAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gTWF0aC5yb3VuZCgodGhpcy52YWwgLyB0b3RhbEluY29tZSkgKiAxMDApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAtMVxuICAgICAgfVxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYHRoaXMgdmFsdWUgaXMgJHt0eXBlb2YgdGhpcy52YWx9YCxcbiAgICAgICAgICBgdGhlIHRvdGFsSW5jb21lICR7dHlwZW9mIHRvdGFsSW5jb21lfWBcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIGdldFBlcmNlbnRhZ2UoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wZXJjZW50YWdlXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZGF0YSA9IHtcbiAgICBhbGxJdGVtczoge1xuICAgICAgZXhwOiBbXSxcbiAgICAgIGluYzogW10sXG4gICAgICBzYXY6IFtdLFxuICAgIH0sXG4gICAgdG90YWxzOiB7XG4gICAgICBleHA6IDAsXG4gICAgICBpbmM6IDAsXG4gICAgICBzYXY6IDAsXG4gICAgfSxcbiAgICBwZXJjZW50OiB7XG4gICAgICBleHA6IC0xLFxuICAgICAgc2F2OiAtMSxcbiAgICB9LFxuICAgIGJ1ZGdldDogMCxcbiAgfVxuXG4gIGNvbnN0IGNhbGN1bGF0ZVRvdGFscyA9ICh0eXBlKSA9PiB7XG4gICAgbGV0IHN1bSA9IDBcbiAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmZvckVhY2goKGN1cikgPT4ge1xuICAgICAgc3VtICs9IGN1ci52YWxcbiAgICB9KVxuICAgIGRhdGEudG90YWxzW3R5cGVdID0gc3VtXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZEl0ZW06ICh0eXBlLCBkZXNjLCB2YWwpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBuZXcgSURcbiAgICAgIGNvbnN0IElEID1cbiAgICAgICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggPiAwXG4gICAgICAgICAgPyBkYXRhLmFsbEl0ZW1zW3R5cGVdW2RhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoIC0gMV0uaWQgKyAxXG4gICAgICAgICAgOiAwXG5cbiAgICAgIC8vIFNldCBuZXcgaXRlbSB0byB1c2Ugb2JqZWN0XG4gICAgICBjb25zdCBuZXdJdGVtID0gbmV3IEJ1ZGdldChJRCwgZGVzYywgdmFsKVxuXG4gICAgICAvLyBQdXNoIGl0IGludG8gZGF0YSBzdHJ1Y3R1cmVcbiAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ucHVzaChuZXdJdGVtKVxuXG4gICAgICAvLyBjcmVhdGUgbmV3IGl0ZW1cbiAgICAgIHJldHVybiBuZXdJdGVtXG4gICAgfSxcbiAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpID0+IHtcbiAgICAgIC8vIDEuIENhbGN1bGF0ZSB0aGUgYnVkZ2V0XG4gICAgICBjYWxjdWxhdGVUb3RhbHMoJ2V4cCcpXG4gICAgICBjYWxjdWxhdGVUb3RhbHMoJ2luYycpXG4gICAgICBjYWxjdWxhdGVUb3RhbHMoJ3NhdicpXG5cbiAgICAgIC8vIDIuIENhbGN1bGF0ZSB0aGUgYnVkZ2V0OiBpbmNvbWUgLSBleHBlbnNlc1xuICAgICAgZGF0YS5idWRnZXQgPSBkYXRhLnRvdGFscy5pbmMgLSAoZGF0YS50b3RhbHMuZXhwICsgZGF0YS50b3RhbHMuc2F2KVxuXG4gICAgICAvLyAzLiBDYWxjdWxhdGUgdGhlIHBlcmNlbnRhZ2Ugb2YgaW5jb21lIHRoYXQgd2Ugc3BlbnRcbiAgICAgIGlmIChkYXRhLnRvdGFscy5pbmMgPiAwKSB7XG4gICAgICAgIGRhdGEucGVyY2VudC5leHAgPSBNYXRoLnJvdW5kKChkYXRhLnRvdGFscy5leHAgLyBkYXRhLnRvdGFscy5pbmMpICogMTAwKVxuICAgICAgICBkYXRhLnBlcmNlbnQuc2F2ID0gTWF0aC5yb3VuZCgoZGF0YS50b3RhbHMuc2F2IC8gZGF0YS50b3RhbHMuaW5jKSAqIDEwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRhdGEucGVyY2VudC5leHAgPSAtMVxuICAgICAgICBkYXRhLnBlcmNlbnQuc2F2ID0gLTFcbiAgICAgIH1cblxuICAgICAgLy8gMy4gUmV0dXJuIHRoZSBidWRnZXRcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEudG90YWxzLmV4cCwgZGF0YS50b3RhbHMuaW5jKVxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLmJ1ZGdldCwgZGF0YS5wZXJjZW50LmV4cCwgZGF0YS5wZXJjZW50LnNhdilcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9LFxuICAgIGNhbGN1bGF0ZVBlcmNlbnRhZ2VzOiAodHlwZSkgPT4ge1xuICAgICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgICAgY3VyLmNhbGNQZXJjZW50YWdlKGRhdGEudG90YWxzLmluYylcbiAgICAgIH0pXG4gICAgfSxcbiAgICBnZXRQZXJjZW50YWdlczogKHR5cGUpID0+IHtcbiAgICAgIGNvbnN0IGFsbFBlcmMgPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcCgoY3VyKSA9PiB7XG4gICAgICAgIHJldHVybiBjdXIuZ2V0UGVyY2VudGFnZSgpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIGFsbFBlcmNcbiAgICB9LFxuICAgIHJlbW92ZUl0ZW06ICh0eXBlLCBpZCkgPT4ge1xuICAgICAgY29uc3QgaWRzID0gZGF0YS5hbGxJdGVtc1t0eXBlXS5tYXAoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuaWRcbiAgICAgIH0pXG4gICAgICBjb25zdCBpbmRleCA9IGlkcy5pbmRleE9mKGlkKVxuXG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKVxuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0RGF0YTogKCkgPT4ge1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9LFxuICB9XG59KSgpXG5cbmV4cG9ydCBkZWZhdWx0IGJ1ZGdldENvbnRyb2xsZXJcbiJdLCJzb3VyY2VSb290IjoiIn0=