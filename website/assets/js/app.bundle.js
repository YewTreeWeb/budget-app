(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,o=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],a=c.length,s=window.console=window.console||{};a--;)s[n=c[a]]||(s[n]=o);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var l=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?l.classList.add("is-mobile"):(t.on(">medium",(function(){l.classList.remove("is-mobile"),l.classList.add("is-desktop")})),t.on("<=medium",(function(){l.classList.remove("is-desktop"),l.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var o=n("lwsE"),c=n.n(o),a=n("W8MJ"),s=n.n(a),l=n("xVb/"),i=function(){function e(t,n,o){c()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=o}return s()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"formatNumber",value:function(e,t){var n=Math.abs(e);(n=n.toFixed(2)).split(".")}},{key:"render",value:function(e,t){var n,o="exp"===t?"expenses":"income",c=document.querySelector(".".concat(o,"__list"));n="\n    <li class='".concat(o,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p><span>&pound;</span>").concat(e.val,"</p></div>\n    "),"exp"===t&&(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',c.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,percent:e.percent}}},{key:"displayBudget",value:function(e){var t="exp"===(e.budget>0?"inc":"exp")?"expenses":"income",n=document.querySelector(".budget__value .budget"),o=document.querySelector(".budget__income .budget__amount .amount"),c=document.querySelector(".budget__expenses .budget__amount .amount");n.textContent=e.budget,o.textContent=e.totalInc,c.textContent=e.totalExp,console.log("The ".concat(t," is/are ").concat(e.budget)),console.log(o,c)}},{key:"displayPercentage",value:function(e){var t=document.querySelector(".percentage");e>0?(t.classList.add("show"),t.innerHTML="".concat(e,"&#37;")):t.classList.remove("show"),console.log(t)}},{key:"updateBudget",value:function(){var e=l.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percent)}},{key:"displayPercentages",value:function(e){!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".items__percent"),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){l.default.calculatePercentages();var e=l.default.getPercentages();this.displayPercentages(e)}},{key:"updateDate",value:function(){var e=document.querySelector(".budget__month"),t=dayjs("MMMM YYYY");e.textContent=t}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,o=n.id.split("-"),c=o[0],a=Number(o[1]);console.log(t.target,n,o,c,a),l.default.removeItem(c,a),n.remove(),e.updateBudget(),e.updatePercentages()}}))}}]),e}();t.default=i},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var o=n("cDf5"),c=n.n(o),a=(n("OuUZ"),n("E4hX"),n("xVb/")),s=n("SEKM"),l=document.querySelector("body");window.onload=function(){window.setTimeout((function(){l.classList.remove("is-loading")}),100)};var i,u,r,d,p,m,g;i=a.default,u=document.querySelector(".add__form"),r=document.querySelector(".add__type"),d=document.querySelector(".add__description"),p=document.querySelector(".add__value"),m=document.querySelector("#check"),g=new s.default(r,d,p),r.addEventListener("change",(function(e){var t=Array.from(r.options);console.log(e),console.log(r.attributes,r.options,r.options.selectedIndex,t,t[1]),1===r.options.selectedIndex?(m.classList.add(r.value),t[0].removeAttribute("selected","selected"),t[1].setAttribute("selected","selected")):(t[1].removeAttribute("selected","selected"),t[0].setAttribute("selected","selected"),m.classList.remove("exp"))})),u.addEventListener("submit",(function(e){e.preventDefault();var t=g.getInput();if(console.log(t),console.log(c()(t.value)),u.reset(),""!==t.desc&&!isNaN(t.value)&&t.value>0){var n=i.addItem(t.type,t.description,t.value);g.render(n,t.type),g.updateBudget(),g.updatePercentages(),console.log("form submitted!"),console.log(n)}})),g.deleteItem()},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var o,c,a,s=n("cDf5"),l=n.n(s),i=n("lwsE"),u=n.n(i),r=n("W8MJ"),d=n.n(r),p=(o=function(){function e(t,n,o){u()(this,e),this.id=t,this.desc=n,this.val=o,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(l()(this.val)),"the totalIncome ".concat(l()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),c={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0},a=function(e){var t=0;c.allItems[e].forEach((function(e){t+=e.val})),c.totals[e]=t},{addItem:function(e,t,n){var a=c.allItems[e].length>0?c.allItems[e][c.allItems[e].length-1].id+1:0,s=new o(a,t,n);return c.allItems[e].push(s),s},calculateBudget:function(){return a("exp"),a("inc"),c.budget=c.totals.inc-c.totals.exp,c.totals.inc>0?c.percent=Math.round(c.totals.exp/c.totals.inc*100):c.percent=-1,console.log(c.totals.exp,c.totals.inc),console.log(c.budget,c.percent),c},calculatePercentages:function(){c.allItems.exp.forEach((function(e){e.calcPercentage(c.totals.inc)}))},getPercentages:function(){return c.allItems.exp.map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=c.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&c.allItems[e].splice(n,1)}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy91aWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJlYWtwb2ludHNcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9hcHAuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYnJvd3NlclwiIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvYnVkZ2V0Y29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJtZXRob2QiLCJub29wIiwibWV0aG9kcyIsImxlbmd0aCIsImNvbnNvbGUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRmlyc3RUYWIiLCJlIiwia2V5Q29kZSIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiYnJvd3NlciIsIm5hbWUiLCJicmVha3BvaW50cyIsInhsYXJnZSIsImxhcmdlIiwibWVkaXVtIiwic21hbGwiLCJ4c21hbGwiLCJtb2JpbGUiLCJvbiIsInJlbW92ZSIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJsb2ciLCJVSUNvbnRyb2xsZXIiLCJjb3N0IiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsInRoaXMiLCJpbnB1dFR5cGUiLCJpbnB1dERlc2MiLCJpbnB1dFZhbCIsInR5cGUiLCJOdW1iZXIiLCJudW1iZXIiLCJudW0iLCJNYXRoIiwiYWJzIiwidG9GaXhlZCIsInNwbGl0Iiwib2JqIiwiaHRtbCIsIml0ZW0iLCJsaXN0IiwiaWQiLCJkZXNjIiwidmFsIiwiaW5uZXJIVE1MIiwiZGF0YSIsImJ1ZGdldCIsInRvdGFsSW5jIiwidG90YWxzIiwiaW5jIiwidG90YWxFeHAiLCJleHAiLCJwZXJjZW50IiwidHlwZXMiLCJ0ZXh0Q29udGVudCIsInBlcmNlbnRhZ2UiLCJnZXREYXRhIiwiYnVkZ2V0Q29udHJvbGxlciIsImNhbGN1bGF0ZUJ1ZGdldCIsIm5ld0J1ZGdldCIsImdldEJ1ZGdldCIsImRpc3BsYXlCdWRnZXQiLCJkaXNwbGF5UGVyY2VudGFnZSIsInBlcmNlbnRhZ2VzIiwiY2IiLCJpIiwibm9kZUxpc3RGb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnQiLCJpbmRleCIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwiZ2V0UGVyY2VudGFnZXMiLCJkaXNwbGF5UGVyY2VudGFnZXMiLCJidWRnZXREYXRlIiwiZGF0ZSIsImRheWpzIiwidGFyZ2V0IiwiY2xvc2VzdCIsInBhcmVudEVsZW1lbnQiLCJzcGxpdElEIiwiSUQiLCJyZW1vdmVJdGVtIiwidXBkYXRlQnVkZ2V0IiwidXBkYXRlUGVyY2VudGFnZXMiLCJtb2R1bGUiLCJleHBvcnRzIiwib25sb2FkIiwic2V0VGltZW91dCIsImJ1ZGdldEN0cmwiLCJmb3JtIiwiY2hlY2siLCJVSUN0cmwiLCJvcHRpb25zIiwiQXJyYXkiLCJmcm9tIiwiYXR0cmlidXRlcyIsInNlbGVjdGVkSW5kZXgiLCJyZW1vdmVBdHRyaWJ1dGUiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0IiwiZ2V0SW5wdXQiLCJyZXNldCIsImlzTmFOIiwibmV3SXRlbSIsImFkZEl0ZW0iLCJyZW5kZXIiLCJkZWxldGVJdGVtIiwiQnVkZ2V0IiwiY2FsY3VsYXRlVG90YWxzIiwidG90YWxJbmNvbWUiLCJyb3VuZCIsImFsbEl0ZW1zIiwic3VtIiwiZm9yRWFjaCIsImN1ciIsInB1c2giLCJjYWxjUGVyY2VudGFnZSIsIm1hcCIsImdldFBlcmNlbnRhZ2UiLCJpbmRleE9mIiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiNElBQUEsY0FxQ0UsSUEvQkEsSUFBSUEsRUFDRUMsRUFBTyxhQUNQQyxFQUFVLENBQ2QsU0FDQSxRQUNBLFFBQ0EsUUFDQSxNQUNBLFNBQ0EsUUFDQSxZQUNBLFFBQ0EsaUJBQ0EsV0FDQSxPQUNBLE1BQ0EsZUFDQSxVQUNBLGFBQ0EsUUFDQSxPQUNBLFVBQ0EsV0FDQSxjQUNBLFlBQ0EsUUFDQSxRQUVJQyxFQUFXRCxFQUFYQyxPQUNBQyxFQUFXQyxPQUFPRCxRQUFVQyxPQUFPRCxTQUFXLEdBRTdDRCxLQUlBQyxFQUhMSixFQUFTRSxFQUFRQyxNQUlmQyxFQUFRSixHQUFVQyxHQWN4QkksT0FBT0MsaUJBQWlCLFdBUkQsU0FBakJDLEVBQWtCQyxHQUNKLElBQWRBLEVBQUVDLFVBRUpDLFNBQVNDLEtBQUtDLFVBQVVDLElBQUksbUJBQzVCUixPQUFPUyxvQkFBb0IsVUFBV1AsT0FPN0JHLFNBQVNLLGNBQWMsUUFDL0JDLGFBQWEsZUFBZ0JDLEVBQVFDLE1BRzFDLElBQU1QLEVBQU9ELFNBQVNLLGNBQWMsUUFFcENJLEVBQVksQ0FDVkMsT0FBUSxDQUFDLFNBQVUsVUFDbkJDLE1BQU8sQ0FBQyxRQUFTLFVBQ2pCQyxPQUFRLENBQUMsUUFBUyxTQUNsQkMsTUFBTyxDQUFDLFFBQVMsU0FDakJDLE9BQVEsQ0FBQyxLQUFNLFdBR2JQLEVBQVFRLE9BQ1ZkLEVBQUtDLFVBQVVDLElBQUksY0FFbkJNLEVBQVlPLEdBQUcsV0FBVyxXQUN4QmYsRUFBS0MsVUFBVWUsT0FBTyxhQUN0QmhCLEVBQUtDLFVBQVVDLElBQUksaUJBRXJCTSxFQUFZTyxHQUFHLFlBQVksV0FDekJmLEVBQUtDLFVBQVVlLE9BQU8sY0FDdEJoQixFQUFLQyxVQUFVQyxJQUFJLGlCQU1RLGNBQTdCUixPQUFPdUIsU0FBU0MsVUFHaEJ6QixRQUFRMEIsSUFBSSx5QixtSUN2RlJDLEUsV0FDSixXQUFZQyxFQUFNQyxFQUFhQyxHQUFPLFlBQ3BDQyxLQUFLQyxVQUFZSixFQUNqQkcsS0FBS0UsVUFBWUosRUFDakJFLEtBQUtHLFNBQVdKLEUsK0NBSWhCLE1BQU8sQ0FDTEssS0FBTUosS0FBS0MsVUFBVUYsTUFDckJELFlBQWFFLEtBQUtFLFVBQVVILE1BQzVCQSxNQUFPTSxPQUFPTCxLQUFLRyxTQUFTSixVLG1DQUluQk8sRUFBUUYsR0FRbkIsSUFBSUcsRUFBTUMsS0FBS0MsSUFBSUgsSUFDbkJDLEVBQU1BLEVBQUlHLFFBQVEsSUFFR0MsTUFBTSxPLDZCQUl0QkMsRUFBS1IsR0FDVixJQUVJUyxFQUZFQyxFQUFnQixRQUFUVixFQUFpQixXQUFhLFNBQ3JDVyxFQUFPeEMsU0FBU0ssY0FBVCxXQUEyQmtDLEVBQTNCLFdBSWJELEVBQU8sb0JBQUgsT0FDU0MsRUFEVCx1QkFDNEJWLEVBRDVCLFlBQ29DUSxFQUFJSSxHQUR4QywrQ0FFMEJKLEVBQUlLLEtBRjlCLDZHQUltREwsRUFBSU0sSUFKdkQsb0JBT1MsUUFBVGQsSUFDRlMsR0FBUSxtREFHVkEsR0FBUSw0UkFXUkUsRUFBS0ksV0FBYU4sSSxnQ0FHVk8sR0FDUixNQUFPLENBQ0xDLE9BQVFELEVBQUtDLE9BQ2JDLFNBQVVGLEVBQUtHLE9BQU9DLElBQ3RCQyxTQUFVTCxFQUFLRyxPQUFPRyxJQUN0QkMsUUFBU1AsRUFBS08sVyxvQ0FJSmYsR0FDWixJQUNNZ0IsRUFBaUIsU0FEVmhCLEVBQUlTLE9BQVMsRUFBSSxNQUFRLE9BQ1AsV0FBYSxTQUN0Q0EsRUFBUzlDLFNBQVNLLGNBQWMsMEJBQ2hDNEMsRUFBTWpELFNBQVNLLGNBQVQsMkNBR044QyxFQUFNbkQsU0FBU0ssY0FBVCw2Q0FJWnlDLEVBQU9RLFlBQWNqQixFQUFJUyxPQUN6QkcsRUFBSUssWUFBY2pCLEVBQUlVLFNBQ3RCSSxFQUFJRyxZQUFjakIsRUFBSWEsU0FHcEJ4RCxRQUFRMEIsSUFBUixjQUFtQmlDLEVBQW5CLG1CQUFtQ2hCLEVBQUlTLFNBQ3ZDcEQsUUFBUTBCLElBQUk2QixFQUFLRSxLLHdDQUlISSxHQUNoQixJQUFNSCxFQUFVcEQsU0FBU0ssY0FBYyxlQUVuQ2tELEVBQWEsR0FDZkgsRUFBUWxELFVBQVVDLElBQUksUUFDdEJpRCxFQUFRUixVQUFSLFVBQXVCVyxFQUF2QixVQUVBSCxFQUFRbEQsVUFBVWUsT0FBTyxRQUl6QnZCLFFBQVEwQixJQUFJZ0MsSyxxQ0FNZCxJQUFNSSxFQUFVQyxVQUFpQkMsa0JBRzNCQyxFQUFZbEMsS0FBS21DLFVBQVVKLEdBRy9COUQsUUFBUTBCLElBQUl1QyxHQUlkbEMsS0FBS29DLGNBQWNGLEdBR25CbEMsS0FBS3FDLGtCQUFrQkgsRUFBVVAsVyx5Q0FHaEJXLElBRU8sU0FBQ3ZCLEVBQU13QixHQUM3QixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSXpCLEVBQUsvQyxPQUFRd0UsSUFDL0JELEVBQUd4QixFQUFLeUIsR0FBSUEsR0FHaEJDLENBTmVsRSxTQUFTbUUsaUJBQWlCLG9CQU1qQixTQUFDQyxFQUFTQyxHQUM1Qk4sRUFBWU0sR0FBUyxHQUN2QkQsRUFBUWxFLFVBQVVDLElBQUksUUFDdEJpRSxFQUFReEIsVUFBUixVQUF1Qm1CLEVBQVlNLEdBQW5DLFdBRUFELEVBQVFsRSxVQUFVZSxPQUFPLFFBQ3pCbUQsRUFBUXhCLFVBQVksZSwwQ0FPeEJhLFVBQWlCYSx1QkFHakIsSUFBTVAsRUFBY04sVUFBaUJjLGlCQUdyQzlDLEtBQUsrQyxtQkFBbUJULEssbUNBSXhCLElBQU1VLEVBQWF6RSxTQUFTSyxjQUFjLGtCQUNwQ3FFLEVBQU9DLE1BQU0sYUFDbkJGLEVBQVduQixZQUFjb0IsSSxtQ0FHZCxXQUNFMUUsU0FBU0ssY0FBYyxvQkFDL0JULGlCQUFpQixTQUFTLFNBQUNFLEdBQzlCLEdBQW9CLFdBQWhCQSxFQUFFOEUsT0FBT25DLEdBQWlCLENBQzVCLElBQU1tQyxFQUFTOUUsRUFBRThFLE9BQU9DLFFBQVEsVUFBVUMsY0FDcENDLEVBQVVILEVBQU9uQyxHQUFHTCxNQUFNLEtBQzFCUCxFQUFPa0QsRUFBUSxHQUNmQyxFQUFLbEQsT0FBT2lELEVBQVEsSUFHeEJyRixRQUFRMEIsSUFBSXRCLEVBQUU4RSxPQUFRQSxFQUFRRyxFQUFTbEQsRUFBTW1ELEdBSS9DdkIsVUFBaUJ3QixXQUFXcEQsRUFBTW1ELEdBR2xDSixFQUFPM0QsU0FHUCxFQUFLaUUsZUFHTCxFQUFLQyw0QixLQU1FOUQsYSxtQkNoTWYrRCxFQUFPQyxRQUFVNUUsYSxnSENZWFIsRUFBT0QsU0FBU0ssY0FBYyxRQUVwQ1YsT0FBTzJGLE9BQVMsV0FDZDNGLE9BQU80RixZQUFXLFdBQ2hCdEYsRUFBS0MsVUFBVWUsT0FBTyxnQkFDckIsTUFLTCxJQUFxQnVFLEVBQ2JDLEVBQ0E1RCxFQUNBYSxFQUNBbEIsRUFDQWtFLEVBRUFDLEVBUGFILEVBcUVsQi9CLFVBcEVLZ0MsRUFBT3pGLFNBQVNLLGNBQWMsY0FDOUJ3QixFQUFPN0IsU0FBU0ssY0FBYyxjQUM5QnFDLEVBQU8xQyxTQUFTSyxjQUFjLHFCQUM5Qm1CLEVBQVF4QixTQUFTSyxjQUFjLGVBQy9CcUYsRUFBUTFGLFNBQVNLLGNBQWMsVUFFL0JzRixFQUFTLElBQUl0RSxVQUFhUSxFQUFNYSxFQUFNbEIsR0FHNUNLLEVBQUtqQyxpQkFBaUIsVUFBVSxTQUFDRSxHQUMvQixJQUFNOEYsRUFBVUMsTUFBTUMsS0FBS2pFLEVBQUsrRCxTQUU5QmxHLFFBQVEwQixJQUFJdEIsR0FDWkosUUFBUTBCLElBQ05TLEVBQUtrRSxXQUNMbEUsRUFBSytELFFBQ0wvRCxFQUFLK0QsUUFBUUksY0FDYkosRUFDQUEsRUFBUSxJQUd1QixJQUEvQi9ELEVBQUsrRCxRQUFRSSxlQUNmTixFQUFNeEYsVUFBVUMsSUFBSTBCLEVBQUtMLE9BQ3pCb0UsRUFBUSxHQUFHSyxnQkFBZ0IsV0FBWSxZQUN2Q0wsRUFBUSxHQUFHdEYsYUFBYSxXQUFZLGNBRXBDc0YsRUFBUSxHQUFHSyxnQkFBZ0IsV0FBWSxZQUN2Q0wsRUFBUSxHQUFHdEYsYUFBYSxXQUFZLFlBQ3BDb0YsRUFBTXhGLFVBQVVlLE9BQU8sV0FJM0J3RSxFQUFLN0YsaUJBQWlCLFVBQVUsU0FBQ0UsR0FDL0JBLEVBQUVvRyxpQkFHRixJQUFNQyxFQUFRUixFQUFPUyxXQVVyQixHQVJFMUcsUUFBUTBCLElBQUkrRSxHQUNaekcsUUFBUTBCLElBQVIsSUFBbUIrRSxFQUFNM0UsUUFJM0JpRSxFQUFLWSxRQUdjLEtBQWZGLEVBQU16RCxPQUFnQjRELE1BQU1ILEVBQU0zRSxRQUFVMkUsRUFBTTNFLE1BQVEsRUFBRyxDQUUvRCxJQUFNK0UsRUFBVWYsRUFBV2dCLFFBQ3pCTCxFQUFNdEUsS0FDTnNFLEVBQU01RSxZQUNONEUsRUFBTTNFLE9BSVJtRSxFQUFPYyxPQUFPRixFQUFTSixFQUFNdEUsTUFDN0I4RCxFQUFPVCxlQUNQUyxFQUFPUixvQkFHTHpGLFFBQVEwQixJQUFJLG1CQUNaMUIsUUFBUTBCLElBQUltRixPQU1sQlosRUFBT2UsYyxtQkMxRlR0QixFQUFPQyxRQUFVOUUsUywrQ0NDVG9HLEVBMkJBOUQsRUFZQStELEUsK0RBeENGbkQsR0FDRWtELEVBRHdCLFdBRTVCLFdBQVlsRSxFQUFJbEIsRUFBYUMsR0FBTyxZQUNsQ0MsS0FBS2dCLEdBQUtBLEVBQ1ZoQixLQUFLaUIsS0FBT25CLEVBQ1pFLEtBQUtrQixJQUFNbkIsRUFDWEMsS0FBSzhCLFlBQWMsRUFOTyxtREFTYnNELEdBRVhwRixLQUFLOEIsV0FESHNELEVBQWMsRUFDRTVFLEtBQUs2RSxNQUFPckYsS0FBS2tCLElBQU1rRSxFQUFlLE1BRXJDLEVBR25CbkgsUUFBUTBCLElBQVIsNEJBQzBCSyxLQUFLa0IsTUFEL0IsOEJBRTRCa0UsT0FsQkosc0NBd0IxQixPQUFPcEYsS0FBSzhCLGVBeEJjLEtBNEJ4QlYsRUFBTyxDQUNYa0UsU0FBVSxDQUNSNUQsSUFBSyxHQUNMRixJQUFLLElBRVBELE9BQVEsQ0FDTkcsSUFBSyxFQUNMRixJQUFLLEdBRVBILE9BQVEsR0FHSjhELEVBQWtCLFNBQUMvRSxHQUN2QixJQUFJbUYsRUFBTSxFQUNWbkUsRUFBS2tFLFNBQVNsRixHQUFNb0YsU0FBUSxTQUFDQyxHQUMzQkYsR0FBT0UsRUFBSXZFLE9BRWJFLEVBQUtHLE9BQU9uQixHQUFRbUYsR0FHZixDQUNMUixRQUFTLFNBQUMzRSxFQUFNYSxFQUFNQyxHQUVwQixJQUFNcUMsRUFDSm5DLEVBQUtrRSxTQUFTbEYsR0FBTXBDLE9BQVMsRUFDekJvRCxFQUFLa0UsU0FBU2xGLEdBQU1nQixFQUFLa0UsU0FBU2xGLEdBQU1wQyxPQUFTLEdBQUdnRCxHQUFLLEVBQ3pELEVBR0E4RCxFQUFVLElBQUlJLEVBQU8zQixFQUFJdEMsRUFBTUMsR0FNckMsT0FIQUUsRUFBS2tFLFNBQVNsRixHQUFNc0YsS0FBS1osR0FHbEJBLEdBRVQ3QyxnQkFBaUIsV0FxQmYsT0FuQkFrRCxFQUFnQixPQUNoQkEsRUFBZ0IsT0FHaEIvRCxFQUFLQyxPQUFTRCxFQUFLRyxPQUFPQyxJQUFNSixFQUFLRyxPQUFPRyxJQUd4Q04sRUFBS0csT0FBT0MsSUFBTSxFQUNwQkosRUFBS08sUUFBVW5CLEtBQUs2RSxNQUFPakUsRUFBS0csT0FBT0csSUFBTU4sRUFBS0csT0FBT0MsSUFBTyxLQUVoRUosRUFBS08sU0FBVyxFQUtoQjFELFFBQVEwQixJQUFJeUIsRUFBS0csT0FBT0csSUFBS04sRUFBS0csT0FBT0MsS0FDekN2RCxRQUFRMEIsSUFBSXlCLEVBQUtDLE9BQVFELEVBQUtPLFNBR3pCUCxHQUVUeUIscUJBQXNCLFdBQ3BCekIsRUFBS2tFLFNBQVM1RCxJQUFJOEQsU0FBUSxTQUFDQyxHQUN6QkEsRUFBSUUsZUFBZXZFLEVBQUtHLE9BQU9DLFNBR25Dc0IsZUFBZ0IsV0FJZCxPQUhnQjFCLEVBQUtrRSxTQUFTNUQsSUFBSWtFLEtBQUksU0FBQ0gsR0FDckMsT0FBT0EsRUFBSUksb0JBSWZyQyxXQUFZLFNBQUNwRCxFQUFNWSxHQUNqQixJQUdNNEIsRUFITXhCLEVBQUtrRSxTQUFTbEYsR0FBTXdGLEtBQUksU0FBQ2pELEdBQ25DLE9BQU9BLEVBQVEzQixNQUVDOEUsUUFBUTlFLElBRVgsSUFBWDRCLEdBQ0Z4QixFQUFLa0UsU0FBU2xGLEdBQU0yRixPQUFPbkQsRUFBTyxNQU0zQlosYyIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXBsdXNwbHVzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1tdWx0aS1hc3NpZ24gKi9cblxuLy8gQXZvaWQgYGNvbnNvbGVgIGVycm9ycyBpbiBicm93c2VycyB0aGF0IGxhY2sgYSBjb25zb2xlLlxue1xuICBsZXQgbWV0aG9kXG4gIGNvbnN0IG5vb3AgPSAoKSA9PiB7fVxuICBjb25zdCBtZXRob2RzID0gW1xuICAgICdhc3NlcnQnLFxuICAgICdjbGVhcicsXG4gICAgJ2NvdW50JyxcbiAgICAnZGVidWcnLFxuICAgICdkaXInLFxuICAgICdkaXJ4bWwnLFxuICAgICdlcnJvcicsXG4gICAgJ2V4Y2VwdGlvbicsXG4gICAgJ2dyb3VwJyxcbiAgICAnZ3JvdXBDb2xsYXBzZWQnLFxuICAgICdncm91cEVuZCcsXG4gICAgJ2luZm8nLFxuICAgICdsb2cnLFxuICAgICdtYXJrVGltZWxpbmUnLFxuICAgICdwcm9maWxlJyxcbiAgICAncHJvZmlsZUVuZCcsXG4gICAgJ3RhYmxlJyxcbiAgICAndGltZScsXG4gICAgJ3RpbWVFbmQnLFxuICAgICd0aW1lbGluZScsXG4gICAgJ3RpbWVsaW5lRW5kJyxcbiAgICAndGltZVN0YW1wJyxcbiAgICAndHJhY2UnLFxuICAgICd3YXJuJyxcbiAgXVxuICBsZXQgeyBsZW5ndGggfSA9IG1ldGhvZHNcbiAgY29uc3QgY29uc29sZSA9ICh3aW5kb3cuY29uc29sZSA9IHdpbmRvdy5jb25zb2xlIHx8IHt9KVxuXG4gIHdoaWxlIChsZW5ndGgtLSkge1xuICAgIG1ldGhvZCA9IG1ldGhvZHNbbGVuZ3RoXVxuXG4gICAgLy8gT25seSBzdHViIHVuZGVmaW5lZCBtZXRob2RzLlxuICAgIGlmICghY29uc29sZVttZXRob2RdKSB7XG4gICAgICBjb25zb2xlW21ldGhvZF0gPSBub29wXG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCB0YWJiaW5nIGluZGljYXRvciB0byB3aW5kb3dcbmNvbnN0IGhhbmRsZUZpcnN0VGFiID0gKGUpID0+IHtcbiAgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgIC8vIHRoZSBcIkkgYW0gYSBrZXlib2FyZCB1c2VyXCIga2V5XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCd1c2VyLWlzLXRhYmJpbmcnKVxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlRmlyc3RUYWIpXG4gIH1cbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVGaXJzdFRhYilcblxuLy8gQWRkIGEgYnJvd2VyIGluZGljYXRvciB0byB0aGUgSFRNTCBlbGVtZW50LlxuY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKVxuaHRtbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYnJvd3NlcicsIGJyb3dzZXIubmFtZSlcblxuLy8gRGV0ZWN0IGlmIG1vYmlsZSBvciBkZXNrdG9wLlxuY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG5icmVha3BvaW50cyh7XG4gIHhsYXJnZTogWycxMjgxcHgnLCAnMTY4MHB4J10sXG4gIGxhcmdlOiBbJzk4MXB4JywgJzEyODBweCddLFxuICBtZWRpdW06IFsnNzM3cHgnLCAnOTgwcHgnXSxcbiAgc21hbGw6IFsnNDgxcHgnLCAnNzM2cHgnXSxcbiAgeHNtYWxsOiBbbnVsbCwgJzQ4MHB4J10sXG59KVxuXG5pZiAoYnJvd3Nlci5tb2JpbGUpIHtcbiAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1tb2JpbGUnKVxufSBlbHNlIHtcbiAgYnJlYWtwb2ludHMub24oJz5tZWRpdW0nLCAoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1tb2JpbGUnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtZGVza3RvcCcpXG4gIH0pXG4gIGJyZWFrcG9pbnRzLm9uKCc8PW1lZGl1bScsICgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRlc2t0b3AnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbW9iaWxlJylcbiAgfSlcbn1cblxuLy8gTG9nIGlmIHJ1bm5pbmcgaW4gbG9jYWxob3N0IHdoZW4gaW4gZGV2ZWxvcG1lbnQgbW9kZS5cbmlmIChcbiAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyAmJlxuICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nXG4pIHtcbiAgY29uc29sZS5sb2coJ2xvY2FsaG9zdCBkZXRlY3RlZCEnKVxufVxuIiwiLyogZXNsaW50LWRpc2FibGUgY2xhc3MtbWV0aG9kcy11c2UtdGhpcyAqL1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9idWRnZXRjb250cm9sbGVyJ1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItZGVzdHJ1Y3R1cmluZyAqL1xuY2xhc3MgVUlDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoY29zdCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgdGhpcy5pbnB1dFR5cGUgPSBjb3N0XG4gICAgdGhpcy5pbnB1dERlc2MgPSBkZXNjcmlwdGlvblxuICAgIHRoaXMuaW5wdXRWYWwgPSB2YWx1ZVxuICB9XG5cbiAgZ2V0SW5wdXQoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IHRoaXMuaW5wdXRUeXBlLnZhbHVlLCAvLyBXaWxsIGJlIGVpdGhlciBpbmMgb3IgZXhwXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5pbnB1dERlc2MudmFsdWUsXG4gICAgICB2YWx1ZTogTnVtYmVyKHRoaXMuaW5wdXRWYWwudmFsdWUpLFxuICAgIH1cbiAgfVxuXG4gIGZvcm1hdE51bWJlcihudW1iZXIsIHR5cGUpIHtcbiAgICAvKipcbiAgICAgKiArIG9yIC0gYmVmb3JlIHRoZSBudW1iZXJcbiAgICAgKiBleGFjdGx5IDIgZGVjaW1hbCBwb2ludHNcbiAgICAgKiBjb21tYSBzZXBlcmF0aW5nIHRoZSB0aG91c2FuZHNcbiAgICAgKlxuICAgICAqIDIzMTAuNDU2NyA9ICsgMiwzMTAuNDZcbiAgICAgKi9cbiAgICBsZXQgbnVtID0gTWF0aC5hYnMobnVtYmVyKVxuICAgIG51bSA9IG51bS50b0ZpeGVkKDIpXG5cbiAgICBjb25zdCBudW1TcGxpdCA9IG51bS5zcGxpdCgnLicpXG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICByZW5kZXIob2JqLCB0eXBlKSB7XG4gICAgY29uc3QgaXRlbSA9IHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6ICdpbmNvbWUnXG4gICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2l0ZW19X19saXN0YClcbiAgICBsZXQgaHRtbFxuXG4gICAgLy8gQ3JlYXRlIEhUTUwgc3RyaW5nIHdpdGggcGxhY2Vob2xkZXJcbiAgICBodG1sID0gYFxuICAgIDxsaSBjbGFzcz0nJHtpdGVtfV9faXRlbScgaWQ9JyR7dHlwZX0tJHtvYmouaWR9Jz5cbiAgICAgIDxkaXYgY2xhc3M9J2l0ZW0tZGVzYyc+PHA+JHtvYmouZGVzY308L3A+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiaXRlbXNcIj5cbiAgICAgICAgPGRpdiBjbGFzcz0naXRlbXNfX3ZhbHVlJz48cD48c3Bhbj4mcG91bmQ7PC9zcGFuPiR7b2JqLnZhbH08L3A+PC9kaXY+XG4gICAgYFxuXG4gICAgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiaXRlbXNfX3BlcmNlbnRcIj48cD4wJiMzNzs8L3A+PC9kaXY+J1xuICAgIH1cblxuICAgIGh0bWwgKz0gYFxuICAgICAgICA8YnV0dG9uIGNsYXNzPSdidG4gYnRuLS1jbGVhciBpdGVtc19fZGVsJz5cbiAgICAgICAgICA8c3ZnIGlkPVwiZGVsZXRlXCIgY2xhc3M9XCJpY29uXCIgd2lkdGg9XCIyMFwiIGhlaWdodD1cIjIwXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9XCIvYXNzZXRzL2ltYWdlcy9pY29ucy5zdmcjaWNvbi1kZWxldGVcIj48L3VzZT5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2xpPlxuICAgIGBcblxuICAgIC8vIEluc2VydCBIVE1MIGludG8gdGhlIERPTVxuICAgIGxpc3QuaW5uZXJIVE1MICs9IGh0bWxcbiAgfVxuXG4gIGdldEJ1ZGdldChkYXRhKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1ZGdldDogZGF0YS5idWRnZXQsXG4gICAgICB0b3RhbEluYzogZGF0YS50b3RhbHMuaW5jLFxuICAgICAgdG90YWxFeHA6IGRhdGEudG90YWxzLmV4cCxcbiAgICAgIHBlcmNlbnQ6IGRhdGEucGVyY2VudCxcbiAgICB9XG4gIH1cblxuICBkaXNwbGF5QnVkZ2V0KG9iaikge1xuICAgIGNvbnN0IHR5cGUgPSBvYmouYnVkZ2V0ID4gMCA/ICdpbmMnIDogJ2V4cCdcbiAgICBjb25zdCB0eXBlcyA9IHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6ICdpbmNvbWUnXG4gICAgY29uc3QgYnVkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1ZGdldF9fdmFsdWUgLmJ1ZGdldCcpXG4gICAgY29uc3QgaW5jID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuYnVkZ2V0X19pbmNvbWUgLmJ1ZGdldF9fYW1vdW50IC5hbW91bnRgXG4gICAgKVxuICAgIGNvbnN0IGV4cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmJ1ZGdldF9fZXhwZW5zZXMgLmJ1ZGdldF9fYW1vdW50IC5hbW91bnRgXG4gICAgKVxuXG4gICAgYnVkZ2V0LnRleHRDb250ZW50ID0gb2JqLmJ1ZGdldFxuICAgIGluYy50ZXh0Q29udGVudCA9IG9iai50b3RhbEluY1xuICAgIGV4cC50ZXh0Q29udGVudCA9IG9iai50b3RhbEV4cFxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBUaGUgJHt0eXBlc30gaXMvYXJlICR7b2JqLmJ1ZGdldH1gKVxuICAgICAgY29uc29sZS5sb2coaW5jLCBleHApXG4gICAgfVxuICB9XG5cbiAgZGlzcGxheVBlcmNlbnRhZ2UocGVyY2VudGFnZSkge1xuICAgIGNvbnN0IHBlcmNlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyY2VudGFnZScpXG5cbiAgICBpZiAocGVyY2VudGFnZSA+IDApIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpXG4gICAgICBwZXJjZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2V9JiMzNztgXG4gICAgfSBlbHNlIHtcbiAgICAgIHBlcmNlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgfVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKHBlcmNlbnQpXG4gICAgfVxuICB9XG5cbiAgdXBkYXRlQnVkZ2V0KCkge1xuICAgIC8vIDEuIENoZWNrIGxvY2FsU3RvcmFnZSBmb3Igc2F2ZSBidWRnZXQgZGF0YSwgZWxzZSBnZXQgbmV3IGRhdGFcbiAgICBjb25zdCBnZXREYXRhID0gYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVCdWRnZXQoKVxuXG4gICAgLy8gMi4gUmV0dXJuIHRoZSBidWRnZXRcbiAgICBjb25zdCBuZXdCdWRnZXQgPSB0aGlzLmdldEJ1ZGdldChnZXREYXRhKVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKG5ld0J1ZGdldClcbiAgICB9XG5cbiAgICAvLyAzLiBEaXNwbGF5IHRoZSB1cGRhdGVkIGJ1ZGdldFxuICAgIHRoaXMuZGlzcGxheUJ1ZGdldChuZXdCdWRnZXQpXG5cbiAgICAvLyA0LiBEaXNwbGF5IHRoZSBuZXcgb3ZlcmFsbCBidWRnZXQgcGVyY2VudGFnZVxuICAgIHRoaXMuZGlzcGxheVBlcmNlbnRhZ2UobmV3QnVkZ2V0LnBlcmNlbnQpXG4gIH1cblxuICBkaXNwbGF5UGVyY2VudGFnZXMocGVyY2VudGFnZXMpIHtcbiAgICBjb25zdCBmaWVsZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbXNfX3BlcmNlbnQnKVxuICAgIGNvbnN0IG5vZGVMaXN0Rm9yRWFjaCA9IChsaXN0LCBjYikgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNiKGxpc3RbaV0sIGkpXG4gICAgICB9XG4gICAgfVxuICAgIG5vZGVMaXN0Rm9yRWFjaChmaWVsZHMsIChjdXJyZW50LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHBlcmNlbnRhZ2VzW2luZGV4XSA+IDApIHtcbiAgICAgICAgY3VycmVudC5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICAgICAgY3VycmVudC5pbm5lckhUTUwgPSBgJHtwZXJjZW50YWdlc1tpbmRleF19JiMzNztgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9ICcwJiMzNzsnXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHVwZGF0ZVBlcmNlbnRhZ2VzKCkge1xuICAgIC8vIDEuIENhbHVsYXRlIHBlcmNlbnRhZ2VzXG4gICAgYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVQZXJjZW50YWdlcygpXG5cbiAgICAvLyAyLiBSZWFkIHBlcmNlbnRhZ2VzIGZyb20gYnVkZ2V0IGNvbnRyb2xsZXJcbiAgICBjb25zdCBwZXJjZW50YWdlcyA9IGJ1ZGdldENvbnRyb2xsZXIuZ2V0UGVyY2VudGFnZXMoKVxuXG4gICAgLy8gMy4gVXBkYXRlIFVJIHRvIHNob3cgbmV3IHBlcmNlbnRhZ2VzXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZXMocGVyY2VudGFnZXMpXG4gIH1cblxuICB1cGRhdGVEYXRlKCkge1xuICAgIGNvbnN0IGJ1ZGdldERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVkZ2V0X19tb250aCcpXG4gICAgY29uc3QgZGF0ZSA9IGRheWpzKCdNTU1NIFlZWVknKVxuICAgIGJ1ZGdldERhdGUudGV4dENvbnRlbnQgPSBkYXRlXG4gIH1cblxuICBkZWxldGVJdGVtKCkge1xuICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5jb21lLWV4cGVuc2VzJylcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5pZCA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdCgnLml0ZW1zJykucGFyZW50RWxlbWVudFxuICAgICAgICBjb25zdCBzcGxpdElEID0gdGFyZ2V0LmlkLnNwbGl0KCctJylcbiAgICAgICAgY29uc3QgdHlwZSA9IHNwbGl0SURbMF1cbiAgICAgICAgY29uc3QgSUQgPSBOdW1iZXIoc3BsaXRJRFsxXSlcblxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUudGFyZ2V0LCB0YXJnZXQsIHNwbGl0SUQsIHR5cGUsIElEKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gMS4gRGVsZXRlIHRoZSBpdGVtIGZyb20gdGhlIGRhdGEgc3RydWN0dXJlXG4gICAgICAgIGJ1ZGdldENvbnRyb2xsZXIucmVtb3ZlSXRlbSh0eXBlLCBJRClcblxuICAgICAgICAvLyAyLiBEZWxldGUgdGhlIGl0ZW0gZnJvbSB0aGUgVUlcbiAgICAgICAgdGFyZ2V0LnJlbW92ZSgpXG5cbiAgICAgICAgLy8gMy4gVXBkYXRlIGFuZCBzaG93IHRoZSBuZXcgYnVkZ2V0XG4gICAgICAgIHRoaXMudXBkYXRlQnVkZ2V0KClcblxuICAgICAgICAvLyA0LiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBwZXJjZW50YWdlc1xuICAgICAgICB0aGlzLnVwZGF0ZVBlcmNlbnRhZ2VzKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVJQ29udHJvbGxlclxuIiwibW9kdWxlLmV4cG9ydHMgPSBicmVha3BvaW50czsiLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG5cbi8vIEV4dGVybmFsXG5pbXBvcnQgJ2FpcmJuYi1icm93c2VyLXNoaW1zJ1xuXG4vLyBJbnRlcm5hbFxuaW1wb3J0ICcuL21vZHVsZXMvaGVscGVycydcbmltcG9ydCBidWRnZXRDb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy9idWRnZXRjb250cm9sbGVyJ1xuaW1wb3J0IFVJQ29udHJvbGxlciBmcm9tICcuL21vZHVsZXMvdWljb250cm9sbGVyJ1xuXG4vLyBSZW1vdmUgbG9hZGluZyBjbGFzcyBmcm9tIGJvZHkgb24gd2luZG93IGxvYWQuXG5jb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpXG5cbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWxvYWRpbmcnKVxuICB9LCAxMDApXG59XG5cbi8vIENyZWF0ZSB0aGUgbWFpbiBjb250cm9sbGVyIGZvciB0aGUgYXBwXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbmNvbnN0IGNvbnRyb2xsZXIgPSAoKGJ1ZGdldEN0cmwpID0+IHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX2Zvcm0nKVxuICBjb25zdCB0eXBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fdHlwZScpXG4gIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX19kZXNjcmlwdGlvbicpXG4gIGNvbnN0IHZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fdmFsdWUnKVxuICBjb25zdCBjaGVjayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjaGVjaycpXG5cbiAgY29uc3QgVUlDdHJsID0gbmV3IFVJQ29udHJvbGxlcih0eXBlLCBkZXNjLCB2YWx1ZSlcblxuICAvLyBUb2dnbGUgdGhlIHN1Ym1pdCBuZXcgY29zdCBmcm9tIGVpdGhlciBpbmNvbWUgb3IgZXhwZW5zZS5cbiAgdHlwZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBBcnJheS5mcm9tKHR5cGUub3B0aW9ucylcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICB0eXBlLmF0dHJpYnV0ZXMsXG4gICAgICAgIHR5cGUub3B0aW9ucyxcbiAgICAgICAgdHlwZS5vcHRpb25zLnNlbGVjdGVkSW5kZXgsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIG9wdGlvbnNbMV1cbiAgICAgIClcbiAgICB9XG4gICAgaWYgKHR5cGUub3B0aW9ucy5zZWxlY3RlZEluZGV4ID09PSAxKSB7XG4gICAgICBjaGVjay5jbGFzc0xpc3QuYWRkKHR5cGUudmFsdWUpXG4gICAgICBvcHRpb25zWzBdLnJlbW92ZUF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKVxuICAgICAgb3B0aW9uc1sxXS5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0aW9uc1sxXS5yZW1vdmVBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgIG9wdGlvbnNbMF0uc2V0QXR0cmlidXRlKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpXG4gICAgICBjaGVjay5jbGFzc0xpc3QucmVtb3ZlKCdleHAnKVxuICAgIH1cbiAgfSlcblxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAvLyBHZXQgZmlsZWQgaW5wdXQgZGF0YVxuICAgIGNvbnN0IGlucHV0ID0gVUlDdHJsLmdldElucHV0KClcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY29uc29sZS5sb2coaW5wdXQpXG4gICAgICBjb25zb2xlLmxvZyh0eXBlb2YgaW5wdXQudmFsdWUpXG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgdGhlIGZvcm0gZmllbGRzXG4gICAgZm9ybS5yZXNldCgpXG5cbiAgICAvLyBPbmx5IHJ1biBjYWxjdWxhdGlvbnMgaWYgdmFsaWQgaW5wdXRzIGFyZSBlbnRlcmVkXG4gICAgaWYgKGlucHV0LmRlc2MgIT09ICcnICYmICFpc05hTihpbnB1dC52YWx1ZSkgJiYgaW5wdXQudmFsdWUgPiAwKSB7XG4gICAgICAvLyBBZGQgdGhlIGl0ZW0gdG8gdGhlIGJ1ZGdldFxuICAgICAgY29uc3QgbmV3SXRlbSA9IGJ1ZGdldEN0cmwuYWRkSXRlbShcbiAgICAgICAgaW5wdXQudHlwZSxcbiAgICAgICAgaW5wdXQuZGVzY3JpcHRpb24sXG4gICAgICAgIGlucHV0LnZhbHVlXG4gICAgICApXG5cbiAgICAgIC8vIENhbGN1bGFlIHRoZSBidWRnZXQgYW5kIHVwZGF0ZSB0aGUgVUlcbiAgICAgIFVJQ3RybC5yZW5kZXIobmV3SXRlbSwgaW5wdXQudHlwZSkgLy8gQWRkIGl0ZW1zIHRvIGluY29tZSBvciBleHBlbnNlcyBsaXN0XG4gICAgICBVSUN0cmwudXBkYXRlQnVkZ2V0KCkgLy8gT3V0cHV0IHRoZSBuZXcgYnVkZ2V0XG4gICAgICBVSUN0cmwudXBkYXRlUGVyY2VudGFnZXMoKSAvLyBPdXRwdXQgdGhlIG5ldyBwZXJjZW50YWdlc1xuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZygnZm9ybSBzdWJtaXR0ZWQhJylcbiAgICAgICAgY29uc29sZS5sb2cobmV3SXRlbSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgLy8gRGVsZXRlIGFuIGFkZGVkIGluY29tZSBvciBleHBlbnNlXG4gIFVJQ3RybC5kZWxldGVJdGVtKClcbn0pKGJ1ZGdldENvbnRyb2xsZXIpXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGJyb3dzZXI7IiwiY29uc3QgYnVkZ2V0Q29udHJvbGxlciA9ICgoKSA9PiB7XG4gIGNsYXNzIEJ1ZGdldCB7XG4gICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgICAgdGhpcy5pZCA9IGlkXG4gICAgICB0aGlzLmRlc2MgPSBkZXNjcmlwdGlvblxuICAgICAgdGhpcy52YWwgPSB2YWx1ZVxuICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICB9XG5cbiAgICBjYWxjUGVyY2VudGFnZSh0b3RhbEluY29tZSkge1xuICAgICAgaWYgKHRvdGFsSW5jb21lID4gMCkge1xuICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh0aGlzLnZhbCAvIHRvdGFsSW5jb21lKSAqIDEwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IC0xXG4gICAgICB9XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBgdGhpcyB2YWx1ZSBpcyAke3R5cGVvZiB0aGlzLnZhbH1gLFxuICAgICAgICAgIGB0aGUgdG90YWxJbmNvbWUgJHt0eXBlb2YgdG90YWxJbmNvbWV9YFxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2V0UGVyY2VudGFnZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBlcmNlbnRhZ2VcbiAgICB9XG4gIH1cblxuICBjb25zdCBkYXRhID0ge1xuICAgIGFsbEl0ZW1zOiB7XG4gICAgICBleHA6IFtdLFxuICAgICAgaW5jOiBbXSxcbiAgICB9LFxuICAgIHRvdGFsczoge1xuICAgICAgZXhwOiAwLFxuICAgICAgaW5jOiAwLFxuICAgIH0sXG4gICAgYnVkZ2V0OiAwLFxuICB9XG5cbiAgY29uc3QgY2FsY3VsYXRlVG90YWxzID0gKHR5cGUpID0+IHtcbiAgICBsZXQgc3VtID0gMFxuICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICBzdW0gKz0gY3VyLnZhbFxuICAgIH0pXG4gICAgZGF0YS50b3RhbHNbdHlwZV0gPSBzdW1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkSXRlbTogKHR5cGUsIGRlc2MsIHZhbCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIG5ldyBJRFxuICAgICAgY29uc3QgSUQgPVxuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IGRhdGEuYWxsSXRlbXNbdHlwZV1bZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggLSAxXS5pZCArIDFcbiAgICAgICAgICA6IDBcblxuICAgICAgLy8gU2V0IG5ldyBpdGVtIHRvIHVzZSBvYmplY3RcbiAgICAgIGNvbnN0IG5ld0l0ZW0gPSBuZXcgQnVkZ2V0KElELCBkZXNjLCB2YWwpXG5cbiAgICAgIC8vIFB1c2ggaXQgaW50byBkYXRhIHN0cnVjdHVyZVxuICAgICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5wdXNoKG5ld0l0ZW0pXG5cbiAgICAgIC8vIGNyZWF0ZSBuZXcgaXRlbVxuICAgICAgcmV0dXJuIG5ld0l0ZW1cbiAgICB9LFxuICAgIGNhbGN1bGF0ZUJ1ZGdldDogKCkgPT4ge1xuICAgICAgLy8gMS4gQ2FsY3VsYXRlIHRoZSBidWRnZXRcbiAgICAgIGNhbGN1bGF0ZVRvdGFscygnZXhwJylcbiAgICAgIGNhbGN1bGF0ZVRvdGFscygnaW5jJylcblxuICAgICAgLy8gMi4gQ2FsY3VsYXRlIHRoZSBidWRnZXQ6IGluY29tZSAtIGV4cGVuc2VzXG4gICAgICBkYXRhLmJ1ZGdldCA9IGRhdGEudG90YWxzLmluYyAtIGRhdGEudG90YWxzLmV4cFxuXG4gICAgICAvLyAzLiBDYWxjdWxhdGUgdGhlIHBlcmNlbnRhZ2Ugb2YgaW5jb21lIHRoYXQgd2Ugc3BlbnRcbiAgICAgIGlmIChkYXRhLnRvdGFscy5pbmMgPiAwKSB7XG4gICAgICAgIGRhdGEucGVyY2VudCA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLmV4cCAvIGRhdGEudG90YWxzLmluYykgKiAxMDApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhLnBlcmNlbnQgPSAtMVxuICAgICAgfVxuXG4gICAgICAvLyAzLiBSZXR1cm4gdGhlIGJ1ZGdldFxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS50b3RhbHMuZXhwLCBkYXRhLnRvdGFscy5pbmMpXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEuYnVkZ2V0LCBkYXRhLnBlcmNlbnQpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSxcbiAgICBjYWxjdWxhdGVQZXJjZW50YWdlczogKCkgPT4ge1xuICAgICAgZGF0YS5hbGxJdGVtcy5leHAuZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICAgIGN1ci5jYWxjUGVyY2VudGFnZShkYXRhLnRvdGFscy5pbmMpXG4gICAgICB9KVxuICAgIH0sXG4gICAgZ2V0UGVyY2VudGFnZXM6ICgpID0+IHtcbiAgICAgIGNvbnN0IGFsbFBlcmMgPSBkYXRhLmFsbEl0ZW1zLmV4cC5tYXAoKGN1cikgPT4ge1xuICAgICAgICByZXR1cm4gY3VyLmdldFBlcmNlbnRhZ2UoKVxuICAgICAgfSlcbiAgICAgIHJldHVybiBhbGxQZXJjXG4gICAgfSxcbiAgICByZW1vdmVJdGVtOiAodHlwZSwgaWQpID0+IHtcbiAgICAgIGNvbnN0IGlkcyA9IGRhdGEuYWxsSXRlbXNbdHlwZV0ubWFwKChjdXJyZW50KSA9PiB7XG4gICAgICAgIHJldHVybiBjdXJyZW50LmlkXG4gICAgICB9KVxuICAgICAgY29uc3QgaW5kZXggPSBpZHMuaW5kZXhPZihpZClcblxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnNwbGljZShpbmRleCwgMSlcbiAgICAgIH1cbiAgICB9LFxuICB9XG59KSgpXG5cbmV4cG9ydCBkZWZhdWx0IGJ1ZGdldENvbnRyb2xsZXJcbiJdLCJzb3VyY2VSb290IjoiIn0=