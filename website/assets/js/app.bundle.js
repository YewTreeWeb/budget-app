(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{"+4zn":function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),s=n.n(a),o=n("yXPU"),c=n.n(o),i=n("lwsE"),l=n.n(i),u=n("W8MJ"),r=n.n(u),d=function(){function e(){l()(this,e),this.budgets=db.collection("budgets")}var t;return r()(e,[{key:"saveBudget",value:(t=c()(s.a.mark((function e(t,n,a,o){var c,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new Date,i={budget:t.budget,totalInc:t.totals.inc,totalExp:t.totals.exp,totalSav:t.totals.sav,percentExp:t.percent.exp,percentSav:t.percent.sav,allItems:{exp:[n],inc:[a],sav:[o]},created_at:firebase.firestore.Timestamp.fromDate(c)},e.next=4,this.budgets.add(i);case 4:return l=e.sent,e.abrupt("return",l);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n,a,s){return t.apply(this,arguments)})},{key:"getBudget",value:function(e){this.budgets.orderBy("created_at").onSnapshot((function(t){t.docChanges().forEach((function(t){"added"===t.type&&e(t.doc.data(),t.doc.id)}))}))}}]),e}();t.default=d},0:function(e,t,n){e.exports=n("kFay")},1:function(e,t){},E4hX:function(e,t,n){(function(e,t){for(var n,a=function(){},s=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],o=s.length,c=window.console=window.console||{};o--;)c[n=s[o]]||(c[n]=a);window.addEventListener("keydown",(function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))})),document.querySelector("html").setAttribute("data-browser",e.name);var i=document.querySelector("body");t({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:[null,"480px"]}),e.mobile?i.classList.add("is-mobile"):(t.on(">medium",(function(){i.classList.remove("is-mobile"),i.classList.add("is-desktop")})),t.on("<=medium",(function(){i.classList.remove("is-desktop"),i.classList.add("is-mobile")}))),"localhost"===window.location.hostname&&console.log("localhost detected!")}).call(this,n("txRt"),n("a6Qp"))},SEKM:function(e,t,n){"use strict";n.r(t);var a=n("lwsE"),s=n.n(a),o=n("W8MJ"),c=n.n(o),i=n("xVb/"),l=new(n("+4zn").default),u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=Math.abs(e),o=(s=s.toFixed(2)).split("."),c=o[0],i=o[1];i=Number(i)>0?".".concat(i):"",c.length>3&&(c="".concat(c.substr(0,c.length-3),",").concat(c.substr(c.length-3,3)));var l=n?'<span class="currency">&pound;</span>':"";return"".concat(a?"exp"===t?'<span class="sign">&#45;</span> ':'<span class="sign">&#43;</span> ':"").concat(l).concat(c).concat(i)},r=function(){function e(t,n,a){s()(this,e),this.inputType=t,this.inputDesc=n,this.inputVal=a}return c()(e,[{key:"getInput",value:function(){return{type:this.inputType.value,description:this.inputDesc.value,value:Number(this.inputVal.value)}}},{key:"render",value:function(e,t){var n,a="exp"===t?"expenses":"sav"===t?"savings":"income",s=document.querySelector(".".concat(a,"__list"));n="\n    <li class='".concat(a,"__item' id='").concat(t,"-").concat(e.id,"'>\n      <div class='item-desc'><p>").concat(e.desc,"</p></div>\n      <div class=\"items\">\n        <div class='items__value'><p>").concat(u(e.val,t,!0,!1),"</p></div>\n    "),"exp"!==t&&"sav"!==t||(n+='<div class="items__percent"><p>0&#37;</p></div>'),n+='\n        <button class=\'btn btn--clear items__del\'>\n          <svg id="delete" class="icon" width="20" height="20" aria-hidden="true">\n            <use xlink:href="/assets/images/icons.svg#icon-delete"></use>\n          </svg>\n        </button>\n      </div>\n    </li>\n    ',s.innerHTML+=n}},{key:"getBudget",value:function(e){return{budget:e.budget,totalInc:e.totals.inc,totalExp:e.totals.exp,totalSav:e.totals.sav,percentExp:e.percent.exp,percentSav:e.percent.sav}}},{key:"displayBudget",value:function(e){var t=e.budget>0?"inc":"exp",n="exp"===t?"expenses":"income",a=document.querySelector(".budget__value"),s=document.querySelector(".budget__income .budget__amount"),o=document.querySelector(".budget__expenses .budget__amount"),c=document.querySelector(".budget__savings .budget__amount");a.innerHTML=u(e.budget,t,!0),s.innerHTML=u(e.totalInc,"inc"),o.innerHTML=u(e.totalExp,"exp"),c.innerHTML=u(e.totalSav,"exp"),console.log("The ".concat(n," is/are ").concat(e.budget)),console.log(s,o)}},{key:"displayPercentage",value:function(e,t){var n="exp"===t?"expenses":"savings",a=document.querySelector(".budget__".concat(n," .budget__percentage"));e>0?(a.classList.add("show"),a.innerHTML="".concat(e,"&#37;")):a.classList.remove("show"),console.log(a)}},{key:"updateBudget",value:function(){var e=i.default.calculateBudget(),t=this.getBudget(e);console.log(t),this.displayBudget(t),this.displayPercentage(t.percentExp,"exp"),this.displayPercentage(t.percentSav,"sav")}},{key:"displayPercentages",value:function(e,t){var n="exp"===t?"expenses":"savings";!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(".".concat(n," .items__percent")),(function(t,n){e[n]>0?(t.classList.add("show"),t.innerHTML="".concat(e[n],"&#37;")):(t.classList.remove("show"),t.innerHTML="0&#37;")}))}},{key:"updatePercentages",value:function(){i.default.calculatePercentages(this.inputType.value);var e=i.default.getPercentages(this.inputType.value);this.displayPercentages(e,this.inputType.value)}},{key:"displayDate",value:function(){var e=document.querySelector(".budget__date"),t=new Date;e.textContent="".concat(["January","February","March","April","May","June","July","August","Sepetember","October","November","December"][t.getMonth()]," ").concat(t.getFullYear())}},{key:"changeType",value:function(){var e=this.inputType,t=document.querySelector("#check");e.addEventListener("change",(function(n){var a=Array.from(e.options);console.log(n),console.log(e.attributes,e.options,e.options.selectedIndex,a,a[1]),a.forEach((function(e){e.selected?(e.setAttribute("selected","selected"),t.classList.remove("exp","sav"),"exp"===e.value?t.classList.add("exp"):"sav"===e.value&&t.classList.add("sav")):e.removeAttribute("selected","selected"),console.log("Value ".concat(e.value))}))}))}},{key:"deleteItem",value:function(){var e=this;document.querySelector(".income-expenses").addEventListener("click",(function(t){if("delete"===t.target.id){var n=t.target.closest(".items").parentElement,a=n.id.split("-"),s=a[0],o=Number(a[1]);console.log(t.target,n,a,s,o),i.default.removeItem(s,o),n.remove(),e.updateBudget(),e.updatePercentages()}}))}},{key:"saving",value:function(){var e=document.querySelector("#save"),t=i.default.calculateBudget(),n=this.getBudget(t);e.addEventListener("click",(function(){l.saveBudget(n).then((function(){console.log("saved")})).catch((function(e){console.error(e)}))}))}}]),e}();t.default=r},a6Qp:function(e,t){e.exports=breakpoints},kFay:function(e,t,n){"use strict";n.r(t);var a=n("cDf5"),s=n.n(a),o=(n("OuUZ"),n("E4hX"),n("xVb/")),c=n("SEKM"),i=document.querySelector("body");window.onload=function(){window.setTimeout((function(){i.classList.remove("is-loading")}),100)};var l,u,r,d,p,v;l=o.default,u=document.querySelector(".add__form"),r=document.querySelector(".add__type"),d=document.querySelector(".add__description"),p=document.querySelector(".add__value"),(v=new c.default(r,d,p)).displayDate(),v.changeType(),l.testing(),u.addEventListener("submit",(function(e){e.preventDefault();var t=v.getInput();if(console.log(t),console.log(s()(t.value)),u.reset(),""!==t.desc&&!isNaN(t.value)&&t.value>0){var n=l.addItem(t.type,t.description,t.value);v.render(n,t.type),v.updateBudget(),v.updatePercentages(),console.log("form submitted!"),console.log(n)}l.testing()})),v.deleteItem()},txRt:function(e,t){e.exports=browser},"xVb/":function(e,t,n){"use strict";n.r(t);var a,s,o,c=n("cDf5"),i=n.n(c),l=n("lwsE"),u=n.n(l),r=n("W8MJ"),d=n.n(r),p=(a=function(){function e(t,n,a){u()(this,e),this.id=t,this.desc=n,this.val=a,this.percentage=-1}return d()(e,[{key:"calcPercentage",value:function(e){this.percentage=e>0?Math.round(this.val/e*100):-1,console.log("this value is ".concat(i()(this.val)),"the totalIncome ".concat(i()(e)))}},{key:"getPercentage",value:function(){return this.percentage}}]),e}(),s={allItems:{exp:[],inc:[],sav:[]},totals:{exp:0,inc:0,sav:0},percent:{exp:-1,sav:-1},budget:0},o=function(e){var t=0;s.allItems[e].forEach((function(e){t+=e.val})),s.totals[e]=t},{addItem:function(e,t,n){var o=s.allItems[e].length>0?s.allItems[e][s.allItems[e].length-1].id+1:0,c=new a(o,t,n);return s.allItems[e].push(c),c},calculateBudget:function(){return o("exp"),o("inc"),o("sav"),s.budget=s.totals.inc-(s.totals.exp+s.totals.sav),s.totals.inc>0?(s.percent.exp=Math.round(s.totals.exp/s.totals.inc*100),s.percent.sav=Math.round(s.totals.sav/s.totals.inc*100)):(s.percent.exp=-1,s.percent.sav=-1),console.log(s.totals.exp,s.totals.inc),console.log(s.budget,s.percent.exp,s.percent.sav),s},calculatePercentages:function(e){s.allItems[e].forEach((function(e){e.calcPercentage(s.totals.inc)}))},getPercentages:function(e){return s.allItems[e].map((function(e){return e.getPercentage()}))},removeItem:function(e,t){var n=s.allItems[e].map((function(e){return e.id})).indexOf(t);-1!==n&&s.allItems[e].splice(n,1)},testing:function(){console.log(s.allItems)}});t.default=p}},[[0,"runtime","vendors"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL3Bhc3RidWRnZXQuanMiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvbW9kdWxlcy9oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL3dlYnNpdGUvc3JjL2pzL21vZHVsZXMvdWljb250cm9sbGVyLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyZWFrcG9pbnRzXCIiLCJ3ZWJwYWNrOi8vLy4vd2Vic2l0ZS9zcmMvanMvYXBwLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcImJyb3dzZXJcIiIsIndlYnBhY2s6Ly8vLi93ZWJzaXRlL3NyYy9qcy9tb2R1bGVzL2J1ZGdldGNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiUGFzdEJ1ZGdldCIsInRoaXMiLCJidWRnZXRzIiwiZGIiLCJjb2xsZWN0aW9uIiwib2JqIiwiZXhwIiwiaW5jIiwic2F2Iiwibm93IiwiRGF0ZSIsImJ1ZGdldCIsInRvdGFsSW5jIiwidG90YWxzIiwidG90YWxFeHAiLCJ0b3RhbFNhdiIsInBlcmNlbnRFeHAiLCJwZXJjZW50IiwicGVyY2VudFNhdiIsImFsbEl0ZW1zIiwiY3JlYXRlZF9hdCIsImZpcmViYXNlIiwiZmlyZXN0b3JlIiwiVGltZXN0YW1wIiwiZnJvbURhdGUiLCJhZGQiLCJyZXNwb25zZSIsImNiIiwib3JkZXJCeSIsIm9uU25hcHNob3QiLCJzbmFwc2hvdCIsImRvY0NoYW5nZXMiLCJmb3JFYWNoIiwiY2hhbmdlIiwidHlwZSIsImRvYyIsImRhdGEiLCJpZCIsIm1ldGhvZCIsIm5vb3AiLCJtZXRob2RzIiwibGVuZ3RoIiwiY29uc29sZSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVGaXJzdFRhYiIsImUiLCJrZXlDb2RlIiwiZG9jdW1lbnQiLCJib2R5IiwiY2xhc3NMaXN0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRBdHRyaWJ1dGUiLCJicm93c2VyIiwibmFtZSIsImJyZWFrcG9pbnRzIiwieGxhcmdlIiwibGFyZ2UiLCJtZWRpdW0iLCJzbWFsbCIsInhzbWFsbCIsIm1vYmlsZSIsIm9uIiwicmVtb3ZlIiwibG9jYXRpb24iLCJob3N0bmFtZSIsImxvZyIsInBhc3RidWRnZXQiLCJmb3JtYXROdW1iZXIiLCJudW1iZXIiLCJtb25leSIsImNhbGMiLCJudW0iLCJNYXRoIiwiYWJzIiwibnVtU3BsaXQiLCJ0b0ZpeGVkIiwic3BsaXQiLCJpbnQiLCJkZWNpbWFsIiwiTnVtYmVyIiwic3Vic3RyIiwiY3VycmVuY3kiLCJVSUNvbnRyb2xsZXIiLCJjb3N0IiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsImlucHV0VHlwZSIsImlucHV0RGVzYyIsImlucHV0VmFsIiwiaHRtbCIsIml0ZW0iLCJsaXN0IiwiZGVzYyIsInZhbCIsImlubmVySFRNTCIsInR5cGVzIiwicGVyY2VudGFnZSIsImdldERhdGEiLCJidWRnZXRDb250cm9sbGVyIiwiY2FsY3VsYXRlQnVkZ2V0IiwibmV3QnVkZ2V0IiwiZ2V0QnVkZ2V0IiwiZGlzcGxheUJ1ZGdldCIsImRpc3BsYXlQZXJjZW50YWdlIiwicGVyY2VudGFnZXMiLCJpIiwibm9kZUxpc3RGb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnQiLCJpbmRleCIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwiZ2V0UGVyY2VudGFnZXMiLCJkaXNwbGF5UGVyY2VudGFnZXMiLCJidWRnZXREYXRlIiwiZGF0ZSIsInRleHRDb250ZW50IiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImNoZWNrIiwib3B0aW9ucyIsIkFycmF5IiwiZnJvbSIsImF0dHJpYnV0ZXMiLCJzZWxlY3RlZEluZGV4Iiwib3B0aW9uIiwic2VsZWN0ZWQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicGFyZW50RWxlbWVudCIsInNwbGl0SUQiLCJJRCIsInJlbW92ZUl0ZW0iLCJ1cGRhdGVCdWRnZXQiLCJ1cGRhdGVQZXJjZW50YWdlcyIsImJ1dHRvbiIsImN1cnJlbnRCdWRnZXQiLCJzYXZlQnVkZ2V0IiwidGhlbiIsImVyciIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyIsIm9ubG9hZCIsInNldFRpbWVvdXQiLCJidWRnZXRDdHJsIiwiZm9ybSIsIlVJQ3RybCIsImRpc3BsYXlEYXRlIiwiY2hhbmdlVHlwZSIsInRlc3RpbmciLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0IiwiZ2V0SW5wdXQiLCJyZXNldCIsImlzTmFOIiwibmV3SXRlbSIsImFkZEl0ZW0iLCJyZW5kZXIiLCJkZWxldGVJdGVtIiwiQnVkZ2V0IiwiY2FsY3VsYXRlVG90YWxzIiwidG90YWxJbmNvbWUiLCJyb3VuZCIsInN1bSIsImN1ciIsInB1c2giLCJjYWxjUGVyY2VudGFnZSIsIm1hcCIsImdldFBlcmNlbnRhZ2UiLCJpbmRleE9mIiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiZ01BQU1BLEUsV0FDSixhQUFjLFlBQ1pDLEtBQUtDLFFBQVVDLEdBQUdDLFdBQVcsVyx3RUFHZEMsRUFBS0MsRUFBS0MsRUFBS0MsRyxrRkFDeEJDLEVBQU0sSUFBSUMsS0FDVkMsRUFBUyxDQUNiQSxPQUFRTixFQUFJTSxPQUNaQyxTQUFVUCxFQUFJUSxPQUFPTixJQUNyQk8sU0FBVVQsRUFBSVEsT0FBT1AsSUFDckJTLFNBQVVWLEVBQUlRLE9BQU9MLElBQ3JCUSxXQUFZWCxFQUFJWSxRQUFRWCxJQUN4QlksV0FBWWIsRUFBSVksUUFBUVQsSUFDeEJXLFNBQVUsQ0FDUmIsSUFBSyxDQUFDQSxHQUNOQyxJQUFLLENBQUNBLEdBQ05DLElBQUssQ0FBQ0EsSUFFUlksV0FBWUMsU0FBU0MsVUFBVUMsVUFBVUMsU0FBU2YsSSxTQUU3QlIsS0FBS0MsUUFBUXVCLElBQUlkLEcsY0FBbENlLEUseUJBQ0NBLEcsb0lBR0NDLEdBQ1IxQixLQUFLQyxRQUFRMEIsUUFBUSxjQUFjQyxZQUFXLFNBQUNDLEdBQzdDQSxFQUFTQyxhQUFhQyxTQUFRLFNBQUNDLEdBQ1QsVUFBaEJBLEVB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QUFNOEIsRUFBS3ZCLE9BQU9OLElBQU8sS0FDcEU2QixFQUFLbkIsUUFBUVQsSUFBTWtFLEtBQUsyRixNQUFPakksRUFBS3ZCLE9BQU9MLElBQU00QixFQUFLdkIsT0FBT04sSUFBTyxPQUVwRTZCLEVBQUtuQixRQUFRWCxLQUFPLEVBQ3BCOEIsRUFBS25CLFFBQVFULEtBQU8sR0FLcEJrQyxRQUFReUIsSUFBSS9CLEVBQUt2QixPQUFPUCxJQUFLOEIsRUFBS3ZCLE9BQU9OLEtBQ3pDbUMsUUFBUXlCLElBQUkvQixFQUFLekIsT0FBUXlCLEVBQUtuQixRQUFRWCxJQUFLOEIsRUFBS25CLFFBQVFULEtBR25ENEIsR0FFVDRFLHFCQUFzQixTQUFDOUUsR0FDckJFLEVBQUtqQixTQUFTZSxHQUFNRixTQUFRLFNBQUN1SSxHQUMzQkEsRUFBSUUsZUFBZXJJLEVBQUt2QixPQUFPTixTQUduQzBHLGVBQWdCLFNBQUMvRSxHQUlmLE9BSGdCRSxFQUFLakIsU0FBU2UsR0FBTXdJLEtBQUksU0FBQ0gsR0FDdkMsT0FBT0EsRUFBSUksb0JBSWZyQyxXQUFZLFNBQUNwRyxFQUFNRyxHQUNqQixJQUdNMEUsRUFITTNFLEVBQUtqQixTQUFTZSxHQUFNd0ksS0FBSSxTQUFDNUQsR0FDbkMsT0FBT0EsRUFBUXpFLE1BRUN1SSxRQUFRdkksSUFFWCxJQUFYMEUsR0FDRjNFLEVBQUtqQixTQUFTZSxHQUFNMkksT0FBTzlELEVBQU8sSUFHdEN5QyxRQUFTLFdBQ1A5RyxRQUFReUIsSUFBSS9CLEVBQUtqQixhQUtSaUYsYyIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUGFzdEJ1ZGdldCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYnVkZ2V0cyA9IGRiLmNvbGxlY3Rpb24oJ2J1ZGdldHMnKVxuICB9XG5cbiAgYXN5bmMgc2F2ZUJ1ZGdldChvYmosIGV4cCwgaW5jLCBzYXYpIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgYnVkZ2V0ID0ge1xuICAgICAgYnVkZ2V0OiBvYmouYnVkZ2V0LFxuICAgICAgdG90YWxJbmM6IG9iai50b3RhbHMuaW5jLFxuICAgICAgdG90YWxFeHA6IG9iai50b3RhbHMuZXhwLFxuICAgICAgdG90YWxTYXY6IG9iai50b3RhbHMuc2F2LFxuICAgICAgcGVyY2VudEV4cDogb2JqLnBlcmNlbnQuZXhwLFxuICAgICAgcGVyY2VudFNhdjogb2JqLnBlcmNlbnQuc2F2LFxuICAgICAgYWxsSXRlbXM6IHtcbiAgICAgICAgZXhwOiBbZXhwXSxcbiAgICAgICAgaW5jOiBbaW5jXSxcbiAgICAgICAgc2F2OiBbc2F2XSxcbiAgICAgIH0sXG4gICAgICBjcmVhdGVkX2F0OiBmaXJlYmFzZS5maXJlc3RvcmUuVGltZXN0YW1wLmZyb21EYXRlKG5vdyksXG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5idWRnZXRzLmFkZChidWRnZXQpXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICBnZXRCdWRnZXQoY2IpIHtcbiAgICB0aGlzLmJ1ZGdldHMub3JkZXJCeSgnY3JlYXRlZF9hdCcpLm9uU25hcHNob3QoKHNuYXBzaG90KSA9PiB7XG4gICAgICBzbmFwc2hvdC5kb2NDaGFuZ2VzKCkuZm9yRWFjaCgoY2hhbmdlKSA9PiB7XG4gICAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZGVkJykge1xuICAgICAgICAgIGNiKGNoYW5nZS5kb2MuZGF0YSgpLCBjaGFuZ2UuZG9jLmlkKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUGFzdEJ1ZGdldFxuIiwiLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXBsdXNwbHVzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1tdWx0aS1hc3NpZ24gKi9cblxuLy8gQXZvaWQgYGNvbnNvbGVgIGVycm9ycyBpbiBicm93c2VycyB0aGF0IGxhY2sgYSBjb25zb2xlLlxue1xuICBsZXQgbWV0aG9kXG4gIGNvbnN0IG5vb3AgPSAoKSA9PiB7fVxuICBjb25zdCBtZXRob2RzID0gW1xuICAgICdhc3NlcnQnLFxuICAgICdjbGVhcicsXG4gICAgJ2NvdW50JyxcbiAgICAnZGVidWcnLFxuICAgICdkaXInLFxuICAgICdkaXJ4bWwnLFxuICAgICdlcnJvcicsXG4gICAgJ2V4Y2VwdGlvbicsXG4gICAgJ2dyb3VwJyxcbiAgICAnZ3JvdXBDb2xsYXBzZWQnLFxuICAgICdncm91cEVuZCcsXG4gICAgJ2luZm8nLFxuICAgICdsb2cnLFxuICAgICdtYXJrVGltZWxpbmUnLFxuICAgICdwcm9maWxlJyxcbiAgICAncHJvZmlsZUVuZCcsXG4gICAgJ3RhYmxlJyxcbiAgICAndGltZScsXG4gICAgJ3RpbWVFbmQnLFxuICAgICd0aW1lbGluZScsXG4gICAgJ3RpbWVsaW5lRW5kJyxcbiAgICAndGltZVN0YW1wJyxcbiAgICAndHJhY2UnLFxuICAgICd3YXJuJyxcbiAgXVxuICBsZXQgeyBsZW5ndGggfSA9IG1ldGhvZHNcbiAgY29uc3QgY29uc29sZSA9ICh3aW5kb3cuY29uc29sZSA9IHdpbmRvdy5jb25zb2xlIHx8IHt9KVxuXG4gIHdoaWxlIChsZW5ndGgtLSkge1xuICAgIG1ldGhvZCA9IG1ldGhvZHNbbGVuZ3RoXVxuXG4gICAgLy8gT25seSBzdHViIHVuZGVmaW5lZCBtZXRob2RzLlxuICAgIGlmICghY29uc29sZVttZXRob2RdKSB7XG4gICAgICBjb25zb2xlW21ldGhvZF0gPSBub29wXG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCB0YWJiaW5nIGluZGljYXRvciB0byB3aW5kb3dcbmNvbnN0IGhhbmRsZUZpcnN0VGFiID0gKGUpID0+IHtcbiAgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgIC8vIHRoZSBcIkkgYW0gYSBrZXlib2FyZCB1c2VyXCIga2V5XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCd1c2VyLWlzLXRhYmJpbmcnKVxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlRmlyc3RUYWIpXG4gIH1cbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVGaXJzdFRhYilcblxuLy8gQWRkIGEgYnJvd2VyIGluZGljYXRvciB0byB0aGUgSFRNTCBlbGVtZW50LlxuY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKVxuaHRtbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYnJvd3NlcicsIGJyb3dzZXIubmFtZSlcblxuLy8gRGV0ZWN0IGlmIG1vYmlsZSBvciBkZXNrdG9wLlxuY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG5icmVha3BvaW50cyh7XG4gIHhsYXJnZTogWycxMjgxcHgnLCAnMTY4MHB4J10sXG4gIGxhcmdlOiBbJzk4MXB4JywgJzEyODBweCddLFxuICBtZWRpdW06IFsnNzM3cHgnLCAnOTgwcHgnXSxcbiAgc21hbGw6IFsnNDgxcHgnLCAnNzM2cHgnXSxcbiAgeHNtYWxsOiBbbnVsbCwgJzQ4MHB4J10sXG59KVxuXG5pZiAoYnJvd3Nlci5tb2JpbGUpIHtcbiAgYm9keS5jbGFzc0xpc3QuYWRkKCdpcy1tb2JpbGUnKVxufSBlbHNlIHtcbiAgYnJlYWtwb2ludHMub24oJz5tZWRpdW0nLCAoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1tb2JpbGUnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtZGVza3RvcCcpXG4gIH0pXG4gIGJyZWFrcG9pbnRzLm9uKCc8PW1lZGl1bScsICgpID0+IHtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRlc2t0b3AnKVxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbW9iaWxlJylcbiAgfSlcbn1cblxuLy8gTG9nIGlmIHJ1bm5pbmcgaW4gbG9jYWxob3N0IHdoZW4gaW4gZGV2ZWxvcG1lbnQgbW9kZS5cbmlmIChcbiAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyAmJlxuICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nXG4pIHtcbiAgY29uc29sZS5sb2coJ2xvY2FsaG9zdCBkZXRlY3RlZCEnKVxufVxuIiwiLyogZXNsaW50LWRpc2FibGUgY2xhc3MtbWV0aG9kcy11c2UtdGhpcyAqL1xuaW1wb3J0IGJ1ZGdldENvbnRyb2xsZXIgZnJvbSAnLi9idWRnZXRjb250cm9sbGVyJ1xuaW1wb3J0IFBhc3RCdWRnZXQgZnJvbSAnLi9wYXN0YnVkZ2V0J1xuXG5jb25zdCBwYXN0YnVkZ2V0ID0gbmV3IFBhc3RCdWRnZXQoKVxuXG5jb25zdCBmb3JtYXROdW1iZXIgPSAobnVtYmVyLCB0eXBlLCBtb25leSA9IGZhbHNlLCBjYWxjID0gdHJ1ZSkgPT4ge1xuICAvKipcbiAgICogKyBvciAtIGJlZm9yZSB0aGUgbnVtYmVyXG4gICAqIGV4YWN0bHkgMiBkZWNpbWFsIHBvaW50c1xuICAgKiBjb21tYSBzZXBlcmF0aW5nIHRoZSB0aG91c2FuZHNcbiAgICpcbiAgICogMjMxMC40NTY3ID0gKyAyLDMxMC40NlxuICAgKi9cbiAgbGV0IG51bSA9IE1hdGguYWJzKG51bWJlcilcbiAgbnVtID0gbnVtLnRvRml4ZWQoMilcblxuICBjb25zdCBudW1TcGxpdCA9IG51bS5zcGxpdCgnLicpIC8vIG5vdyBhIHN0cmluZyBhbmQgd2lsbCBzcGxpdCB0aGUgLiB0byByZXBsYWNlIHdpdGggYSAsXG4gIGxldCBpbnQgPSBudW1TcGxpdFswXVxuICBsZXQgZGVjaW1hbCA9IG51bVNwbGl0WzFdXG4gIGRlY2ltYWwgPSBOdW1iZXIoZGVjaW1hbCkgPiAwID8gYC4ke2RlY2ltYWx9YCA6ICcnXG5cbiAgaWYgKGludC5sZW5ndGggPiAzKSB7XG4gICAgLy8gc3Vic3RyIGFsbG93cyBmb3Igb25seSBwYXJ0IG9mIHRoZSBzdHJpbmcgdG8gYmUgdGFrZW5cbiAgICBpbnQgPSBgJHtpbnQuc3Vic3RyKDAsIGludC5sZW5ndGggLSAzKX0sJHtpbnQuc3Vic3RyKGludC5sZW5ndGggLSAzLCAzKX1gIC8vIGlucHV0IDIzMTAsIG91dHB1dCAyLDMxMFxuICB9XG5cbiAgbGV0IHNpZ25cbiAgaWYgKGNhbGMpIHtcbiAgICBzaWduID1cbiAgICAgIHR5cGUgPT09ICdleHAnXG4gICAgICAgID8gJzxzcGFuIGNsYXNzPVwic2lnblwiPiYjNDU7PC9zcGFuPiAnXG4gICAgICAgIDogJzxzcGFuIGNsYXNzPVwic2lnblwiPiYjNDM7PC9zcGFuPiAnXG4gIH0gZWxzZSB7XG4gICAgc2lnbiA9ICcnXG4gIH1cbiAgY29uc3QgY3VycmVuY3kgPSBtb25leSA/ICc8c3BhbiBjbGFzcz1cImN1cnJlbmN5XCI+JnBvdW5kOzwvc3Bhbj4nIDogJydcblxuICAvLyBSZXR1cm4gdGhlIGZvcm1hdHRlZCBzdHJpbmdcbiAgcmV0dXJuIGAke3NpZ259JHtjdXJyZW5jeX0ke2ludH0ke2RlY2ltYWx9YFxufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItZGVzdHJ1Y3R1cmluZyAqL1xuY2xhc3MgVUlDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoY29zdCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgdGhpcy5pbnB1dFR5cGUgPSBjb3N0XG4gICAgdGhpcy5pbnB1dERlc2MgPSBkZXNjcmlwdGlvblxuICAgIHRoaXMuaW5wdXRWYWwgPSB2YWx1ZVxuICB9XG5cbiAgZ2V0SW5wdXQoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IHRoaXMuaW5wdXRUeXBlLnZhbHVlLCAvLyBXaWxsIGJlIGVpdGhlciBpbmMgb3IgZXhwXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5pbnB1dERlc2MudmFsdWUsXG4gICAgICB2YWx1ZTogTnVtYmVyKHRoaXMuaW5wdXRWYWwudmFsdWUpLFxuICAgIH1cbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzXG4gIHJlbmRlcihvYmosIHR5cGUpIHtcbiAgICBjb25zdCBpdGVtID1cbiAgICAgIHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6IHR5cGUgPT09ICdzYXYnID8gJ3NhdmluZ3MnIDogJ2luY29tZSdcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aXRlbX1fX2xpc3RgKVxuICAgIGxldCBodG1sXG5cbiAgICAvLyBDcmVhdGUgSFRNTCBzdHJpbmcgd2l0aCBwbGFjZWhvbGRlclxuICAgIGh0bWwgPSBgXG4gICAgPGxpIGNsYXNzPScke2l0ZW19X19pdGVtJyBpZD0nJHt0eXBlfS0ke29iai5pZH0nPlxuICAgICAgPGRpdiBjbGFzcz0naXRlbS1kZXNjJz48cD4ke29iai5kZXNjfTwvcD48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJpdGVtc1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPSdpdGVtc19fdmFsdWUnPjxwPiR7Zm9ybWF0TnVtYmVyKFxuICAgICAgICAgIG9iai52YWwsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICB0cnVlLFxuICAgICAgICAgIGZhbHNlXG4gICAgICAgICl9PC9wPjwvZGl2PlxuICAgIGBcblxuICAgIGlmICh0eXBlID09PSAnZXhwJyB8fCB0eXBlID09PSAnc2F2Jykge1xuICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIml0ZW1zX19wZXJjZW50XCI+PHA+MCYjMzc7PC9wPjwvZGl2PidcbiAgICB9XG5cbiAgICBodG1sICs9IGBcbiAgICAgICAgPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi0tY2xlYXIgaXRlbXNfX2RlbCc+XG4gICAgICAgICAgPHN2ZyBpZD1cImRlbGV0ZVwiIGNsYXNzPVwiaWNvblwiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIyMFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPVwiL2Fzc2V0cy9pbWFnZXMvaWNvbnMuc3ZnI2ljb24tZGVsZXRlXCI+PC91c2U+XG4gICAgICAgICAgPC9zdmc+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9saT5cbiAgICBgXG5cbiAgICAvLyBJbnNlcnQgSFRNTCBpbnRvIHRoZSBET01cbiAgICBsaXN0LmlubmVySFRNTCArPSBodG1sXG4gIH1cblxuICBnZXRCdWRnZXQoZGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICBidWRnZXQ6IGRhdGEuYnVkZ2V0LFxuICAgICAgdG90YWxJbmM6IGRhdGEudG90YWxzLmluYyxcbiAgICAgIHRvdGFsRXhwOiBkYXRhLnRvdGFscy5leHAsXG4gICAgICB0b3RhbFNhdjogZGF0YS50b3RhbHMuc2F2LFxuICAgICAgcGVyY2VudEV4cDogZGF0YS5wZXJjZW50LmV4cCxcbiAgICAgIHBlcmNlbnRTYXY6IGRhdGEucGVyY2VudC5zYXYsXG4gICAgfVxuICB9XG5cbiAgZGlzcGxheUJ1ZGdldChvYmopIHtcbiAgICBjb25zdCB0eXBlID0gb2JqLmJ1ZGdldCA+IDAgPyAnaW5jJyA6ICdleHAnXG4gICAgY29uc3QgdHlwZXMgPSB0eXBlID09PSAnZXhwJyA/ICdleHBlbnNlcycgOiAnaW5jb21lJ1xuICAgIGNvbnN0IGJ1ZGdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idWRnZXRfX3ZhbHVlJylcbiAgICBjb25zdCBpbmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYnVkZ2V0X19pbmNvbWUgLmJ1ZGdldF9fYW1vdW50YClcbiAgICBjb25zdCBleHAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYnVkZ2V0X19leHBlbnNlcyAuYnVkZ2V0X19hbW91bnRgKVxuICAgIGNvbnN0IHNhdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXRfX3NhdmluZ3MgLmJ1ZGdldF9fYW1vdW50YClcblxuICAgIGJ1ZGdldC5pbm5lckhUTUwgPSBmb3JtYXROdW1iZXIob2JqLmJ1ZGdldCwgdHlwZSwgdHJ1ZSlcbiAgICBpbmMuaW5uZXJIVE1MID0gZm9ybWF0TnVtYmVyKG9iai50b3RhbEluYywgJ2luYycpXG4gICAgZXhwLmlubmVySFRNTCA9IGZvcm1hdE51bWJlcihvYmoudG90YWxFeHAsICdleHAnKVxuICAgIHNhdi5pbm5lckhUTUwgPSBmb3JtYXROdW1iZXIob2JqLnRvdGFsU2F2LCAnZXhwJylcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhgVGhlICR7dHlwZXN9IGlzL2FyZSAke29iai5idWRnZXR9YClcbiAgICAgIGNvbnNvbGUubG9nKGluYywgZXhwKVxuICAgIH1cbiAgfVxuXG4gIGRpc3BsYXlQZXJjZW50YWdlKHBlcmNlbnRhZ2UsIHR5cGUpIHtcbiAgICBjb25zdCB0eXBlcyA9IHR5cGUgPT09ICdleHAnID8gJ2V4cGVuc2VzJyA6ICdzYXZpbmdzJ1xuICAgIGNvbnN0IHBlcmNlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC5idWRnZXRfXyR7dHlwZXN9IC5idWRnZXRfX3BlcmNlbnRhZ2VgXG4gICAgKVxuXG4gICAgaWYgKHBlcmNlbnRhZ2UgPiAwKSB7XG4gICAgICBwZXJjZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgICAgcGVyY2VudC5pbm5lckhUTUwgPSBgJHtwZXJjZW50YWdlfSYjMzc7YFxuICAgIH0gZWxzZSB7XG4gICAgICBwZXJjZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhwZXJjZW50KVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUJ1ZGdldCgpIHtcbiAgICAvLyAxLiBDaGVjayBsb2NhbFN0b3JhZ2UgZm9yIHNhdmUgYnVkZ2V0IGRhdGEsIGVsc2UgZ2V0IG5ldyBkYXRhXG4gICAgY29uc3QgZ2V0RGF0YSA9IGJ1ZGdldENvbnRyb2xsZXIuY2FsY3VsYXRlQnVkZ2V0KClcblxuICAgIC8vIDIuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgY29uc3QgbmV3QnVkZ2V0ID0gdGhpcy5nZXRCdWRnZXQoZ2V0RGF0YSlcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhuZXdCdWRnZXQpXG4gICAgfVxuXG4gICAgLy8gMy4gRGlzcGxheSB0aGUgdXBkYXRlZCBidWRnZXRcbiAgICB0aGlzLmRpc3BsYXlCdWRnZXQobmV3QnVkZ2V0KVxuXG4gICAgLy8gNC4gRGlzcGxheSB0aGUgbmV3IG92ZXJhbGwgYnVkZ2V0IHBlcmNlbnRhZ2VcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlKG5ld0J1ZGdldC5wZXJjZW50RXhwLCAnZXhwJylcbiAgICB0aGlzLmRpc3BsYXlQZXJjZW50YWdlKG5ld0J1ZGdldC5wZXJjZW50U2F2LCAnc2F2JylcbiAgfVxuXG4gIGRpc3BsYXlQZXJjZW50YWdlcyhwZXJjZW50YWdlcywgdHlwZSkge1xuICAgIGNvbnN0IHR5cGVzID0gdHlwZSA9PT0gJ2V4cCcgPyAnZXhwZW5zZXMnIDogJ3NhdmluZ3MnXG4gICAgY29uc3QgZmllbGRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7dHlwZXN9IC5pdGVtc19fcGVyY2VudGApXG4gICAgY29uc3Qgbm9kZUxpc3RGb3JFYWNoID0gKGxpc3QsIGNiKSA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSwgaSlcbiAgICAgIH1cbiAgICB9XG4gICAgbm9kZUxpc3RGb3JFYWNoKGZpZWxkcywgKGN1cnJlbnQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocGVyY2VudGFnZXNbaW5kZXhdID4gMCkge1xuICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9IGAke3BlcmNlbnRhZ2VzW2luZGV4XX0mIzM3O2BcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgICAgIGN1cnJlbnQuaW5uZXJIVE1MID0gJzAmIzM3OydcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgdXBkYXRlUGVyY2VudGFnZXMoKSB7XG4gICAgLy8gMS4gQ2FsdWxhdGUgcGVyY2VudGFnZXNcbiAgICBidWRnZXRDb250cm9sbGVyLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKHRoaXMuaW5wdXRUeXBlLnZhbHVlKVxuXG4gICAgLy8gMi4gUmVhZCBwZXJjZW50YWdlcyBmcm9tIGJ1ZGdldCBjb250cm9sbGVyXG4gICAgY29uc3QgcGVyY2VudGFnZXMgPSBidWRnZXRDb250cm9sbGVyLmdldFBlcmNlbnRhZ2VzKHRoaXMuaW5wdXRUeXBlLnZhbHVlKVxuXG4gICAgLy8gMy4gVXBkYXRlIFVJIHRvIHNob3cgbmV3IHBlcmNlbnRhZ2VzXG4gICAgdGhpcy5kaXNwbGF5UGVyY2VudGFnZXMocGVyY2VudGFnZXMsIHRoaXMuaW5wdXRUeXBlLnZhbHVlKVxuICB9XG5cbiAgZGlzcGxheURhdGUoKSB7XG4gICAgY29uc3QgYnVkZ2V0RGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idWRnZXRfX2RhdGUnKVxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgbW9udGhzID0gW1xuICAgICAgJ0phbnVhcnknLFxuICAgICAgJ0ZlYnJ1YXJ5JyxcbiAgICAgICdNYXJjaCcsXG4gICAgICAnQXByaWwnLFxuICAgICAgJ01heScsXG4gICAgICAnSnVuZScsXG4gICAgICAnSnVseScsXG4gICAgICAnQXVndXN0JyxcbiAgICAgICdTZXBldGVtYmVyJyxcbiAgICAgICdPY3RvYmVyJyxcbiAgICAgICdOb3ZlbWJlcicsXG4gICAgICAnRGVjZW1iZXInLFxuICAgIF1cbiAgICBidWRnZXREYXRlLnRleHRDb250ZW50ID0gYCR7bW9udGhzW2RhdGUuZ2V0TW9udGgoKV19ICR7ZGF0ZS5nZXRGdWxsWWVhcigpfWBcbiAgfVxuXG4gIGNoYW5nZVR5cGUoKSB7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMuaW5wdXRUeXBlXG4gICAgY29uc3QgY2hlY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2hlY2snKVxuXG4gICAgLy8gaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKGZpZWxkcylcbiAgICAvLyB9XG5cbiAgICB0eXBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICBjb25zdCBvcHRpb25zID0gQXJyYXkuZnJvbSh0eXBlLm9wdGlvbnMpXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIHR5cGUuYXR0cmlidXRlcyxcbiAgICAgICAgICB0eXBlLm9wdGlvbnMsXG4gICAgICAgICAgdHlwZS5vcHRpb25zLnNlbGVjdGVkSW5kZXgsXG4gICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICBvcHRpb25zWzFdXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucy5mb3JFYWNoKChvcHRpb24pID0+IHtcbiAgICAgICAgaWYgKG9wdGlvbi5zZWxlY3RlZCkge1xuICAgICAgICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgICAgICBjaGVjay5jbGFzc0xpc3QucmVtb3ZlKCdleHAnLCAnc2F2JylcbiAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlID09PSAnZXhwJykge1xuICAgICAgICAgICAgY2hlY2suY2xhc3NMaXN0LmFkZCgnZXhwJylcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbi52YWx1ZSA9PT0gJ3NhdicpIHtcbiAgICAgICAgICAgIGNoZWNrLmNsYXNzTGlzdC5hZGQoJ3NhdicpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9wdGlvbi5yZW1vdmVBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBWYWx1ZSAke29wdGlvbi52YWx1ZX1gKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBkZWxldGVJdGVtKCkge1xuICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5jb21lLWV4cGVuc2VzJylcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5pZCA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdCgnLml0ZW1zJykucGFyZW50RWxlbWVudFxuICAgICAgICBjb25zdCBzcGxpdElEID0gdGFyZ2V0LmlkLnNwbGl0KCctJylcbiAgICAgICAgY29uc3QgdHlwZSA9IHNwbGl0SURbMF1cbiAgICAgICAgY29uc3QgSUQgPSBOdW1iZXIoc3BsaXRJRFsxXSlcblxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUudGFyZ2V0LCB0YXJnZXQsIHNwbGl0SUQsIHR5cGUsIElEKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gMS4gRGVsZXRlIHRoZSBpdGVtIGZyb20gdGhlIGRhdGEgc3RydWN0dXJlXG4gICAgICAgIGJ1ZGdldENvbnRyb2xsZXIucmVtb3ZlSXRlbSh0eXBlLCBJRClcblxuICAgICAgICAvLyAyLiBEZWxldGUgdGhlIGl0ZW0gZnJvbSB0aGUgVUlcbiAgICAgICAgdGFyZ2V0LnJlbW92ZSgpXG5cbiAgICAgICAgLy8gMy4gVXBkYXRlIGFuZCBzaG93IHRoZSBuZXcgYnVkZ2V0XG4gICAgICAgIHRoaXMudXBkYXRlQnVkZ2V0KClcblxuICAgICAgICAvLyA0LiBVcGRhdGUgYW5kIHNob3cgdGhlIG5ldyBwZXJjZW50YWdlc1xuICAgICAgICB0aGlzLnVwZGF0ZVBlcmNlbnRhZ2VzKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgc2F2aW5nKCkge1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzYXZlJylcbiAgICBjb25zdCBnZXREYXRhID0gYnVkZ2V0Q29udHJvbGxlci5jYWxjdWxhdGVCdWRnZXQoKVxuICAgIGNvbnN0IGN1cnJlbnRCdWRnZXQgPSB0aGlzLmdldEJ1ZGdldChnZXREYXRhKVxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHBhc3RidWRnZXRcbiAgICAgICAgLnNhdmVCdWRnZXQoY3VycmVudEJ1ZGdldClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdzYXZlZCcpXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVSUNvbnRyb2xsZXJcbiIsIm1vZHVsZS5leHBvcnRzID0gYnJlYWtwb2ludHM7IiwiLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuXG4vLyBFeHRlcm5hbFxuaW1wb3J0ICdhaXJibmItYnJvd3Nlci1zaGltcydcblxuLy8gSW50ZXJuYWxcbmltcG9ydCAnLi9tb2R1bGVzL2hlbHBlcnMnXG5pbXBvcnQgYnVkZ2V0Q29udHJvbGxlciBmcm9tICcuL21vZHVsZXMvYnVkZ2V0Y29udHJvbGxlcidcbmltcG9ydCBVSUNvbnRyb2xsZXIgZnJvbSAnLi9tb2R1bGVzL3VpY29udHJvbGxlcidcblxuLy8gUmVtb3ZlIGxvYWRpbmcgY2xhc3MgZnJvbSBib2R5IG9uIHdpbmRvdyBsb2FkLlxuY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG53aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1sb2FkaW5nJylcbiAgfSwgMTAwKVxufVxuXG4vLyBDcmVhdGUgdGhlIG1haW4gY29udHJvbGxlciBmb3IgdGhlIGFwcFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG5jb25zdCBjb250cm9sbGVyID0gKChidWRnZXRDdHJsKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkX19mb3JtJylcbiAgY29uc3QgdHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX3R5cGUnKVxuICBjb25zdCBkZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fZGVzY3JpcHRpb24nKVxuICBjb25zdCB2YWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGRfX3ZhbHVlJylcblxuICBjb25zdCBVSUN0cmwgPSBuZXcgVUlDb250cm9sbGVyKHR5cGUsIGRlc2MsIHZhbHVlKVxuXG4gIC8vIFNob2UgdGhlIGxhdGVzdCBkYXRlXG4gIFVJQ3RybC5kaXNwbGF5RGF0ZSgpXG5cbiAgLy8gVG9nZ2xlIHRoZSBzdWJtaXQgbmV3IGNvc3QgZnJvbSBlaXRoZXIgaW5jb21lIG9yIGV4cGVuc2UuXG4gIFVJQ3RybC5jaGFuZ2VUeXBlKClcblxuICBidWRnZXRDdHJsLnRlc3RpbmcoKVxuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIC8vIEdldCBmaWxlZCBpbnB1dCBkYXRhXG4gICAgY29uc3QgaW5wdXQgPSBVSUN0cmwuZ2V0SW5wdXQoKVxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjb25zb2xlLmxvZyhpbnB1dClcbiAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpbnB1dC52YWx1ZSlcbiAgICB9XG5cbiAgICAvLyBDbGVhciB0aGUgZm9ybSBmaWVsZHNcbiAgICBmb3JtLnJlc2V0KClcblxuICAgIC8vIE9ubHkgcnVuIGNhbGN1bGF0aW9ucyBpZiB2YWxpZCBpbnB1dHMgYXJlIGVudGVyZWRcbiAgICBpZiAoaW5wdXQuZGVzYyAhPT0gJycgJiYgIWlzTmFOKGlucHV0LnZhbHVlKSAmJiBpbnB1dC52YWx1ZSA+IDApIHtcbiAgICAgIC8vIEFkZCB0aGUgaXRlbSB0byB0aGUgYnVkZ2V0XG4gICAgICBjb25zdCBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKFxuICAgICAgICBpbnB1dC50eXBlLFxuICAgICAgICBpbnB1dC5kZXNjcmlwdGlvbixcbiAgICAgICAgaW5wdXQudmFsdWVcbiAgICAgIClcblxuICAgICAgLy8gQ2FsY3VsYWUgdGhlIGJ1ZGdldCBhbmQgdXBkYXRlIHRoZSBVSVxuICAgICAgVUlDdHJsLnJlbmRlcihuZXdJdGVtLCBpbnB1dC50eXBlKSAvLyBBZGQgaXRlbXMgdG8gaW5jb21lIG9yIGV4cGVuc2VzIGxpc3RcbiAgICAgIFVJQ3RybC51cGRhdGVCdWRnZXQoKSAvLyBPdXRwdXQgdGhlIG5ldyBidWRnZXRcbiAgICAgIFVJQ3RybC51cGRhdGVQZXJjZW50YWdlcygpIC8vIE91dHB1dCB0aGUgbmV3IHBlcmNlbnRhZ2VzXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmb3JtIHN1Ym1pdHRlZCEnKVxuICAgICAgICBjb25zb2xlLmxvZyhuZXdJdGVtKVxuICAgICAgfVxuICAgIH1cbiAgICBidWRnZXRDdHJsLnRlc3RpbmcoKVxuICB9KVxuICAvLyBEZWxldGUgYW4gYWRkZWQgaW5jb21lIG9yIGV4cGVuc2VcbiAgVUlDdHJsLmRlbGV0ZUl0ZW0oKVxufSkoYnVkZ2V0Q29udHJvbGxlcilcbiIsIm1vZHVsZS5leHBvcnRzID0gYnJvd3NlcjsiLCJjb25zdCBidWRnZXRDb250cm9sbGVyID0gKCgpID0+IHtcbiAgY2xhc3MgQnVkZ2V0IHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKSB7XG4gICAgICB0aGlzLmlkID0gaWRcbiAgICAgIHRoaXMuZGVzYyA9IGRlc2NyaXB0aW9uXG4gICAgICB0aGlzLnZhbCA9IHZhbHVlXG4gICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAtMVxuICAgIH1cblxuICAgIGNhbGNQZXJjZW50YWdlKHRvdGFsSW5jb21lKSB7XG4gICAgICBpZiAodG90YWxJbmNvbWUgPiAwKSB7XG4gICAgICAgIHRoaXMucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKHRoaXMudmFsIC8gdG90YWxJbmNvbWUpICogMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gLTFcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGB0aGlzIHZhbHVlIGlzICR7dHlwZW9mIHRoaXMudmFsfWAsXG4gICAgICAgICAgYHRoZSB0b3RhbEluY29tZSAke3R5cGVvZiB0b3RhbEluY29tZX1gXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQZXJjZW50YWdlKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGVyY2VudGFnZVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgYWxsSXRlbXM6IHtcbiAgICAgIGV4cDogW10sXG4gICAgICBpbmM6IFtdLFxuICAgICAgc2F2OiBbXSxcbiAgICB9LFxuICAgIHRvdGFsczoge1xuICAgICAgZXhwOiAwLFxuICAgICAgaW5jOiAwLFxuICAgICAgc2F2OiAwLFxuICAgIH0sXG4gICAgcGVyY2VudDoge1xuICAgICAgZXhwOiAtMSxcbiAgICAgIHNhdjogLTEsXG4gICAgfSxcbiAgICBidWRnZXQ6IDAsXG4gIH1cblxuICBjb25zdCBjYWxjdWxhdGVUb3RhbHMgPSAodHlwZSkgPT4ge1xuICAgIGxldCBzdW0gPSAwXG4gICAgZGF0YS5hbGxJdGVtc1t0eXBlXS5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgIHN1bSArPSBjdXIudmFsXG4gICAgfSlcbiAgICBkYXRhLnRvdGFsc1t0eXBlXSA9IHN1bVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRJdGVtOiAodHlwZSwgZGVzYywgdmFsKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbmV3IElEXG4gICAgICBjb25zdCBJRCA9XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMFxuICAgICAgICAgID8gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMVxuICAgICAgICAgIDogMFxuXG4gICAgICAvLyBTZXQgbmV3IGl0ZW0gdG8gdXNlIG9iamVjdFxuICAgICAgY29uc3QgbmV3SXRlbSA9IG5ldyBCdWRnZXQoSUQsIGRlc2MsIHZhbClcblxuICAgICAgLy8gUHVzaCBpdCBpbnRvIGRhdGEgc3RydWN0dXJlXG4gICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSlcblxuICAgICAgLy8gY3JlYXRlIG5ldyBpdGVtXG4gICAgICByZXR1cm4gbmV3SXRlbVxuICAgIH0sXG4gICAgY2FsY3VsYXRlQnVkZ2V0OiAoKSA9PiB7XG4gICAgICAvLyAxLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldFxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdleHAnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdpbmMnKVxuICAgICAgY2FsY3VsYXRlVG90YWxzKCdzYXYnKVxuXG4gICAgICAvLyAyLiBDYWxjdWxhdGUgdGhlIGJ1ZGdldDogaW5jb21lIC0gZXhwZW5zZXNcbiAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhbHMuaW5jIC0gKGRhdGEudG90YWxzLmV4cCArIGRhdGEudG90YWxzLnNhdilcblxuICAgICAgLy8gMy4gQ2FsY3VsYXRlIHRoZSBwZXJjZW50YWdlIG9mIGluY29tZSB0aGF0IHdlIHNwZW50XG4gICAgICBpZiAoZGF0YS50b3RhbHMuaW5jID4gMCkge1xuICAgICAgICBkYXRhLnBlcmNlbnQuZXhwID0gTWF0aC5yb3VuZCgoZGF0YS50b3RhbHMuZXhwIC8gZGF0YS50b3RhbHMuaW5jKSAqIDEwMClcbiAgICAgICAgZGF0YS5wZXJjZW50LnNhdiA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLnNhdiAvIGRhdGEudG90YWxzLmluYykgKiAxMDApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhLnBlcmNlbnQuZXhwID0gLTFcbiAgICAgICAgZGF0YS5wZXJjZW50LnNhdiA9IC0xXG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFJldHVybiB0aGUgYnVkZ2V0XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhLnRvdGFscy5leHAsIGRhdGEudG90YWxzLmluYylcbiAgICAgICAgY29uc29sZS5sb2coZGF0YS5idWRnZXQsIGRhdGEucGVyY2VudC5leHAsIGRhdGEucGVyY2VudC5zYXYpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSxcbiAgICBjYWxjdWxhdGVQZXJjZW50YWdlczogKHR5cGUpID0+IHtcbiAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICAgIGN1ci5jYWxjUGVyY2VudGFnZShkYXRhLnRvdGFscy5pbmMpXG4gICAgICB9KVxuICAgIH0sXG4gICAgZ2V0UGVyY2VudGFnZXM6ICh0eXBlKSA9PiB7XG4gICAgICBjb25zdCBhbGxQZXJjID0gZGF0YS5hbGxJdGVtc1t0eXBlXS5tYXAoKGN1cikgPT4ge1xuICAgICAgICByZXR1cm4gY3VyLmdldFBlcmNlbnRhZ2UoKVxuICAgICAgfSlcbiAgICAgIHJldHVybiBhbGxQZXJjXG4gICAgfSxcbiAgICByZW1vdmVJdGVtOiAodHlwZSwgaWQpID0+IHtcbiAgICAgIGNvbnN0IGlkcyA9IGRhdGEuYWxsSXRlbXNbdHlwZV0ubWFwKChjdXJyZW50KSA9PiB7XG4gICAgICAgIHJldHVybiBjdXJyZW50LmlkXG4gICAgICB9KVxuICAgICAgY29uc3QgaW5kZXggPSBpZHMuaW5kZXhPZihpZClcblxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnNwbGljZShpbmRleCwgMSlcbiAgICAgIH1cbiAgICB9LFxuICAgIHRlc3Rpbmc6ICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEuYWxsSXRlbXMpXG4gICAgfSxcbiAgfVxufSkoKVxuXG5leHBvcnQgZGVmYXVsdCBidWRnZXRDb250cm9sbGVyXG4iXSwic291cmNlUm9vdCI6IiJ9